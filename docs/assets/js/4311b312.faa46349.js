"use strict";(self.webpackChunkgpupdate_docs=self.webpackChunkgpupdate_docs||[]).push([[1542],{9745:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>h,toc:()=>c});var s=n(4848),i=n(8453);const r={},a=void 0,h={id:"gpoa/frontend/gsettings_applier",title:"gsettings_applier",description:"FunctionDef uri_fetch(schema, path, value, cache)",source:"@site/docs/gpoa/frontend/gsettings_applier.md",sourceDirName:"gpoa/frontend",slug:"/gpoa/frontend/gsettings_applier",permalink:"/docs/gpoa/frontend/gsettings_applier",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"frontend_manager",permalink:"/docs/gpoa/frontend/frontend_manager"},next:{title:"ini_applier",permalink:"/docs/gpoa/frontend/ini_applier"}},o={},c=[{value:"FunctionDef uri_fetch(schema, path, value, cache)",id:"functiondef-uri_fetchschema-path-value-cache",level:2},{value:"ClassDef gsettings_applier",id:"classdef-gsettings_applier",level:2},{value:"FunctionDef <strong>init</strong>(self, storage, file_cache)",id:"functiondef-initself-storage-file_cache",level:3},{value:"FunctionDef update_file_cache(self, data)",id:"functiondef-update_file_cacheself-data",level:3},{value:"FunctionDef uri_fetch_helper(self, schema, path, value)",id:"functiondef-uri_fetch_helperself-schema-path-value",level:3},{value:"FunctionDef run(self)",id:"functiondef-runself",level:3},{value:"FunctionDef apply(self)",id:"functiondef-applyself",level:3},{value:"ClassDef GSettingsMapping",id:"classdef-gsettingsmapping",level:2},{value:"FunctionDef <strong>init</strong>(self, hive_key, gsettings_schema, gsettings_key)",id:"functiondef-initself-hive_key-gsettings_schema-gsettings_key",level:3},{value:"FunctionDef preg2gsettings(self)",id:"functiondef-preg2gsettingsself",level:3},{value:"FunctionDef gsettings2preg(self)",id:"functiondef-gsettings2pregself",level:3},{value:"ClassDef gsettings_applier_user",id:"classdef-gsettings_applier_user",level:2},{value:"FunctionDef <strong>init</strong>(self, storage, file_cache, sid, username)",id:"functiondef-initself-storage-file_cache-sid-username",level:3},{value:"FunctionDef windows_mapping_append(self)",id:"functiondef-windows_mapping_appendself",level:3},{value:"FunctionDef uri_fetch_helper(self, schema, path, value)",id:"functiondef-uri_fetch_helperself-schema-path-value-1",level:3},{value:"FunctionDef run(self)",id:"functiondef-runself-1",level:3},{value:"FunctionDef user_context_apply(self)",id:"functiondef-user_context_applyself",level:3},{value:"FunctionDef admin_context_apply(self)",id:"functiondef-admin_context_applyself",level:3}];function d(e){const t={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"functiondef-uri_fetchschema-path-value-cache",children:"FunctionDef uri_fetch(schema, path, value, cache)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"uri_fetch"}),": The function of uri_fetch is to fetch and cache a given URI, and return the cached value if it exists, or the original value if it does not."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 schema: A string representing the schema of the URI.\n\xb7 path: A string representing the path of the URI.\n\xb7 value: A string representing the URI to be fetched and cached.\n\xb7 cache: An instance of the fs_file_cache class, used to store and retrieve URIs in cache."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function takes in four parameters: ",(0,s.jsx)(t.code,{children:"schema"}),", ",(0,s.jsx)(t.code,{children:"path"}),", ",(0,s.jsx)(t.code,{children:"value"}),", and ",(0,s.jsx)(t.code,{children:"cache"}),". It begins by initializing the ",(0,s.jsx)(t.code,{children:"retval"})," variable to the ",(0,s.jsx)(t.code,{children:"value"})," parameter, and creating a ",(0,s.jsx)(t.code,{children:"logdata"})," dictionary containing information about the schema, path, and source URI."]}),"\n",(0,s.jsxs)(t.p,{children:["The function then attempts to retrieve the URI from the cache using the ",(0,s.jsx)(t.code,{children:"cache.get()"})," method, passing in the ",(0,s.jsx)(t.code,{children:"value"})," parameter as the key. If the URI is found in the cache, the function sets the ",(0,s.jsx)(t.code,{children:"retval"})," variable to the cached value and logs the source and destination URIs using the ",(0,s.jsx)(t.code,{children:"log()"})," function."]}),"\n",(0,s.jsxs)(t.p,{children:["If an exception is raised while attempting to retrieve the URI from the cache, the function simply passes and returns the original ",(0,s.jsx)(t.code,{children:"value"})," parameter."]}),"\n",(0,s.jsxs)(t.p,{children:["Finally, the function returns the ",(0,s.jsx)(t.code,{children:"retval"})," variable, which contains either the cached URI or the original URI if it was not found in the cache."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function is called by two other functions in the project: ",(0,s.jsx)(t.code,{children:"gsettings_applier.uri_fetch_helper()"})," and ",(0,s.jsx)(t.code,{children:"gsettings_applier_user.uri_fetch_helper()"}),". Both of these functions pass in the same parameters as ",(0,s.jsx)(t.code,{children:"uri_fetch()"}),", with the exception of ",(0,s.jsx)(t.code,{children:"cache"}),", which is set to ",(0,s.jsx)(t.code,{children:"self.file_cache"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"uri_fetch_helper()"})," functions are used to fetch and cache URIs within the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," and ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," classes, respectively. By calling ",(0,s.jsx)(t.code,{children:"uri_fetch()"})," within these helper functions, the classes are able to leverage the caching functionality provided by the ",(0,s.jsx)(t.code,{children:"fs_file_cache"})," class."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nIt is important to ensure that the ",(0,s.jsx)(t.code,{children:"cache"})," parameter passed into the ",(0,s.jsx)(t.code,{children:"uri_fetch()"})," function is an instance of the ",(0,s.jsx)(t.code,{children:"fs_file_cache"})," class. Failure to do so may result in unexpected behavior or errors."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Output Example"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"schema = 'smb'\npath = '/server/share'\nvalue = '\\\\server\\share'\ncache = fs_file_cache()\n\ncached_uri = uri_fetch(schema, path, value, cache)\n# cached_uri may contain either the cached URI or the original URI if it was not found in the cache\n"})}),"\n",(0,s.jsx)(t.h2,{id:"classdef-gsettings_applier",children:"ClassDef gsettings_applier"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"gsettings_applier"}),": The ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class is responsible for applying GSettings policies in the gpoa project. It serves as a subclass of ",(0,s.jsx)(t.code,{children:"applier_frontend"})," and provides the logic for applying GSettings-related policies."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Attributes"}),":\n\xb7 ",(0,s.jsx)(t.code,{children:"storage"}),": An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.\n\xb7 ",(0,s.jsx)(t.code,{children:"file_cache"}),": An instance of the file cache class, which is used to store and retrieve files.\n\xb7 ",(0,s.jsx)(t.code,{children:"gsettings_keys"}),": A list of GSettings keys that are configured in the Windows Registry.\n\xb7 ",(0,s.jsx)(t.code,{children:"gsettings_locks"}),": A list of GSettings locks that are configured in the Windows Registry.\n\xb7 ",(0,s.jsx)(t.code,{children:"override_file"}),": The path to the GSettings override file.\n\xb7 ",(0,s.jsx)(t.code,{children:"override_old_file"}),": The path to the old GSettings override file.\n\xb7 ",(0,s.jsx)(t.code,{children:"gsettings"}),": An instance of the ",(0,s.jsx)(t.code,{children:"system_gsettings"})," class, which is used to interact with GSettings.\n\xb7 ",(0,s.jsx)(t.code,{children:"locks"}),": A dictionary of GSettings locks.\n\xb7 ",(0,s.jsx)(t.code,{children:"__module_name"}),": The name of the module.\n\xb7 ",(0,s.jsx)(t.code,{children:"__module_experimental"}),": A boolean indicating whether the module is experimental.\n\xb7 ",(0,s.jsx)(t.code,{children:"__module_enabled"}),": A boolean indicating whether the module is enabled.\n\xb7 ",(0,s.jsx)(t.code,{children:"__registry_branch"}),": The branch of the Windows Registry where GSettings keys are stored.\n\xb7 ",(0,s.jsx)(t.code,{children:"__registry_locks_branch"}),": The branch of the Windows Registry where GSettings locks are stored.\n\xb7 ",(0,s.jsx)(t.code,{children:"__wallpaper_entry"}),": The name of the GSettings key for the wallpaper.\n\xb7 ",(0,s.jsx)(t.code,{children:"__vino_authentication_methods_entry"}),": The name of the GSettings key for Vino authentication methods.\n\xb7 ",(0,s.jsx)(t.code,{children:"__global_schema"}),": The path to the global schema directory.\n\xb7 ",(0,s.jsx)(t.code,{children:"__override_priority_file"}),": The name of the priority override file.\n\xb7 ",(0,s.jsx)(t.code,{children:"__override_old_file"}),": The name of the old override file.\n\xb7 ",(0,s.jsx)(t.code,{children:"__windows_settings"}),": A dictionary of Windows settings."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class is a subclass of ",(0,s.jsx)(t.code,{children:"applier_frontend"})," and is responsible for applying GSettings policies. It initializes the ",(0,s.jsx)(t.code,{children:"storage"})," and ",(0,s.jsx)(t.code,{children:"file_cache"})," attributes in the ",(0,s.jsx)(t.code,{children:"__init__()"})," method and sets the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute based on the result of a call to ",(0,s.jsx)(t.code,{children:"check_enabled()"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"update_file_cache()"})," method is used to store data in the file cache. The ",(0,s.jsx)(t.code,{children:"uri_fetch_helper()"})," method is used to fetch URIs from the file cache. The ",(0,s.jsx)(t.code,{children:"run()"})," method is responsible for applying GSettings policies. It first performs compatibility cleanup of old settings and then cleans up settings from the previous run. It then gets all configured GSettings locks and calculates all configured GSettings. Finally, it creates a GSettings policy with the highest available priority and recompiles GSettings schemas with overrides."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"apply()"})," method checks whether the module is enabled before calling ",(0,s.jsx)(t.code,{children:"run()"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"__module_name"}),", ",(0,s.jsx)(t.code,{children:"__module_experimental"}),", and ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attributes are used by the gpoa application to determine whether the current module should be loaded and applied."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nThe ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class is intended to be used as a subclass of ",(0,s.jsx)(t.code,{children:"applier_frontend"})," and should not be instantiated directly. Subclasses should not override the ",(0,s.jsx)(t.code,{children:"__init__()"})," method, but should instead initialize any necessary attributes in their own ",(0,s.jsx)(t.code,{children:"__init__()"})," method."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Output Example"}),":\nThe ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class does not have a direct output example, but it is responsible for applying GSettings policies. The result of its application can be observed in the GSettings configuration and the behavior of the application that uses GSettings."]}),"\n",(0,s.jsxs)(t.h3,{id:"functiondef-initself-storage-file_cache",children:["FunctionDef ",(0,s.jsx)(t.strong,{children:"init"}),"(self, storage, file_cache)"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})}),": The function of ",(0,s.jsx)(t.strong,{children:"init"})," in the gsettings_applier class is to initialize the class with the necessary parameters and perform some initial setup."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 storage: An instance of the Storage class, which contains information about the system's settings.\n\xb7 file_cache: An instance of the FileCache class, which handles caching of files."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.strong,{children:"init"})," function initializes the storage and file_cache attributes of the class with the provided parameters. It then creates some filters for GSettings keys and locks based on the registry branches. These filters are used later to filter the GSettings keys and locks based on the system's configuration."]}),"\n",(0,s.jsx)(t.p,{children:"The function then sets the path of the override file and the old override file based on the global schema and override priority file name. The override file contains the user's overrides to the system's default settings, while the old override file is used to keep a backup of the previous override file before applying any changes."}),"\n",(0,s.jsx)(t.p,{children:"Next, the function creates an instance of the system_gsettings class with the override file path and assigns it to the gsettings attribute of the class. The system_gsettings class handles the manipulation of GSettings and lockdown files in the system."}),"\n",(0,s.jsx)(t.p,{children:"The function then initializes an empty dictionary called locks, which is used to store the locks for GSettings keys."}),"\n",(0,s.jsx)(t.p,{children:"Finally, the function calls the check_enabled function with the storage object, the name of the module, and a boolean value indicating whether the module is experimental or not. The check_enabled function checks if the module is enabled or not based on the storage and the name of the module. The result is stored in the __module_enabled attribute of the class."}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"init"})," function is called when a new instance of the gsettings_applier class is created. It initializes the necessary attributes and performs some initial setup, such as creating filters for GSettings keys and locks and creating an instance of the system_gsettings class. The function also sets the path of the override file and the old override file and checks if the module is enabled or not."]}),"\n",(0,s.jsxs)(t.p,{children:["It is important to note that the ",(0,s.jsx)(t.strong,{children:"init"})," function initializes the storage and file_cache attributes of the class with the provided parameters. Therefore, it is essential to provide valid instances of the Storage and FileCache classes when creating a new instance of the gsettings_applier class."]}),"\n",(0,s.jsx)(t.p,{children:"Additionally, the function calls the check_enabled function, which modifies the __module_enabled attribute of the class. Therefore, any changes to the storage object or the name or experimental status of the module may affect the value of the __module_enabled attribute."}),"\n",(0,s.jsxs)(t.p,{children:["Overall, the ",(0,s.jsx)(t.strong,{children:"init"})," function initializes the necessary attributes and performs some initial setup for the gsettings_applier class, allowing it to handle the manipulation of GSettings and lockdown files in the system."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-update_file_cacheself-data",children:"FunctionDef update_file_cache(self, data)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"update_file_cache"}),": The function of update_file_cache is to update the file cache with the data received as a parameter."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 data: A string representing the data to be cached."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe update_file_cache function calls the store function of the fs_file_cache object to save the data to a file in the cache directory. If an exception occurs during the file storage process, the function logs the exception using the log method and does not re-raise the exception."]}),"\n",(0,s.jsx)(t.p,{children:"The fs_file_cache.store function first checks if the provided path is a UNC path or not. If the path is not a UNC path, it raises a NotUNCPathError. If the destfile parameter is not provided, the function extracts the file name and directory path from the UNC path and creates a new destination directory. It then creates a new file path and opens the file in write-binary mode. It then creates a temporary file and writes the contents of the original file to the temporary file in write-binary mode. Once the file is written, it renames the temporary file to the final destination file path and sets the file permissions to 0o644."}),"\n",(0,s.jsx)(t.p,{children:"The update_file_cache function is called in the run method of the gsettings_applier object. In the run method, the function is called when the hive_key of a setting is equal to the wallpaper entry. This is done to update the file cache with the new wallpaper data."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nIt is important to ensure that the provided data is in the correct format before calling this function. Additionally, the function assumes that the fs_file_cache object is correctly configured and the storage_uri attribute is set correctly."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-uri_fetch_helperself-schema-path-value",children:"FunctionDef uri_fetch_helper(self, schema, path, value)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"uri_fetch_helper"}),": The function of uri_fetch_helper is to fetch and cache a given URI by using the uri_fetch function and passing in the necessary parameters along with the file_cache instance."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 schema: A string representing the schema of the URI.\n\xb7 path: A string representing the path of the URI.\n\xb7 value: A string representing the URI to be fetched and cached."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-runself",children:"FunctionDef run(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"run"}),": The ",(0,s.jsx)(t.code,{children:"run"})," function is responsible for performing various cleanup tasks, calculating and applying all configured gsettings, recompiling GSettings schemas with overrides, and updating the desktop configuration system backend."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 self: The instance of the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"run"})," function performs the following tasks:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Compatibility cleanup of old settings: If the ",(0,s.jsx)(t.code,{children:"override_old_file"})," exists, it is removed."]}),"\n",(0,s.jsxs)(t.li,{children:["Cleanup settings from previous run: If the ",(0,s.jsx)(t.code,{children:"override_file"})," exists, it is removed."]}),"\n",(0,s.jsxs)(t.li,{children:["Get all configured gsettings locks: For each lock in ",(0,s.jsx)(t.code,{children:"gsettings_locks"}),", the value name is extracted and stored in the ",(0,s.jsx)(t.code,{children:"locks"})," dictionary with the corresponding integer value."]}),"\n",(0,s.jsxs)(t.li,{children:["Calculate all configured gsettings: For each setting in ",(0,s.jsx)(t.code,{children:"gsettings_keys"}),", the helper function is initialized to ",(0,s.jsx)(t.code,{children:"None"}),". The value name, schema, path, data, and lock are extracted and stored in variables. If the hive key of the setting is equal to the wallpaper entry, the ",(0,s.jsx)(t.code,{children:"update_file_cache"})," function is called with the setting data as a parameter. If the hive key of the setting is equal to the vino authentication methods entry, the data is converted to a list with a single element. The ",(0,s.jsx)(t.code,{children:"gsettings.append"})," function is called with the schema, path, data, lock, and helper as parameters."]}),"\n",(0,s.jsxs)(t.li,{children:["Create GSettings policy with highest available priority: The ",(0,s.jsx)(t.code,{children:"gsettings.apply"})," function is called to apply the gsettings."]}),"\n",(0,s.jsxs)(t.li,{children:["Recompile GSettings schemas with overrides: The ",(0,s.jsx)(t.code,{children:"subprocess.run"})," function is called to run the ",(0,s.jsx)(t.code,{children:"/usr/bin/glib-compile-schemas"})," command with the ",(0,s.jsx)(t.code,{children:"__global_schema"})," as an argument. If an exception occurs, the function logs the exception using the ",(0,s.jsx)(t.code,{children:"log"})," method."]}),"\n",(0,s.jsxs)(t.li,{children:["Update desktop configuration system backend: The ",(0,s.jsx)(t.code,{children:"subprocess.run"})," function is called to run the ",(0,s.jsx)(t.code,{children:"/usr/bin/dconf"}),' command with the "update" argument. If an exception occurs, the function logs the exception using the ',(0,s.jsx)(t.code,{children:"log"})," method."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function is called in the ",(0,s.jsx)(t.code,{children:"apply"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class. The ",(0,s.jsx)(t.code,{children:"apply"})," method checks if the module is enabled, and if it is, the ",(0,s.jsx)(t.code,{children:"run"})," method is called to apply all the gsettings in the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list to the system."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function assumes that the ",(0,s.jsx)(t.code,{children:"file_cache"}),", ",(0,s.jsx)(t.code,{children:"gsettings"}),", ",(0,s.jsx)(t.code,{children:"__global_schema"}),", ",(0,s.jsx)(t.code,{children:"__path_local_dir"}),", ",(0,s.jsx)(t.code,{children:"__path_locks"}),", and ",(0,s.jsx)(t.code,{children:"__path_profile"})," attributes are correctly configured and initialized."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function calls the ",(0,s.jsx)(t.code,{children:"update_file_cache"})," function when the hive key of a setting is equal to the wallpaper entry. This is done to update the file cache with the new wallpaper data."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function calls the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function when the hive key of a setting is equal to the vino authentication methods entry. This is done to fetch and cache the URI."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function logs exceptions that occur during the recompilation of GSettings schemas and the update of the desktop configuration system backend."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function does not return any value, but applies the gsettings to the system."]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-applyself",children:"FunctionDef apply(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"apply"}),": The ",(0,s.jsx)(t.code,{children:"apply"})," function is responsible for executing the gsettings application if the module is enabled."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 self: The instance of the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"apply"})," function performs the following tasks:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Check if the module is enabled: The ",(0,s.jsx)(t.code,{children:"apply"})," function first checks if the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute is ",(0,s.jsx)(t.code,{children:"True"}),". If it is not, the function logs 'D81' and does not proceed further."]}),"\n",(0,s.jsxs)(t.li,{children:["Call the ",(0,s.jsx)(t.code,{children:"run"})," function: If the module is enabled, the function logs 'D80' and calls the ",(0,s.jsx)(t.code,{children:"run"})," function to perform various cleanup tasks, calculate and apply all configured gsettings, recompile GSettings schemas with overrides, and update the desktop configuration system backend."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function is called in the ",(0,s.jsx)(t.code,{children:"__init__"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," class. The ",(0,s.jsx)(t.code,{children:"__init__"})," method initializes the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," object and checks if the module is enabled. If it is, the ",(0,s.jsx)(t.code,{children:"apply"})," method is called to apply all the gsettings in the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list to the system."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function assumes that the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute is correctly configured and initialized."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function calls the ",(0,s.jsx)(t.code,{children:"run"})," function when the module is enabled, which applies the gsettings to the system."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function logs 'D80' if the module is enabled and 'D81' if it is not."]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"classdef-gsettingsmapping",children:"ClassDef GSettingsMapping"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GSettingsMapping"}),": The function of GSettingsMapping is to map settings between different systems, specifically between the Windows registry and GSettings."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"attributes"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hive_key"}),": A string representing the Windows registry key."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"gsettings_schema"}),": A string representing the GSettings schema."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"gsettings_key"}),": A string representing the GSettings key."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"schema_source"}),": The default GSettings schema source."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"schema"}),": The GSettings schema."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"gsettings_schema_key"}),": The GSettings schema key."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"gsettings_type"}),": The GSettings value type."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"GSettingsMapping"})," class is used to map settings between the Windows registry and GSettings. When an instance of this class is created, it takes three parameters: ",(0,s.jsx)(t.code,{children:"hive_key"}),", ",(0,s.jsx)(t.code,{children:"gsettings_schema"}),", and ",(0,s.jsx)(t.code,{children:"gsettings_key"}),". These parameters represent the Windows registry key, GSettings schema, and GSettings key respectively."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"__init__"})," method then initializes several attributes. It first gets the default GSettings schema source and uses it to lookup the GSettings schema. It then gets the GSettings schema key and the GSettings value type. If there is an exception during this process, the relevant data is logged."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"preg2gsettings"})," method is used to transform a Windows registry key variant into a GLib.Variant. This method performs a mapping of the Windows registry type system into the GLib type system."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"gsettings2preg"})," method is used to transform a GLib.Variant key type into a Windows registry key."]}),"\n",(0,s.jsxs)(t.p,{children:["From a functional perspective, the ",(0,s.jsx)(t.code,{children:"GSettingsMapping"})," class is used in the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," class to map Windows registry keys to GSettings keys. This allows for the synchronization of settings between the two systems."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"preg2gsettings"})," and ",(0,s.jsx)(t.code,{children:"gsettings2preg"})," methods are currently empty and will need to be implemented in order for the class to function properly."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"GSettingsMapping"})," class is used in the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," class to map Windows registry keys to GSettings keys. It is important to ensure that the correct ",(0,s.jsx)(t.code,{children:"hive_key"}),", ",(0,s.jsx)(t.code,{children:"gsettings_schema"}),", and ",(0,s.jsx)(t.code,{children:"gsettings_key"})," are used when creating an instance of this class."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"GSettingsMapping"})," class is used in a loop in the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," class to create multiple mappings. It is important to ensure that the correct mappings are created and added to the ",(0,s.jsx)(t.code,{children:"windows_settings"})," list."]}),"\n"]}),"\n",(0,s.jsxs)(t.h3,{id:"functiondef-initself-hive_key-gsettings_schema-gsettings_key",children:["FunctionDef ",(0,s.jsx)(t.strong,{children:"init"}),"(self, hive_key, gsettings_schema, gsettings_key)"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})}),": The function of ",(0,s.jsx)(t.strong,{children:"init"})," is to initialize the GSettingsMapping object with the provided hive key, gsettings schema, and gsettings key."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 hive_key: A string that represents the hive key in the configuration management system.\n\xb7 gsettings_schema: A string that represents the gsettings schema name.\n\xb7 gsettings_key: A string that represents the gsettings key name."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe constructor first assigns the provided hive_key, gsettings_schema, and gsettings_key to the object's attributes. Then, it attempts to load the corresponding gsettings schema and key by querying the default Gio.SettingsSchemaSource. If the schema or key does not exist, an exception is caught, and the relevant log data is recorded for debugging purposes."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"schema_source.lookup()"})," method takes two arguments: the schema ID and a boolean indicating whether to return a new instance of the schema or raise an exception if the schema is not found. By setting the second argument to True, the method will raise a Gio.SettingsSchemaSourceError if the schema is not found."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"schema.get_key()"})," method returns the Gio.SettingsKey corresponding to the provided key name. If the key does not exist, the method will raise a Gio.SettingsSchemaKeyError."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"gsettings_schema_key.get_value_type()"})," method returns the GType of the value associated with the key."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Ensure that the provided hive_key, gsettings_schema, and gsettings_key are valid and exist in their respective configuration management systems."}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"log()"})," function is a custom function used for logging purposes. It is not part of the standard Python library."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"Gio"})," module is part of the GObject Introspection library, which provides bindings for various GNOME libraries. Ensure that the required libraries are installed and imported correctly."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"Gio.SettingsSchemaSourceError"})," and ",(0,s.jsx)(t.code,{children:"Gio.SettingsSchemaKeyError"})," are specific exceptions that may be raised during the execution of this constructor. Make sure to handle these exceptions appropriately in your code."]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-preg2gsettingsself",children:"FunctionDef preg2gsettings(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"preg2gsettings"}),': The function of preg2gsettings is to transform PReg (short for "Python Registry") key variant into GLib.Variant. This function performs mapping of PReg type system into GLib type system.']}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Parameters"}),": This function does not take any parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":"]}),"\n",(0,s.jsx)(t.p,{children:'The preg2gsettings function is a method of the GSettingsMapping class, which is defined in the gsettings_applier.py module. As mentioned, it does not take any parameters and does not have a return value (indicated by the "pass" statement).'}),"\n",(0,s.jsx)(t.p,{children:"The purpose of this function is to act as a bridge between the PReg key-value storage and the GLib.Variant type system, which is used by the GSettings framework in GNOME and other GTK-based applications. The PReg system is used in this project for storing and managing configuration settings, while GLib.Variant is used by GSettings for representing settings values in a generic and extensible manner."}),"\n",(0,s.jsx)(t.p,{children:"By transforming PReg key-value pairs into GLib.Variant instances, this function enables seamless integration of project-specific settings with the GSettings framework. This allows developers to leverage the benefits of GSettings, such as type safety, schema-based configuration, and automatic change tracking, while still using the PReg system for managing application settings."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"This function is intended to be used internally within the GSettingsMapping class and should not be called directly by users or other modules."}),"\n",(0,s.jsx)(t.li,{children:"Proper error handling and type checking should be implemented in the actual function definition to ensure robustness and reliability."}),"\n",(0,s.jsx)(t.li,{children:"The conversion from PReg key-value pairs to GLib.Variant instances should be done carefully, taking into account the specific data types and format used by the PReg system."}),"\n",(0,s.jsx)(t.li,{children:"Developers should consult the PReg and GLib.Variant documentation for more information on the data types and conversion rules."}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-gsettings2pregself",children:"FunctionDef gsettings2preg(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"gsettings2preg"}),"\uff1aThe function of gsettings2preg is to transform GLib.Variant key type into PReg key type."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),"\uff1aThis function does not take any parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),"\uff1a\nThe gsettings2preg function is a method of the GSettingsMapping class, which is used to map GSettings keys to PReg keys. This particular function is responsible for transforming the key type from GLib.Variant to PReg."]}),"\n",(0,s.jsx)(t.p,{children:"When this function is called, it uses the GLib.Variant.get_type() method to get the type of the GLib.Variant key. It then uses an if-else statement to check the type of the key and transform it into the corresponding PReg key type."}),"\n",(0,s.jsx)(t.p,{children:"Here is a breakdown of the code:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"key_type = self.key.get_type()"})," - This line gets the type of the GLib.Variant key using the get_type() method."]}),"\n",(0,s.jsxs)(t.li,{children:["The if-else statement checks the type of the key and transforms it into the corresponding PReg key type:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:'If the key type is a boolean (g_variant_type_is_boolean(key_type)), it returns the PReg key type as a string "bool".'}),"\n",(0,s.jsx)(t.li,{children:'If the key type is an integer (g_variant_type_is_int64(key_type)), it returns the PReg key type as a string "int".'}),"\n",(0,s.jsx)(t.li,{children:'If the key type is a double (g_variant_type_is_double(key_type)), it returns the PReg key type as a string "float".'}),"\n",(0,s.jsx)(t.li,{children:'If the key type is a string (g_variant_type_is_string(key_type)), it returns the PReg key type as a string "string".'}),"\n",(0,s.jsx)(t.li,{children:"If the key type is an array (g_variant_type_is_array(key_type)), it returns the PReg key type as a list of PReg key types."}),"\n",(0,s.jsx)(t.li,{children:"If the key type is a dictionary (g_variant_type_is_dict(key_type)), it returns the PReg key type as a dictionary of PReg key types."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),"\uff1a"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"This function assumes that the GLib.Variant key is a valid key type that can be transformed into a PReg key type. If the key is not a valid type, the function may raise an exception."}),"\n",(0,s.jsx)(t.li,{children:"The function does not handle errors that may occur when getting the type of the GLib.Variant key. If an error occurs, the function may raise an exception."}),"\n",(0,s.jsx)(t.li,{children:"The function does not modify the original GLib.Variant key. It only returns the transformed PReg key type."}),"\n",(0,s.jsx)(t.li,{children:"The function returns the PReg key type as a string or a list/dictionary of strings. If the PReg key type is a complex type (array or dictionary), the developer should handle the returned list/dictionary appropriately."}),"\n",(0,s.jsx)(t.li,{children:"The function is case-sensitive. The developer should ensure that the key type is in the correct case when checking the type."}),"\n",(0,s.jsx)(t.li,{children:"The function is designed to work with GLib.Variant keys. If the developer wants to use a different type of key, they may need to modify the function accordingly."}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"classdef-gsettings_applier_user",children:"ClassDef gsettings_applier_user"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"gsettings_applier_user"}),": The function of gsettings_applier_user is to serve as a subclass of applier_frontend and apply policies related to GSettings in the user context for the gpoa project."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"attributes"}),":\n\xb7 storage: An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.\n\xb7 file_cache: An instance of the file_cache class, which is used to cache files.\n\xb7 sid: The security identifier (SID) of the user or machine for which policies are being applied.\n\xb7 username: The username for which policies are being applied, if applicable.\n\xb7 gsettings_keys: A list of GSettings keys that have been filtered based on a specific filter.\n\xb7 gsettings: An instance of the user_gsettings class, which is used to interact with user GSettings.\n\xb7 __module_name: The name of the module.\n\xb7 __module_experimental: A boolean value that indicates whether the module is experimental.\n\xb7 __module_enabled: A boolean value that indicates whether the module is enabled.\n\xb7 __registry_branch: A string that contains the registry branch for GSettings policies.\n\xb7 __wallpaper_entry: A string that contains the registry entry for the wallpaper.\n\xb7 __vino_authentication_methods_entry: A string that contains the registry entry for Vino authentication methods.\n\xb7 __windows_settings: A dictionary that contains the mapping of Windows settings to GSettings keys.\n\xb7 windows_settings: A list that contains the mapping of Windows settings to GSettings keys.\n\xb7 __windows_mapping_enabled: A boolean value that indicates whether the mapping of Windows settings to GSettings keys is enabled."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe gsettings_applier_user class is a subclass of applier_frontend and is used to apply policies related to GSettings in the user context for the gpoa project. It contains a number of methods that are intended to be used to provide the actual policy application logic."]}),"\n",(0,s.jsx)(t.p,{children:"The __init__() method initializes the storage, sid, username, gsettings_keys, gsettings, __module_enabled, and __windows_mapping_enabled attributes. It also sets the __module_name, __module_experimental, __registry_branch, __wallpaper_entry, and __vino_authentication_methods_entry attributes based on the class variables. Additionally, it initializes the __windows_settings dictionary and the windows_settings list with a mapping of Windows settings to GSettings keys."}),"\n",(0,s.jsx)(t.p,{children:"The windows_mapping_append() method is used to append the mapping of Windows settings to GSettings keys to the gsettings object. It iterates over the __windows_settings dictionary and sets the GSettings key based on the Windows setting."}),"\n",(0,s.jsx)(t.p,{children:"The uri_fetch_helper() method is used to fetch the URI for a given schema, path, and value. It calls the uri_fetch() method with the provided parameters."}),"\n",(0,s.jsx)(t.p,{children:"The run() method is used to apply the policies related to GSettings. It first checks whether the mapping of Windows settings to GSettings keys is enabled. If it is, it calls the windows_mapping_append() method to append the mapping of Windows settings to GSettings keys to the gsettings object. Then, it iterates over the gsettings_keys list and sets the GSettings key based on the schema, path, and value."}),"\n",(0,s.jsx)(t.p,{children:"The user_context_apply() method is used to apply the policies related to GSettings in the user context. It checks whether the module is enabled and calls the run() method if it is."}),"\n",(0,s.jsx)(t.p,{children:"The __module_name, __module_experimental, and __module_enabled attributes are used by the gpoa application to determine whether the current module should be loaded and applied."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nThe gsettings_applier_user class is intended to be used as a subclass of applier_frontend to apply policies related to GSettings in the user context for the gpoa project. Subclasses should not override the __init__() method, as it contains important initialization logic. Instead, subclasses should override the run() method to provide the actual policy application logic. Subclasses should also set the __module_name, __module_experimental, and __module_enabled attributes appropriately."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Output Example"}),":\nThe output of the gsettings_applier_user class is the application of policies related to GSettings in the user context for the gpoa project. The exact output will depend"]}),"\n",(0,s.jsxs)(t.h3,{id:"functiondef-initself-storage-file_cache-sid-username",children:["FunctionDef ",(0,s.jsx)(t.strong,{children:"init"}),"(self, storage, file_cache, sid, username)"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})}),": The function of ",(0,s.jsx)(t.strong,{children:"init"})," in the gsettings_applier_user class is to initialize an instance of the class with the necessary parameters for managing user's GSettings."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 storage: An instance of the storage class, which provides an interface to access the SQLite database.\n\xb7 file_cache: A file cache object, which is used to cache files that are read or written during the GSettings management process.\n\xb7 sid: A string representing the Security Identifier (SID) of the user associated with the HKCU (HKEY_CURRENT_USER) entries in the Windows registry.\n\xb7 username: A string representing the name of the user associated with the SID."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.strong,{children:"init"})," method initializes several attributes of the class using the provided parameters. It first sets the storage, file_cache, sid, and username attributes to the corresponding input values."]}),"\n",(0,s.jsx)(t.p,{children:"Next, it defines a variable gsettings_filter with a format string that includes the value of the __registry_branch attribute, which is not defined in the provided code. This variable is used to filter HKCU entries in the Windows registry based on a specific pattern."}),"\n",(0,s.jsx)(t.p,{children:"The method then calls the filter_hkcu_entries method of the storage object, passing the sid and gsettings_filter as arguments. The filter_hkcu_entries method returns a query result that matches the specified conditions. The method assigns the result to the gsettings_keys attribute."}),"\n",(0,s.jsx)(t.p,{children:"After that, it creates an instance of the user_gsettings class and assigns it to the gsettings attribute. The user_gsettings class is used to manage a list of user's GSettings."}),"\n",(0,s.jsx)(t.p,{children:"Finally, it calls the check_enabled method with the storage, __module_name, and __module_experimental attributes as arguments. The check_enabled method checks if a module is enabled or not based on the storage and the name of the module. If the module is enabled, it sets the __module_enabled attribute to True. Otherwise, it sets the attribute to False."}),"\n",(0,s.jsx)(t.p,{children:"Similarly, it calls the check_windows_mapping_enabled method with the storage attribute as an argument. The check_windows_mapping_enabled method determines whether the Windows mapping feature is enabled or not. If the feature is enabled, it sets the __windows_mapping_enabled attribute to True. Otherwise, it sets the attribute to False."}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"init"})," method also defines two empty dictionaries, __windows_settings and windows_settings, which are used to store mappings between Windows registry keys and GSettings keys."]}),"\n",(0,s.jsx)(t.p,{children:"The method then defines a list, mapping, which contains several GSettingsMapping objects. Each GSettingsMapping object maps a Windows registry key to a GSettings key. The method extends the windows_settings list with the mapping list."}),"\n",(0,s.jsx)(t.p,{children:"Finally, the method iterates over the windows_settings list and adds each GSettingsMapping object to the __windows_settings dictionary using the hive_key attribute as the key."}),"\n",(0,s.jsxs)(t.p,{children:["From a functional perspective, the ",(0,s.jsx)(t.strong,{children:"init"})," method initializes an instance of the gsettings_applier_user class with the necessary parameters for managing user's GSettings. It filters HKCU entries in the Windows registry based on a specific pattern, creates an instance of the user_gsettings class, and defines mappings between Windows registry keys and GSettings keys. It also checks if the necessary modules and features are enabled or not."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The __registry_branch, __module_name, and __module_experimental attributes are not defined in the provided code, so they should be defined elsewhere in the project."}),"\n",(0,s.jsx)(t.li,{children:"The check_enabled and check_windows_mapping_enabled functions are not defined in the provided code, so they should be defined elsewhere in the project."}),"\n",(0,s.jsxs)(t.li,{children:["The user_gsettings class is not defined in the provided code, but it is used in the ",(0,s.jsx)(t.strong,{children:"init"})," method. It should be defined elsewhere in the project."]}),"\n",(0,s.jsx)(t.li,{children:"The filter_hkcu_entries method is defined in the sqlite_registry class in the sqlite_registry.py module. It is used to filter HKCU entries in the Windows registry based on a specific pattern."}),"\n",(0,s.jsx)(t.li,{children:"The GSettingsMapping class is defined in the gpoa/frontend/gsettings_applier.py/GSettingsMapping file. It is used to map settings between different systems, specifically between the Windows registry and GSettings."}),"\n",(0,s.jsx)(t.li,{children:"The user_gsettings class is used in the gsettings_applier_user class to manage a list of gsettings that will be applied to the user's system. The gsettings_applier_user class initializes an empty user_gsettings object and populates it with gsettings based on the keys in the Windows registry. The windows_settings"}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-windows_mapping_appendself",children:"FunctionDef windows_mapping_append(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"windows_mapping_append"}),": The function of windows_mapping_append is to iterate through the keys in the ",(0,s.jsx)(t.code,{children:"__windows_settings"})," dictionary and append the corresponding values to the GSettings if the schema and path already exist. If not, a log message is generated indicating that the schema and path do not exist."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,s.jsx)(t.code,{children:"self"}),": The instance of the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," object."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-uri_fetch_helperself-schema-path-value-1",children:"FunctionDef uri_fetch_helper(self, schema, path, value)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"uri_fetch_helper"}),": The function of uri_fetch_helper is to serve as a helper function for fetching and caching URIs within the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," and ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," classes. It does this by calling the ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function and passing in the necessary parameters, including a file cache instance."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 schema: A string representing the schema of the URI.\n\xb7 path: A string representing the path of the URI.\n\xb7 value: A string representing the URI to be fetched and cached."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function takes in three parameters: ",(0,s.jsx)(t.code,{children:"schema"}),", ",(0,s.jsx)(t.code,{children:"path"}),", and ",(0,s.jsx)(t.code,{children:"value"}),". It begins by calling the ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function, passing in the ",(0,s.jsx)(t.code,{children:"schema"}),", ",(0,s.jsx)(t.code,{children:"path"}),", ",(0,s.jsx)(t.code,{children:"value"}),", and ",(0,s.jsx)(t.code,{children:"self.file_cache"})," parameters. The ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function is responsible for fetching and caching the given URI, and returning the cached value if it exists, or the original value if it does not."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function acts as a wrapper around the ",(0,s.jsx)(t.code,{children:"uri_fetch"})," function, providing a convenient way to fetch and cache URIs within the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," and ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," classes. By passing in ",(0,s.jsx)(t.code,{children:"self.file_cache"})," as the cache parameter, the classes are able to leverage the caching functionality provided by the ",(0,s.jsx)(t.code,{children:"fs_file_cache"})," class."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function is called by the ",(0,s.jsx)(t.code,{children:"run"})," function within the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," class. The ",(0,s.jsx)(t.code,{children:"run"})," function uses the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function to fetch and cache URIs for each setting in the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list. By doing so, it is able to improve the performance of the application by reducing the number of unnecessary network requests."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nIt is important to ensure that the ",(0,s.jsx)(t.code,{children:"self.file_cache"})," parameter passed into the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function is an instance of the ",(0,s.jsx)(t.code,{children:"fs_file_cache"})," class. Failure to do so may result in unexpected behavior or errors."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Output Example"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"schema = 'smb'\npath = '/server/share'\nvalue = '\\\\server\\share'\n\n# Within the gsettings_applier_user.run() function\ncached_uri = self.uri_fetch_helper(schema, path, value)\n# cached_uri may contain either the cached URI or the original URI if it was not found in the cache\n"})}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-runself-1",children:"FunctionDef run(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"run"}),": The function of run is to apply all configured GSettings keys and handle Windows mapping if enabled."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),": This function does not take any parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"run"})," function is responsible for applying all configured GSettings keys and handling Windows mapping if enabled. It first checks if Windows mapping is enabled by checking the ",(0,s.jsx)(t.code,{children:"__windows_mapping_enabled"})," attribute. If it is enabled, the ",(0,s.jsx)(t.code,{children:"windows_mapping_append"})," function is called to calculate all mapped GSettings. If it is not enabled, a log message is generated indicating that Windows mapping is not enabled."]}),"\n",(0,s.jsxs)(t.p,{children:["Next, the function iterates through all GSettings keys in the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list. For each key, it extracts the schema, path, and data from the key's ",(0,s.jsx)(t.code,{children:"hive_key"})," attribute. It also checks if the key is the wallpaper entry or the Vino authentication methods entry, and modifies the data accordingly."]}),"\n",(0,s.jsxs)(t.p,{children:["If a helper function is required to fetch the URI for the key, the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function is called with the schema, path, and value as parameters. The helper function returns a modified value, which is then appended to the GSettings using the ",(0,s.jsx)(t.code,{children:"append"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings"})," object."]}),"\n",(0,s.jsxs)(t.p,{children:["Finally, the ",(0,s.jsx)(t.code,{children:"apply"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings"})," object is called to apply all the calculated GSettings."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function is called in the ",(0,s.jsx)(t.code,{children:"user_context_apply"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," object in the ",(0,s.jsx)(t.code,{children:"gsettings_applier.py"})," module. The ",(0,s.jsx)(t.code,{children:"user_context_apply"})," method checks if the module is enabled, and if it is, it calls the ",(0,s.jsx)(t.code,{children:"run"})," method to apply all the configured GSettings keys."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,s.jsx)(t.code,{children:"run"})," function is called by the ",(0,s.jsx)(t.code,{children:"user_context_apply"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," object in the ",(0,s.jsx)(t.code,{children:"gsettings_applier.py"})," module. The ",(0,s.jsx)(t.code,{children:"user_context_apply"})," method checks if the module is enabled, and if it is, it calls the ",(0,s.jsx)(t.code,{children:"run"})," method to apply all the configured GSettings keys."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function uses the ",(0,s.jsx)(t.code,{children:"windows_mapping_append"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," object in the ",(0,s.jsx)(t.code,{children:"gsettings_applier.py"})," module to calculate all mapped GSettings if Windows mapping is enabled. It also uses the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function of the ",(0,s.jsx)(t.code,{children:"gsettings_applier_user"})," object in the ",(0,s.jsx)(t.code,{children:"gsettings_applier.py"})," module to fetch URIs for the GSettings keys if necessary."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function also uses the ",(0,s.jsx)(t.code,{children:"append"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings"})," object in the ",(0,s.jsx)(t.code,{children:"user_gsettings"})," module to append the GSettings keys to the GSettings database."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nThe ",(0,s.jsx)(t.code,{children:"run"})," function assumes that the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list contains valid GSettings keys with ",(0,s.jsx)(t.code,{children:"hive_key"})," attributes. If the list contains invalid keys, the function may raise an ",(0,s.jsx)(t.code,{children:"AttributeError"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Additionally, the ",(0,s.jsx)(t.code,{children:"run"})," function relies on the ",(0,s.jsx)(t.code,{children:"windows_mapping_append"}),", ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"}),", and ",(0,s.jsx)(t.code,{children:"append"})," functions to perform its tasks. If these functions are not properly implemented, the ",(0,s.jsx)(t.code,{children:"run"})," function may not work as expected."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-user_context_applyself",children:"FunctionDef user_context_apply(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"user_context_apply"}),": The function of user_context_apply is to apply all configured GSettings keys and handle Windows mapping if enabled in the user context."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),": This function does not take any parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,s.jsx)(t.code,{children:"user_context_apply"})," function is responsible for applying all configured GSettings keys in the user context and handling Windows mapping if enabled. It first checks if the module is enabled by accessing the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute. If the module is enabled, the ",(0,s.jsx)(t.code,{children:"run"})," function is called to apply all configured GSettings keys. Otherwise, a log message is generated indicating that the module is not enabled."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function is defined in the same class and is responsible for applying all configured GSettings keys and handling Windows mapping if enabled. It first calculates all mapped GSettings if Windows mapping is enabled by calling the ",(0,s.jsx)(t.code,{children:"windows_mapping_append"})," function. If Windows mapping is not enabled, it proceeds to iterate through all GSettings keys in the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list. For each key, it extracts the schema, path, and data from the key's ",(0,s.jsx)(t.code,{children:"hive_key"})," attribute. It also checks if the key is the wallpaper entry or the Vino authentication methods entry, and modifies the data accordingly."]}),"\n",(0,s.jsxs)(t.p,{children:["If a helper function is required to fetch the URI for the key, the ",(0,s.jsx)(t.code,{children:"uri_fetch_helper"})," function is called with the schema, path, and value as parameters. The helper function returns a modified value, which is then appended to the GSettings using the ",(0,s.jsx)(t.code,{children:"append"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings"})," object."]}),"\n",(0,s.jsxs)(t.p,{children:["Finally, the ",(0,s.jsx)(t.code,{children:"apply"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings"})," object is called to apply all the calculated GSettings."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"user_context_apply"})," function is called in the ",(0,s.jsx)(t.code,{children:"run"})," method of the ",(0,s.jsx)(t.code,{children:"gsettings_applier"})," object in the ",(0,s.jsx)(t.code,{children:"gsettings_applier.py"})," module. The ",(0,s.jsx)(t.code,{children:"run"})," method checks if the module is enabled, and if it is, it calls the ",(0,s.jsx)(t.code,{children:"user_context_apply"})," method to apply all the configured GSettings keys in the user context."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nThe ",(0,s.jsx)(t.code,{children:"user_context_apply"})," function assumes that the ",(0,s.jsx)(t.code,{children:"gsettings_keys"})," list contains valid GSettings keys with ",(0,s.jsx)(t.code,{children:"hive_key"})," attributes. If the list contains invalid keys, the function may raise an ",(0,s.jsx)(t.code,{children:"AttributeError"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Additionally, the ",(0,s.jsx)(t.code,{children:"user_context_apply"})," function relies on the ",(0,s.jsx)(t.code,{children:"run"})," function to perform its tasks. If the ",(0,s.jsx)(t.code,{children:"run"})," function is not properly implemented, the ",(0,s.jsx)(t.code,{children:"user_context_apply"})," function may not work as expected."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-admin_context_applyself",children:"FunctionDef admin_context_apply(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"admin_context_apply"}),": The function of admin_context_apply is to apply administrative context for the user by caching files from remote locations if necessary."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 self: The instance of the class that the method is called upon."]}),"\n",(0,s.jsx)(t.hr,{})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>h});var s=n(6540);const i={},r=s.createContext(i);function a(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function h(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);