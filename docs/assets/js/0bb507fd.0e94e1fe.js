"use strict";(self.webpackChunkgpupdate_docs=self.webpackChunkgpupdate_docs||[]).push([[1839],{7580:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>l,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var i=t(4848),s=t(8453);const r={},o=void 0,c={id:"gpoa/frontend/cups_applier",title:"cups_applier",description:"FunctionDef storagegetprinters(storage, sid)",source:"@site/docs/gpoa/frontend/cups_applier.md",sourceDirName:"gpoa/frontend",slug:"/gpoa/frontend/cups_applier",permalink:"/docs/gpoa/frontend/cups_applier",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"control_applier",permalink:"/docs/gpoa/frontend/control_applier"},next:{title:"envvar_applier",permalink:"/docs/gpoa/frontend/envvar_applier"}},a={},d=[{value:"FunctionDef storage_get_printers(storage, sid)",id:"functiondef-storage_get_printersstorage-sid",level:2},{value:"FunctionDef connect_printer(connection, prn)",id:"functiondef-connect_printerconnection-prn",level:2},{value:"ClassDef cups_applier",id:"classdef-cups_applier",level:2},{value:"FunctionDef <strong>init</strong>(self, storage)",id:"functiondef-initself-storage",level:3},{value:"FunctionDef run(self)",id:"functiondef-runself",level:3},{value:"FunctionDef apply(self)",id:"functiondef-applyself",level:3},{value:"ClassDef cups_applier_user",id:"classdef-cups_applier_user",level:2},{value:"FunctionDef <strong>init</strong>(self, storage, sid, username)",id:"functiondef-initself-storage-sid-username",level:3},{value:"FunctionDef user_context_apply(self)",id:"functiondef-user_context_applyself",level:3},{value:"FunctionDef run(self)",id:"functiondef-runself-1",level:3},{value:"FunctionDef admin_context_apply(self)",id:"functiondef-admin_context_applyself",level:3}];function h(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"functiondef-storage_get_printersstorage-sid",children:"FunctionDef storage_get_printers(storage, sid)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"storage_get_printers"}),": The function of ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," is to query printer configurations from the storage. It takes a ",(0,i.jsx)(n.code,{children:"storage"})," object and a ",(0,i.jsx)(n.code,{children:"sid"})," as arguments and returns a list of ",(0,i.jsx)(n.code,{children:"printer_entry"})," objects associated with the given ",(0,i.jsx)(n.code,{children:"sid"})," from the storage."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 ",(0,i.jsx)(n.code,{children:"storage"}),": The storage object that contains the printer configurations.\n\xb7 ",(0,i.jsx)(n.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the ",(0,i.jsx)(n.code,{children:"printer_entry"})," objects in the storage."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," function is called in the ",(0,i.jsx)(n.code,{children:"run"})," method of both ",(0,i.jsx)(n.code,{children:"cups_applier"})," and ",(0,i.jsx)(n.code,{children:"cups_applier_user"})," classes in the ",(0,i.jsx)(n.code,{children:"cups_applier.py"})," module. It is responsible for retrieving the printer configurations associated with a given SID from the storage."]}),"\n",(0,i.jsxs)(n.p,{children:["The function first initializes an empty list ",(0,i.jsx)(n.code,{children:"printers"})," to store the ",(0,i.jsx)(n.code,{children:"printer_entry"})," objects. It then calls the ",(0,i.jsx)(n.code,{children:"get_printers"})," method of the ",(0,i.jsx)(n.code,{children:"sqlite_registry"})," class, which is a method of the ",(0,i.jsx)(n.code,{children:"storage"})," object, and passes the ",(0,i.jsx)(n.code,{children:"sid"})," as an argument. The ",(0,i.jsx)(n.code,{children:"get_printers"})," method returns a list of ",(0,i.jsx)(n.code,{children:"printer_entry"})," objects associated with the given SID, which is then appended to the ",(0,i.jsx)(n.code,{children:"printers"})," list."]}),"\n",(0,i.jsxs)(n.p,{children:["Finally, the ",(0,i.jsx)(n.code,{children:"printers"})," list is returned, which contains the ",(0,i.jsx)(n.code,{children:"printer_entry"})," objects associated with the given SID."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":\nThe ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," function is called with a ",(0,i.jsx)(n.code,{children:"storage"})," object and a ",(0,i.jsx)(n.code,{children:"sid"})," as arguments. The ",(0,i.jsx)(n.code,{children:"storage"})," object should be an instance of the ",(0,i.jsx)(n.code,{children:"sqlite_registry"})," class, and the ",(0,i.jsx)(n.code,{children:"sid"})," should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n",(0,i.jsxs)(n.p,{children:["Additionally, the ",(0,i.jsx)(n.code,{children:"storage_get_printers"})]}),"\n",(0,i.jsx)(n.h2,{id:"functiondef-connect_printerconnection-prn",children:"FunctionDef connect_printer(connection, prn)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"connect_printer"}),": The function of connect_printer is to configure and add a printer to the CUPS (Common Unix Printing System) printing system."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 connection: The cups.Connection object, which is the connection to the CUPS server.\n\xb7 prn: The printer object, which contains the printer's information."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe function first sets the printer driver to 'generic', then it extracts the printer's name, information, and URI from the 'prn' object. The printer's URI is converted to the format that CUPS accepts. Finally, it calls the 'addPrinter' method of the 'connection' object to add the printer to the CUPS system."]}),"\n",(0,i.jsx)(n.p,{children:"This function is used in the 'run' method of the 'cups_applier' and 'cups_applier_user' objects in the 'gpoa/frontend/cups_applier.py' module. These objects are responsible for applying and managing printer configurations in the CUPS printing system. The 'connect_printer' function is called in a loop to add all the printers that are retrieved from the storage."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The 'connection' parameter should be a valid cups.Connection object, otherwise, it will raise an exception when calling the 'addPrinter' method."}),"\n",(0,i.jsx)(n.li,{children:"The 'prn' parameter should be a printer object that contains the necessary information to add a printer to the CUPS system."}),"\n",(0,i.jsx)(n.li,{children:"The 'addPrinter' method may raise an exception if the printer with the same name already exists or if there is an error in the printer's information. It is recommended to handle the exception in the caller function."}),"\n",(0,i.jsx)(n.li,{children:"The 'filename' parameter in the 'addPrinter' method is optional, if not provided, CUPS will use the default PPD file for the printer driver."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"classdef-cups_applier",children:"ClassDef cups_applier"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"cups_applier"}),": The ",(0,i.jsx)(n.code,{children:"cups_applier"})," class is responsible for configuring printers that are assigned to a computer in the gpoa project. It is a subclass of ",(0,i.jsx)(n.code,{children:"applier_frontend"}),", which provides a base class for all frontend modules that apply policies."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Attributes"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"storage"}),": An instance of the ",(0,i.jsx)(n.code,{children:"storage"})," class, which is used to interact with the Windows Registry and other storage mechanisms."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"__init__()"})," method initializes the ",(0,i.jsx)(n.code,{children:"storage"})," attribute and sets the ",(0,i.jsx)(n.code,{children:"__module_enabled__"})," attribute based on the result of a call to ",(0,i.jsx)(n.code,{children:"check_enabled()"}),". The ",(0,i.jsx)(n.code,{children:"check_enabled()"})," method checks whether the current module is enabled in the gpoa configuration, and returns ",(0,i.jsx)(n.code,{children:"True"})," if it is, and ",(0,i.jsx)(n.code,{children:"False"})," otherwise."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"run()"})," method is responsible for configuring the printers that are assigned to a computer. It first checks if the ",(0,i.jsx)(n.code,{children:"cups"})," RPM package is installed, and if not, it logs a warning message (W9) and returns. If the package is installed, it then tries to create a connection to the CUPS server using the ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," class. If an exception is raised during this process, it logs the exception details (W20). The method then retrieves the list of printers assigned to the computer from the storage using the ",(0,i.jsx)(n.code,{children:"storage_get_printers()"})," function and the machine's SID. If there are any printers in the list, it iterates through each printer and connects it to the CUPS server using the ",(0,i.jsx)(n.code,{children:"connect_printer()"})," function."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"apply()"})," method checks if the current module is enabled and if so, it calls the ",(0,i.jsx)(n.code,{children:"run()"})," method to configure the printers. If the module is not enabled, it logs a message (D114)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups_applier"})," class is intended to be used as a subclass of ",(0,i.jsx)(n.code,{children:"applier_frontend"})," and should not be instantiated directly."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"run()"})," method assumes that the ",(0,i.jsx)(n.code,{children:"cups"})," RPM package is installed on the system. If it is not installed, a warning message will be logged and the method will return."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups_applier"})," class is used by the ",(0,i.jsx)(n.code,{children:"frontend_manager"})," class to configure printers on a computer."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Example"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"cups_applier"})," class may return the following output when configuring printers:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"D113\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This indicates that the ",(0,i.jsx)(n.code,{children:"cups_applier"})," module is enabled and the ",(0,i.jsx)(n.code,{children:"run()"})," method has been called to configure the printers."]}),"\n",(0,i.jsxs)(n.h3,{id:"functiondef-initself-storage",children:["FunctionDef ",(0,i.jsx)(n.strong,{children:"init"}),"(self, storage)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.strong,{children:"init"})}),": The function of ",(0,i.jsx)(n.strong,{children:"init"})," is to initialize the cups_applier object with a storage object."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 storage: The storage object that contains the information about the modules."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe function takes in a storage object as a parameter, which is used to check if a module is enabled or not based on its name. It sets the storage object as an attribute of the cups_applier object, allowing it to be accessed by other methods within the object."]}),"\n",(0,i.jsxs)(n.p,{children:["The function calls the ",(0,i.jsx)(n.code,{children:"check_enabled"})," function, which is located in the ",(0,i.jsx)(n.code,{children:"applier_frontend.py"})," module, passing in the storage object, the name of the module, and a boolean value indicating whether the module is experimental or not. The ",(0,i.jsx)(n.code,{children:"check_enabled"})," function checks if the module is enabled or not based on the storage and the name of the module, and returns a boolean value. This value is then used to determine if the module should be applied or not."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"__init__"})," function is called when a new cups_applier object is created, ensuring that the storage object is properly initialized and available for use by other methods within the object."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":\nIt is important to ensure that the storage object passed to the ",(0,i.jsx)(n.code,{children:"__init__"})," function is properly initialized and contains the necessary information about the modules. If the storage object is not properly initialized, the ",(0,i.jsx)(n.code,{children:"check_enabled"})," function may not be able to accurately determine if a module is enabled or not, leading to unexpected results."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"functiondef-runself",children:"FunctionDef run(self)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"run"}),": The function of run is to apply printer configurations to the CUPS printing system if the module is enabled."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 self: The cups_applier object that contains the necessary information to apply printer configurations."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe run function first checks if the module is enabled by calling the ",(0,i.jsx)(n.code,{children:"__module_enabled"})," attribute. If the module is enabled, it logs a debug message 'D113' and calls the ",(0,i.jsx)(n.code,{children:"run"})," method to apply the printer configurations. If the module is not enabled, it logs a debug message 'D114'."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," method is responsible for connecting to the CUPS server, getting the list of printers from the storage, and applying the printer configurations. It first checks if the RPM package 'cups' is installed. If the package is not installed, it logs a warning message 'W9' and returns. If the package is installed, it creates a connection to the CUPS server using the ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method. If there is an exception while creating the connection, it logs the exception details and returns."]}),"\n",(0,i.jsxs)(n.p,{children:["The function then gets the list of printers from the storage by calling the ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," method and passing the ",(0,i.jsx)(n.code,{children:"storage"})," and ",(0,i.jsx)(n.code,{children:"machine_sid"})," as arguments. If there are any printers, it loops through each printer and calls the ",(0,i.jsx)(n.code,{children:"connect_printer"})," method to connect to the printer and apply the configuration."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"connect_printer"})," method takes the ",(0,i.jsx)(n.code,{children:"cups_connection"})," and ",(0,i.jsx)(n.code,{children:"prn"})," as arguments and sets the printer driver to 'generic'. It then extracts the printer's name, information, and URI from the ",(0,i.jsx)(n.code,{children:"prn"})," object. The printer's URI is converted to the format that CUPS accepts. Finally, it calls the ",(0,i.jsx)(n.code,{children:"addPrinter"})," method of the ",(0,i.jsx)(n.code,{children:"cups_connection"})," object to add the printer to the CUPS system."]}),"\n",(0,i.jsxs)(n.p,{children:["This function is used in the ",(0,i.jsx)(n.code,{children:"apply"})," method of the ",(0,i.jsx)(n.code,{children:"cups_applier"})," object in the ",(0,i.jsx)(n.code,{children:"gpoa/frontend/cups_applier.py"})," module. The ",(0,i.jsx)(n.code,{children:"apply"})," method is responsible for performing the configuration of the printer that is assigned to the computer."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups_applier"})," object should be a valid object that contains the necessary information to apply printer configurations."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"storage"})," object should be a valid object that contains the necessary printer information."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"machine_sid"})," should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method may raise an exception if there is an error in creating the connection to the CUPS server. It is recommended to handle the exception in the caller function."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"addPrinter"})," method may raise an exception if the printer with the same name already exists or if there is an error in the printer's information. It is recommended to handle the exception in the caller function."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example usage of cups_applier object\ncups_applier = cups_applier()\ncups_applier.run()\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the ",(0,i.jsx)(n.code,{children:"cups_applier"})," object is created and the ",(0,i.jsx)(n.code,{children:"run"})," method is called to apply the printer configurations to the CUPS printing system."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"functiondef-applyself",children:"FunctionDef apply(self)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"apply"}),": The function of apply is to perform configuration of printer which is assigned to computer."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 self: The cups_applier object that contains the necessary information to apply printer configurations."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe apply function is a method of the cups_applier class that performs configuration of printer which is assigned to computer. It first checks if the module is enabled by calling the ",(0,i.jsx)(n.code,{children:"__module_enabled"})," attribute. If the module is enabled, it logs a debug message 'D113' and calls the ",(0,i.jsx)(n.code,{children:"run"})," method to apply the printer configurations. If the module is not enabled, it logs a debug message 'D114'."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," method is responsible for connecting to the CUPS server, getting the list of printers from the storage, and applying the printer configurations. It first checks if the RPM package 'cups' is installed. If the package is not installed, it logs a warning message 'W9' and returns. If the package is installed, it creates a connection to the CUPS server using the ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method. If there is an exception while creating the connection, it logs the exception details and returns."]}),"\n",(0,i.jsxs)(n.p,{children:["The function then gets the list of printers from the storage by calling the ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," method and passing the ",(0,i.jsx)(n.code,{children:"storage"})," and ",(0,i.jsx)(n.code,{children:"machine_sid"})," as arguments. If there are any printers, it loops through each printer and calls the ",(0,i.jsx)(n.code,{children:"connect_printer"})," method to connect to the printer and apply the configuration."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"connect_printer"})," method takes the ",(0,i.jsx)(n.code,{children:"cups_connection"})," and ",(0,i.jsx)(n.code,{children:"prn"})," as arguments and sets the printer driver to 'generic'. It then extracts the printer's name, information, and URI from the ",(0,i.jsx)(n.code,{children:"prn"})," object. The printer's URI is converted to the format that CUPS accepts. Finally, it calls the ",(0,i.jsx)(n.code,{children:"addPrinter"})," method of the ",(0,i.jsx)(n.code,{children:"cups_connection"})," object to add the printer to the CUPS system."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method may raise an exception if there is an error in creating the connection to the CUPS server. It is recommended to handle the exception in the caller function. The ",(0,i.jsx)(n.code,{children:"addPrinter"})," method may raise an exception if the printer with the same name already exists or if there is an error in the printer's information. It is recommended to handle the exception in the caller function."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups_applier"})," object should be a valid object that contains the necessary information to apply printer configurations."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"storage"})," object should be a valid object that contains the necessary printer information."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"machine_sid"})," should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method may raise an exception if there is an error in creating the connection to the CUPS server. It is recommended to handle the exception in the caller function."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"addPrinter"})," method may raise an exception if the printer with the same name already exists or if there is an error in the printer's information. It is recommended to handle the exception in the caller function."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Relation to other functions"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"apply"})," function calls the ",(0,i.jsx)(n.code,{children:"run"})," method of the ",(0,i.jsx)(n.code,{children:"cups_applier"})," object to apply the printer configurations."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," method creates a connection to the CUPS server using the ",(0,i.jsx)(n.code,{children:"cups.Connection()"})," method."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," method gets the list of printers from the storage by calling the ",(0,i.jsx)(n.code,{children:"storage_get_printers"})," method."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"run"})," method loops through each printer and calls the ",(0,i.jsx)(n.code,{children:"connect_printer"})," method to connect to the printer and apply the configuration."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"connect_printer"})," method sets the printer driver to 'generic' and extracts the printer's name, information, and URI from the ",(0,i.jsx)(n.code,{children:"prn"})," object."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"connect_printer"})," method calls the ",(0,i.jsx)(n.code,{children:"addPrinter"})," method of the ",(0,i.jsx)(n.code,{children:"cups_connection"})," object to add the printer to the CUPS system."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example usage of cups_applier object\ncups_applier = cups_applier()\ncups_applier.apply()\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the ",(0,i.jsx)(n.code,{children:"cups_applier"})," object is created and the ",(0,i.jsx)(n.code,{children:"apply"})," method is called to apply the printer configurations to the CUPS printing system."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"classdef-cups_applier_user",children:"ClassDef cups_applier_user"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"cups_applier_user"}),": The function of cups_applier_user is to serve as a subclass of applier_frontend and implement the policy application logic for CUPS (Common Unix Printing System) printer configurations in the admin context."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"attributes"}),":\n\xb7 storage: An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.\n\xb7 sid: The security identifier (SID) of the user or machine for which policies are being applied.\n\xb7 username: The username for which policies are being applied, if applicable."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe cups_applier_user class is a subclass of applier_frontend and is used to implement the policy application logic for CUPS printer configurations in the admin context. It overrides the __init__() method to initialize the storage and sid attributes, and sets the __module_enabled__ attribute based on the result of a call to check_enabled()."]}),"\n",(0,i.jsx)(n.p,{children:"The user_context_apply() method is not overridden, so it simply does nothing when called. The run() method is implemented to install the CUPS package if it is not already installed, and then connect to the printers specified in the storage for the given sid."}),"\n",(0,i.jsx)(n.p,{children:"The admin_context_apply() method is overridden to perform the printer configuration assigned for the user if the current module is enabled in the gpoa configuration. If the module is not enabled, it does nothing."}),"\n",(0,i.jsx)(n.p,{children:"The __module_name__, __module_experimental__, and __module_enabled__ attributes are used by the gpoa application to determine whether the current module should be loaded and applied."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":\nThe cups_applier_user class is intended to be used as a subclass of applier_frontend to implement the policy application logic for CUPS printer configurations in the admin context. Subclasses should not override the user_context_apply() method, as it is not used in this context. Subclasses should also ensure that the __module_name__, __module_experimental__, and __module_enabled__ attributes are set appropriately."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Example"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example usage of cups_applier_user\n\nfrom gpoa.frontend.applier_frontend import applier_frontend\nfrom gpoa.storage import Storage\n\n# Initialize storage and sid\nstorage = Storage()\nsid = 'S-1-5-21-1234567890-1234567890-1234567890-123456'\n\n# Initialize cups_applier_user\ncups_applier = cups_applier_user(storage, sid, 'username')\n\n# Apply policies in admin context\ncups_applier.admin_context_apply()\n"})}),"\n",(0,i.jsx)(n.p,{children:"This will install the CUPS package if it is not already installed, and then connect to the printers specified in the storage for the given sid in the admin context."}),"\n",(0,i.jsxs)(n.h3,{id:"functiondef-initself-storage-sid-username",children:["FunctionDef ",(0,i.jsx)(n.strong,{children:"init"}),"(self, storage, sid, username)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.strong,{children:"init"})}),": The function of ",(0,i.jsx)(n.strong,{children:"init"})," is to initialize the cups_applier_user object with the required parameters."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),": The parameters of this Function.\n\xb7 storage: The storage object that contains the information about the modules.\n\xb7 sid: The sid of the user.\n\xb7 username: The username."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),": The ",(0,i.jsx)(n.strong,{children:"init"})," function initializes the cups_applier_user object with the required parameters. It sets the storage, sid, and username attributes with the provided parameters. It then calls the check_enabled function, passing in the storage, __module_name, and __module_enabled attributes as parameters. The check_enabled function checks if the module is enabled or not based on the storage and the name of the module. The result of this function call is stored in the __module_enabled attribute."]}),"\n",(0,i.jsx)(n.p,{children:"The __module_name attribute is not defined in this function, but it is used in the check_enabled function. It is likely that this attribute is defined elsewhere in the cups_applier_user class and is used to determine if the module is enabled or not."}),"\n",(0,i.jsx)(n.p,{children:"The check_enabled function is defined in the applier_frontend module and is used to check if a module is enabled or not based on the storage and the name of the module. It first retrieves the value of the module_name from the storage using the get_value method. If the value is not found or is None, it sets the value to False. Then, it checks if the module is enabled by comparing the value of the module_name with the value of the module_experimental parameter. If the module is experimental and not enabled, it sets the value of the module_name to False. Finally, it returns the value of the module_name."}),"\n",(0,i.jsx)(n.p,{children:"The check_enabled function is called with the __module_name and __module_enabled attributes as parameters. These attributes are likely defined elsewhere in the cups_applier_user class and are used to determine if the module is enabled or not."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": None."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"functiondef-user_context_applyself",children:"FunctionDef user_context_apply(self)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"user_context_apply"}),": The function of user_context_apply does not perform any specific operation. It is a placeholder function with an intention to not implement printer configuration as part of user context."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Parameters"}),": This function does not take any parameters."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:["The function is defined as ",(0,i.jsx)(n.code,{children:"def user_context_apply(self):"})," with ",(0,i.jsx)(n.code,{children:"self"})," as a parameter, which represents the instance of the class to which this method belongs."]}),"\n",(0,i.jsx)(n.p,{children:"The function body contains a docstring that explains the reason behind not implementing printer configuration in the user context:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"'''\nPrinter configuration is the system configuration so there\nis no point in implementing this function.\n'''\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The function itself is empty, indicated by the ",(0,i.jsx)(n.code,{children:"pass"})," statement, which is a placeholder and does nothing when executed."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"This function is intended to be a placeholder and does not perform any operation."}),"\n",(0,i.jsx)(n.li,{children:"If you need to implement user context-specific functionality, you should modify this function or create a new one, ensuring it meets your requirements."}),"\n",(0,i.jsx)(n.li,{children:"Always check the docstring for any function to understand the reasoning behind its implementation or lack thereof."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"functiondef-runself-1",children:"FunctionDef run(self)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"run"}),": The function of run is to apply printer configurations for a user in the CUPS printing system based on the user's SID (Security Identifier)."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 ",(0,i.jsx)(n.code,{children:"self"}),": The cups_applier_user object that contains the user's printer configurations."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code Description"}),":\nThe run function first checks if the 'cups' package is installed in the system using the is_rpm_installed function. If the package is not installed, it logs a warning message and returns."]}),"\n",(0,i.jsx)(n.p,{children:"If the package is installed, it creates a connection to the CUPS server using the cups.Connection() function. It then retrieves the list of printer configurations associated with the user's SID from the storage using the storage_get_printers function."}),"\n",(0,i.jsx)(n.p,{children:"If there are any printer configurations, it loops through each configuration and calls the connect_printer function to add each printer to the CUPS system."}),"\n",(0,i.jsx)(n.p,{children:"This function is called by the admin_context_apply function of the cups_applier_user object in the cups_applier.py module. The cups_applier_user object is responsible for applying and managing printer configurations for a specific user in the CUPS printing system."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The run function assumes that the cups_applier_user object has a valid SID and a valid connection to the storage."}),"\n",(0,i.jsx)(n.li,{children:"The run function may raise an exception if there is an error in the printer configurations or if there is an error in adding the printers to the CUPS system. It is recommended to handle the exception in the caller function."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Example"}),":\nSuppose we have a database table ",(0,i.jsx)(n.code,{children:"printer_entry"})," with the following data:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"id"}),(0,i.jsx)(n.th,{children:"name"}),(0,i.jsx)(n.th,{children:"sid"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Printer1"}),(0,i.jsx)(n.td,{children:"S-1-5-21-1234"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Printer2"}),(0,i.jsx)(n.td,{children:"S-1-5-21-5678"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"3"}),(0,i.jsx)(n.td,{children:"Printer3"}),(0,i.jsx)(n.td,{children:"S-1-5-21-9012"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Calling ",(0,i.jsx)(n.code,{children:"cups_applier_user.admin_context_apply(cups_applier_user_obj)"})," will apply the printer configurations associated with the user's SID to the CUPS system. In this example, if the user's SID is ",(0,i.jsx)(n.code,{children:"S-1-5-21-1234"}),", the ",(0,i.jsx)(n.code,{children:"run"})," function will add the ",(0,i.jsx)(n.code,{children:"Printer1"})," to the CUPS system."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"functiondef-admin_context_applyself",children:"FunctionDef admin_context_apply(self)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"admin_context_apply"}),": The function of admin_context_apply is to perform printer configuration assigned for a user based on the status of a module."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"parameters"}),":\n\xb7 ",(0,i.jsx)(n.code,{children:"self"}),": The cups_applier_user object that contains the user's printer configurations."]}),"\n",(0,i.jsx)(n.hr,{})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);