"use strict";(self.webpackChunkgpupdate_docs=self.webpackChunkgpupdate_docs||[]).push([[8185],{9568:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var n=i(4848),s=i(8453);const r={},d=void 0,o={id:"gpoa/storage/sqlite_registry",title:"sqlite_registry",description:"ClassDef sqlite_registry",source:"@site/docs/gpoa/storage/sqlite_registry.md",sourceDirName:"gpoa/storage",slug:"/gpoa/storage/sqlite_registry",permalink:"/gpupdate-docs/docs/gpoa/storage/sqlite_registry",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"sqlite_cache",permalink:"/gpupdate-docs/docs/gpoa/storage/sqlite_cache"},next:{title:"sqlite_registry_compat",permalink:"/gpupdate-docs/docs/gpoa/storage/sqlite_registry_compat"}},a={},c=[{value:"ClassDef sqlite_registry",id:"classdef-sqlite_registry",level:2},{value:"FunctionDef <strong>init</strong>(self, db_name, registry_cache_dir)",id:"functiondef-initself-db_name-registry_cache_dir",level:3},{value:"FunctionDef _add(self, row)",id:"functiondef-_addself-row",level:3},{value:"FunctionDef _info_upsert(self, row)",id:"functiondef-_info_upsertself-row",level:3},{value:"FunctionDef _hklm_upsert(self, row)",id:"functiondef-_hklm_upsertself-row",level:3},{value:"FunctionDef _hkcu_upsert(self, row)",id:"functiondef-_hkcu_upsertself-row",level:3},{value:"FunctionDef _shortcut_upsert(self, row)",id:"functiondef-_shortcut_upsertself-row",level:3},{value:"FunctionDef _printer_upsert(self, row)",id:"functiondef-_printer_upsertself-row",level:3},{value:"FunctionDef _drive_upsert(self, row)",id:"functiondef-_drive_upsertself-row",level:3},{value:"FunctionDef set_info(self, name, value)",id:"functiondef-set_infoself-name-value",level:3},{value:"FunctionDef _delete_hklm_keyname(self, keyname)",id:"functiondef-_delete_hklm_keynameself-keyname",level:3},{value:"FunctionDef add_hklm_entry(self, preg_entry, policy_name)",id:"functiondef-add_hklm_entryself-preg_entry-policy_name",level:3},{value:"FunctionDef _delete_hkcu_keyname(self, keyname, sid)",id:"functiondef-_delete_hkcu_keynameself-keyname-sid",level:3},{value:"FunctionDef add_hkcu_entry(self, preg_entry, sid, policy_name)",id:"functiondef-add_hkcu_entryself-preg_entry-sid-policy_name",level:3},{value:"FunctionDef add_shortcut(self, sid, sc_obj, policy_name)",id:"functiondef-add_shortcutself-sid-sc_obj-policy_name",level:3},{value:"FunctionDef add_printer(self, sid, pobj, policy_name)",id:"functiondef-add_printerself-sid-pobj-policy_name",level:3},{value:"FunctionDef add_drive(self, sid, dobj, policy_name)",id:"functiondef-add_driveself-sid-dobj-policy_name",level:3},{value:"FunctionDef add_folder(self, sid, fobj, policy_name)",id:"functiondef-add_folderself-sid-fobj-policy_name",level:3},{value:"FunctionDef add_envvar(self, sid, evobj, policy_name)",id:"functiondef-add_envvarself-sid-evobj-policy_name",level:3},{value:"FunctionDef add_script(self, sid, scrobj, policy_name)",id:"functiondef-add_scriptself-sid-scrobj-policy_name",level:3},{value:"FunctionDef add_file(self, sid, fileobj, policy_name)",id:"functiondef-add_fileself-sid-fileobj-policy_name",level:3},{value:"FunctionDef add_ini(self, sid, iniobj, policy_name)",id:"functiondef-add_iniself-sid-iniobj-policy_name",level:3},{value:"FunctionDef _filter_sid_list(self, row_object, sid)",id:"functiondef-_filter_sid_listself-row_object-sid",level:3},{value:"FunctionDef get_shortcuts(self, sid)",id:"functiondef-get_shortcutsself-sid",level:3},{value:"FunctionDef get_printers(self, sid)",id:"functiondef-get_printersself-sid",level:3},{value:"FunctionDef get_drives(self, sid)",id:"functiondef-get_drivesself-sid",level:3},{value:"FunctionDef get_folders(self, sid)",id:"functiondef-get_foldersself-sid",level:3},{value:"FunctionDef get_envvars(self, sid)",id:"functiondef-get_envvarsself-sid",level:3},{value:"FunctionDef _filter_scripts_list(self, row_object, sid, action)",id:"functiondef-_filter_scripts_listself-row_object-sid-action",level:3},{value:"FunctionDef get_scripts(self, sid, action)",id:"functiondef-get_scriptsself-sid-action",level:3},{value:"FunctionDef get_files(self, sid)",id:"functiondef-get_filesself-sid",level:3},{value:"FunctionDef get_networkshare(self, sid)",id:"functiondef-get_networkshareself-sid",level:3},{value:"FunctionDef get_ini(self, sid)",id:"functiondef-get_iniself-sid",level:3},{value:"FunctionDef get_hkcu_entry(self, sid, hive_key)",id:"functiondef-get_hkcu_entryself-sid-hive_key",level:3},{value:"FunctionDef filter_hkcu_entries(self, sid, startswith)",id:"functiondef-filter_hkcu_entriesself-sid-startswith",level:3},{value:"FunctionDef get_info(self, name)",id:"functiondef-get_infoself-name",level:3},{value:"FunctionDef get_hklm_entry(self, hive_key)",id:"functiondef-get_hklm_entryself-hive_key",level:3},{value:"FunctionDef filter_hklm_entries(self, startswith)",id:"functiondef-filter_hklm_entriesself-startswith",level:3},{value:"FunctionDef wipe_user(self, sid)",id:"functiondef-wipe_userself-sid",level:3},{value:"FunctionDef _wipe_sid(self, row_object, sid)",id:"functiondef-_wipe_sidself-row_object-sid",level:3},{value:"FunctionDef wipe_hklm(self)",id:"functiondef-wipe_hklmself",level:3}];function h(e){const t={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"classdef-sqlite_registry",children:"ClassDef sqlite_registry"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"sqlite_registry"}),": The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class is a concrete implementation of the abstract base class ",(0,n.jsx)(t.code,{children:"registry"})," that stores and manages registry data in a SQLite database. It provides additional functionality specific to SQLite databases, such as support for SQLite-specific database features and SQLite-specific querying and retrieval methods."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"attributes"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"db_name"}),": A string representing the name of the SQLite database file.\n\xb7 ",(0,n.jsx)(t.code,{children:"db_path"}),": A string representing the file path of the SQLite database file.\n\xb7 ",(0,n.jsx)(t.code,{children:"db_cnt"}),": A SQLAlchemy ",(0,n.jsx)(t.code,{children:"create_engine"})," object used to connect to the SQLite database.\n\xb7 ",(0,n.jsx)(t.code,{children:"db_session"}),": A SQLAlchemy ",(0,n.jsx)(t.code,{children:"sessionmaker"})," object used to manage database transactions.\n\xb7 ",(0,n.jsx)(t.code,{children:"__compat"}),": A ",(0,n.jsx)(t.code,{children:"sqlite_registry_compat"})," object used to provide compatibility between the ",(0,n.jsx)(t.code,{children:"registry"})," class and the SQLite database.\n\xb7 ",(0,n.jsx)(t.code,{children:"__metadata"}),": A SQLAlchemy ",(0,n.jsx)(t.code,{children:"MetaData"})," object used to define the structure of the SQLite database tables.\n\xb7 ",(0,n.jsx)(t.code,{children:"__info"}),", ",(0,n.jsx)(t.code,{children:"__hklm"}),", ",(0,n.jsx)(t.code,{children:"__hkcu"}),", ",(0,n.jsx)(t.code,{children:"__shortcuts"}),", ",(0,n.jsx)(t.code,{children:"__printers"}),", ",(0,n.jsx)(t.code,{children:"__drives"}),", ",(0,n.jsx)(t.code,{children:"__folders"}),", ",(0,n.jsx)(t.code,{children:"__envvars"}),", ",(0,n.jsx)(t.code,{children:"__scripts"}),", ",(0,n.jsx)(t.code,{children:"__files"}),", ",(0,n.jsx)(t.code,{children:"__ini"}),", ",(0,n.jsx)(t.code,{children:"__networkshare"}),": SQLAlchemy ",(0,n.jsx)(t.code,{children:"Table"})," objects representing the various tables in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class is a concrete implementation of the ",(0,n.jsx)(t.code,{children:"registry"})," abstract base class that provides additional functionality specific to SQLite databases. It initializes the database connection and sets up the necessary tables and mappers for storing registry data. The class also provides methods for adding, updating, and deleting registry entries, as well as for querying and retrieving entries based on a specific SID (Security Identifier)."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class uses the SQLAlchemy library for database access and provides a convenient and flexible interface for working with registry data in a SQLite database. The class uses SQLAlchemy's ORM (Object Relational Mapper) functionality to map Python objects to database tables and provides a simple and intuitive interface for working with registry data."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class also provides a number of methods for querying and retrieving registry data based on a specific SID. These methods allow for easy filtering and retrieval of registry data based on the SID of the user or machine associated with the data."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class is used throughout the project to store and manage registry data in a SQLite database. It is typically instantiated using the ",(0,n.jsx)(t.code,{children:"registry_factory"})," function in the ",(0,n.jsx)(t.code,{children:"registry_factory"})," module, which provides a convenient way to create and manage ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class is a concrete implementation of the ",(0,n.jsx)(t.code,{children:"registry"})," abstract base class and provides additional functionality specific to SQLite databases."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class uses the SQLAlchemy library for database access and requires a working installation of SQLAlchemy to function properly."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class"]}),"\n"]}),"\n",(0,n.jsxs)(t.h3,{id:"functiondef-initself-db_name-registry_cache_dir",children:["FunctionDef ",(0,n.jsx)(t.strong,{children:"init"}),"(self, db_name, registry_cache_dir)"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"class gpoa.storage.record_types.ini_entry"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.strong,{children:"init"})}),": The function of ",(0,n.jsx)(t.strong,{children:"init"})," is to initialize the ini_entry object with the given SID, iniobj, and policy_name."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 sid: The security identifier (SID) of the user or group.\n\xb7 iniobj: An instance of the iniobj class, which contains information about the INI file entries.\n\xb7 policy_name: The name of the policy."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ini_entry class is used to represent INI file entries in the form of an object mapping. The ",(0,n.jsx)(t.strong,{children:"init"})," method initializes the object with the given SID, iniobj, and policy_name. It assigns the corresponding attributes with the values from the iniobj."]}),"\n",(0,n.jsx)(t.p,{children:"The ini_entry class is used in the sqlite_registry class to handle INI file entries in a SQLite registry. The add_ini method in sqlite_registry takes an sid, an iniobj, and a policy_name as input, creates an instance of the ini_entry class with these parameters, and then adds it to the database. If adding the ini_entry instance raises an exception, the add_ini method filters the existing ini_entry instances with the same sid and path, and updates them with the new ini_entry instance's fields."}),"\n",(0,n.jsx)(t.p,{children:"The get_ini method in sqlite_registry takes a sid as input and returns a list of ini_entry instances associated with that sid."}),"\n",(0,n.jsx)(t.p,{children:"The wipe_user method in sqlite_registry takes a sid as input and deletes all ini_entry instances associated with that sid from the database."}),"\n",(0,n.jsx)(t.p,{children:"**Note"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_addself-row",children:"FunctionDef _add(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"_add"}),": The function of ",(0,n.jsx)(t.code,{children:"_add"})," is to add a given row to the database session and commit the transaction."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": The object to be added to the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_add"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"db_session.add(row)"})," method. If the addition is successful, the database session is committed using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),". If an exception occurs during the execution, the function catches it, rolls back the database session to undo any changes made in the current transaction using ",(0,n.jsx)(t.code,{children:"db_session.rollback()"}),", and re-raises the exception to be handled by the caller."]}),"\n",(0,n.jsx)(t.p,{children:"This function serves as a helper method for other functions in the project that need to add new records to the database. By handling exceptions and rolling back the database session, it ensures data consistency and atomicity of the database operations."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of a database model class, as it will be directly added to the database session."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_info_upsertself-row",children:"FunctionDef _info_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_info_upsert"})}),": The function of ",(0,n.jsx)(t.code,{children:"_info_upsert"})," is to add a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object to the SQLite database or update an existing one with the same name."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": The ",(0,n.jsx)(t.code,{children:"info_entry"})," object to be added or updated in the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_info_upsert"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If adding the object raises an exception (e.g., due to a unique constraint violation), the function catches the exception and proceeds to update the existing object with the same name instead."]}),"\n",(0,n.jsxs)(t.p,{children:["To update the existing object, the function queries the database for the object with the same name as the provided ",(0,n.jsx)(t.code,{children:"row"})," object using the ",(0,n.jsx)(t.code,{children:"db_session.query(info_entry).filter(info_entry.name == row.name)"})," method. It then updates the object's fields using the ",(0,n.jsx)(t.code,{children:"update"})," method and the dictionary returned by the ",(0,n.jsx)(t.code,{children:"row.update_fields()"})," method. Finally, the function commits the transaction using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["This function serves as a helper method for the ",(0,n.jsx)(t.code,{children:"set_info"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is responsible for inserting or updating global policy settings for a system. By handling exceptions and rolling back the database session, it ensures data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.p,{children:["From a functional perspective, the ",(0,n.jsx)(t.code,{children:"_info_upsert"})," function plays a crucial role in the ",(0,n.jsx)(t.code,{children:"set_info"})," method. When a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object is created, it is first attempted to be inserted into the database using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If the insertion fails, the ",(0,n.jsx)(t.code,{children:"_info_upsert"})," function is called to update the existing object with the same name."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["When creating a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object, make sure the name is unique among all other ",(0,n.jsx)(t.code,{children:"info_entry"})," objects in the database. Otherwise, an exception will be raised."]}),"\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"info_entry"})," class, as it will be directly added to the database session or used to update an existing object."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Related Objects"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"gpoa/storage/sqlite_registry.py/sqlite_registry/_add"}),": This function is responsible for adding a given row to the database session and committing the transaction."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"gpoa/storage/record_types.py/info_entry"}),": This class represents a piece of information with a name and a value, and is used to store global policy settings for a system in a SQLite database."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"gpoa/storage/sqlite_registry.py/sqlite_registry/set_info"}),": This function is responsible for setting the value of a global policy setting in the SQLite database. It creates a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object and calls the ",(0,n.jsx)(t.code,{children:"_info_upsert"})," function to insert or update the object in the database."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_hklm_upsertself-row",children:"FunctionDef _hklm_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_hklm_upsert"})}),": The function of ",(0,n.jsx)(t.code,{children:"_hklm_upsert"})," is to add a given row to the database session and commit the transaction, or update the existing row if a unique constraint violation occurs during the addition."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": The object to be added or updated in the database. This object is an instance of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," class, which represents an entry in the HKLM (HKEY_LOCAL_MACHINE) registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_hklm_upsert"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If the addition is successful, the database session is committed using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["If a unique constraint violation occurs during the addition, it means that a row with the same ",(0,n.jsx)(t.code,{children:"hive_key"})," value already exists in the database. In this case, the function catches the exception, queries the existing row with the same ",(0,n.jsx)(t.code,{children:"hive_key"})," value, and updates it with the new values from the ",(0,n.jsx)(t.code,{children:"row"})," object using the ",(0,n.jsx)(t.code,{children:"update"})," method. The database session is then committed using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["This function serves as a helper method for the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which needs to add new entries to the HKLM table in the SQLite database or update existing entries if a unique constraint violation occurs. By handling exceptions and rolling back the database session, it ensures data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,n.jsx)(t.code,{children:"_hklm_upsert"})," method is called by the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class. The ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method takes two parameters, ",(0,n.jsx)(t.code,{children:"preg_entry"})," and ",(0,n.jsx)(t.code,{children:"policy_name"}),", and creates a ",(0,n.jsx)(t.code,{children:"samba_preg"})," object with these parameters. It then calls the ",(0,n.jsx)(t.code,{children:"_hklm_upsert"})," method with the created ",(0,n.jsx)(t.code,{children:"samba_preg"})," object to add or update the entry in the HKLM table."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," class, as it will be directly added or updated in the database."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_hklm_upsert"})," function assumes that the ",(0,n.jsx)(t.code,{children:"hive_key"})," attribute of the ",(0,n.jsx)(t.code,{children:"row"})," object is unique in the database. If this assumption is violated, the function may update the wrong row or fail to update any row. Make sure to enforce the uniqueness of the ",(0,n.jsx)(t.code,{children:"hive_key"})," attribute in the database schema or in the application logic."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_hkcu_upsertself-row",children:"FunctionDef _hkcu_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_hkcu_upsert"})}),": The function of ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," is to update or insert a given HKCU (HKEY_CURRENT_USER) registry entry in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": An instance of the ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," class representing the HKCU registry entry to be updated or inserted."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If adding the row raises an exception (which could occur if the row's SID or hive_key already exists in the database), the function will catch the exception and proceed to update the existing row in the database with the new values from ",(0,n.jsx)(t.code,{children:"row.update_fields()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"row.update_fields()"})," method returns a dictionary containing the ",(0,n.jsx)(t.code,{children:"policy_name"}),", ",(0,n.jsx)(t.code,{children:"type"}),", and ",(0,n.jsx)(t.code,{children:"data"})," attributes of the ",(0,n.jsx)(t.code,{children:"row"})," object. This dictionary is used to update the existing row in the database. After updating the row, the database session is committed using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"This function is designed to handle situations where a new HKCU registry entry needs to be inserted into the database or an existing entry needs to be updated with new values. By handling exceptions and updating existing entries, it ensures data consistency and atomicity of the database operations."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," function is primarily called by the ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is responsible for writing PReg entries to the HKCU registry. When a new PReg entry is added, the ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function creates a ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," object representing the entry and passes it to ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," for insertion or update in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," class, as it will be directly added to the database session or used to update an existing row."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," function assumes that the ",(0,n.jsx)(t.code,{children:"row"})," object has the necessary attributes (",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"hive_key"}),", and ",(0,n.jsx)(t.code,{children:"update_fields()"})," method) to perform the insert or update operation. Make sure that the ",(0,n.jsx)(t.code,{children:"row"})," object meets these requirements before calling this function."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_shortcut_upsertself-row",children:"FunctionDef _shortcut_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_shortcut_upsert"})}),": The function of ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," is to add a shortcut entry to the database or update an existing entry if a unique constraint violation occurs."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": An instance of the ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class, which contains the shortcut information to be added or updated."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database using the ",(0,n.jsx)(t.code,{children:"_add"})," method (line 2). If a unique constraint violation occurs, the function catches the exception and proceeds to update the existing record in the database (lines 4-7). The ",(0,n.jsx)(t.code,{children:"update_fields"})," method of the ",(0,n.jsx)(t.code,{children:"row"})," object is called to create a dictionary containing the policy_name, path, and shortcut attributes, which are then used to update the existing record. The database session is then committed (line 7)."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_shortcut"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class (line 4 in the ",(0,n.jsx)(t.code,{children:"add_shortcut"})," code). The ",(0,n.jsx)(t.code,{children:"add_shortcut"})," method takes three parameters: ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"sc_obj"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"}),". It creates an instance of the ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class with these parameters and calls the ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," method to add or update the shortcut entry in the database."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function plays a crucial role in ensuring data consistency and atomicity of the database operations. By handling exceptions and rolling back the database session, it ensures that the database remains in a consistent state even in the event of a unique constraint violation."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class, as it will be directly added to the database session."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function assumes that the ",(0,n.jsx)(t.code,{children:"db_session"})," attribute has been properly initialized and configured in the caller function. Make sure to properly initialize and configure the ",(0,n.jsx)(t.code,{children:"db_session"})," attribute before calling this function."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function relies on the ",(0,n.jsx)(t.code,{children:"_add"})," method to add new records to the database. Make sure to properly handle exceptions and rollbacks in the ",(0,n.jsx)(t.code,{children:"_add"})," method to ensure data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function relies on the ",(0,n.jsx)(t.code,{children:"update_fields"})," method of the ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class to create a dictionary containing the policy_name, path, and shortcut attributes. Make sure that the ",(0,n.jsx)(t.code,{children:"update_fields"})," method is properly implemented and returns the expected dictionary."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nHere is an example of how the ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function is used in the ",(0,n.jsx)(t.code,{children:"add_shortcut"})," method:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"sid = '12345678-1234-1234-1234-1234567890ab'\nsc_obj = Shortcut('C:\\\\Users\\\\User\\\\Desktop\\\\shortcut.lnk')\npolicy_name = 'My Policy'\n\nregistry = sqlite_registry('my_registry')\nregistry.add_shortcut(sid, sc_obj, policy_name)\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"add_shortcut"})," method is used to store shortcut information in the database using the ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function. The ",(0,n.jsx)(t.code,{children:"sid"})," parameter is a unique identifier for the shortcut's owner, ",(0,n.jsx)(t.code,{children:"sc_obj"})," is an object of the ",(0,n.jsx)(t.code,{children:"Shortcut"})," class representing the shortcut, and ",(0,n.jsx)(t.code,{children:"policy_name"})," is the name of the policy associated with the shortcut. If a unique constraint violation occurs, the ",(0,n.jsx)(t.code,{children:"_shortcut_upsert"})," function will update the existing record in the database with the new policy_name, path, and shortcut attributes."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_printer_upsertself-row",children:"FunctionDef _printer_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"_printer_upsert"}),": The function of ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," is to add a new printer entry or update an existing one in the SQLite database. It first attempts to add the provided ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"_add"})," function. If an exception occurs during this operation, it filters the existing printer entries based on the SID and name, and updates them with the new fields."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": The ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to be added or updated in the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function begins by calling the ",(0,n.jsx)(t.code,{children:"_add"})," function to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session and commit the transaction. If an exception occurs during this operation, it proceeds to filter the existing printer entries based on the SID and name using the ",(0,n.jsx)(t.code,{children:"db_session.query(printer_entry).filter()"})," method. It then updates the filtered entries with the new fields using the ",(0,n.jsx)(t.code,{children:"update()"})," method and commits the transaction using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["This function serves as a helper method for the ",(0,n.jsx)(t.code,{children:"add_printer"})," function in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to either add a new printer entry or update an existing one in the database. By handling exceptions and rolling back the database session, it ensures data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"printer_entry"})," class, as it will be directly added to the database session."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["This function assumes that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object has been properly initialized and contains valid values. It does not perform any error checking or exception handling."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_add"})," function is called to add the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to the database session. If an exception occurs during this operation, the existing printer entries with the same SID and name are filtered and updated with the new fields."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"db_session.query(printer_entry).filter()"})," method is used to filter the existing printer entries based on the SID and name."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"update()"})," method is used to update the filtered printer entries with the new fields."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"db_session.commit()"})," method is used to commit the transaction and save the changes to the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relation with other functions"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_printer"})," function in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to either add a new printer entry or update an existing one in the database."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function calls the ",(0,n.jsx)(t.code,{children:"_add"})," function to add the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to the database session."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function assumes that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object has been properly initialized and contains valid values. It does not perform any error checking or exception handling."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function handles exceptions and rolls back the database session to ensure data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function is used to maintain data consistency and atomicity of the database operations in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_drive_upsertself-row",children:"FunctionDef _drive_upsert(self, row)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_drive_upsert"})}),": The function of ",(0,n.jsx)(t.code,{children:"_drive_upsert"})," is to add a new drive entry or update an existing one in the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row"}),": An instance of the ",(0,n.jsx)(t.code,{children:"drive_entry"})," class, which contains the drive entry details such as SID, policy name, login, password, and other relevant attributes."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_drive_upsert"})," function begins by attempting to add the provided ",(0,n.jsx)(t.code,{children:"row"})," object to the database session using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If adding the row raises an exception (which could occur due to a unique constraint violation, for example), the function catches the exception and proceeds to update the existing record in the database with the new values of the object's attributes."]}),"\n",(0,n.jsxs)(t.p,{children:["The update process involves querying the database for the record with the same SID and dir attributes as the ",(0,n.jsx)(t.code,{children:"row"})," object, and then updating that record with the new values returned by the ",(0,n.jsx)(t.code,{children:"update_fields"})," method of the ",(0,n.jsx)(t.code,{children:"row"})," object. The ",(0,n.jsx)(t.code,{children:"update_fields"})," method creates a dictionary of the object's attributes, which are then used to update the existing record."]}),"\n",(0,n.jsxs)(t.p,{children:["After updating the record, the function commits the database session using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["This function is called by the ",(0,n.jsx)(t.code,{children:"add_drive"})," method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which creates a new ",(0,n.jsx)(t.code,{children:"drive_entry"})," object and inserts or updates it in the database using the ",(0,n.jsx)(t.code,{children:"_drive_upsert"})," method."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_drive_upsert"})," function assumes that the ",(0,n.jsx)(t.code,{children:"row"})," object has the necessary attributes, and if any attribute is missing, it will result in an error."]}),"\n",(0,n.jsx)(t.li,{children:"The function directly interacts with the database, so be cautious when using it and make sure to handle exceptions and rollbacks appropriately in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"drive_entry"})," class, as it will be directly added to the database session or used to update an existing record."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-set_infoself-name-value",children:"FunctionDef set_info(self, name, value)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"set_info"}),": The function of ",(0,n.jsx)(t.code,{children:"set_info"})," is to add a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object to the SQLite database or update an existing one with the same name in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"name"}),": A string that represents the name of the ",(0,n.jsx)(t.code,{children:"info_entry"})," object.\n\xb7 ",(0,n.jsx)(t.code,{children:"value"}),": An arbitrary Python object that represents the value of the ",(0,n.jsx)(t.code,{children:"info_entry"})," object."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"set_info"})," function begins by creating a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object with the given ",(0,n.jsx)(t.code,{children:"name"})," and ",(0,n.jsx)(t.code,{children:"value"})," parameters. It then logs the new ",(0,n.jsx)(t.code,{children:"info_entry"})," object's name and value using the ",(0,n.jsx)(t.code,{children:"log"})," function from the ",(0,n.jsx)(t.code,{children:"gpoa/util/logging.py"})," module."]}),"\n",(0,n.jsxs)(t.p,{children:["After logging the new ",(0,n.jsx)(t.code,{children:"info_entry"})," object, the function calls the ",(0,n.jsx)(t.code,{children:"_info_upsert"})," method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object to add or update the new ",(0,n.jsx)(t.code,{children:"info_entry"})," object in the SQLite database. The ",(0,n.jsx)(t.code,{children:"_info_upsert"})," method takes care of handling any exceptions that may arise due to unique constraint violations and updates the existing object with the same name instead."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"set_info"})," function is called in the ",(0,n.jsx)(t.code,{children:"__init__"})," methods of the ",(0,n.jsx)(t.code,{children:"nodomain_backend"})," and ",(0,n.jsx)(t.code,{children:"samba_backend"})," classes in the ",(0,n.jsx)(t.code,{children:"gpoa/backend"})," module. These classes use the ",(0,n.jsx)(t.code,{children:"set_info"})," function to set the initial values of the ",(0,n.jsx)(t.code,{children:"domain"}),", ",(0,n.jsx)(t.code,{children:"machine_name"}),", ",(0,n.jsx)(t.code,{children:"machine_sid"}),", ",(0,n.jsx)(t.code,{children:"username"}),", and ",(0,n.jsx)(t.code,{children:"sid"})," attributes of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object."]}),"\n",(0,n.jsxs)(t.p,{children:["By handling exceptions and rolling back the database session, the ",(0,n.jsx)(t.code,{children:"_info_upsert"})," method ensures data consistency and atomicity of the database operations. Therefore, the ",(0,n.jsx)(t.code,{children:"set_info"})," function plays a crucial role in setting the initial values of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object's attributes."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Related Objects"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"gpoa/util/logging.py/log"}),": This function is responsible for logging messages with different levels (e.g., debug, info, warning, error, fatal) and data dictionaries.\n\xb7 ",(0,n.jsx)(t.code,{children:"gpoa/storage/sqlite_registry.py/sqlite_registry/_info_upsert"}),": This function is responsible for adding a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object to the database session or updating an existing one with the same name.\n\xb7 ",(0,n.jsx)(t.code,{children:"gpoa/storage/record_types.py/info_entry"}),": This class represents a piece of information with a name and a value, and is used to store global policy settings for a system in a SQLite database.\n\xb7 ",(0,n.jsx)(t.code,{children:"gpoa/backend/nodomain_backend.py/nodomain_backend/__init__"}),": This function is responsible for initializing the ",(0,n.jsx)(t.code,{children:"nodomain_backend"})," object with the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object and setting its initial values.\n\xb7 ",(0,n.jsx)(t.code,{children:"gpoa/backend/samba_backend.py/samba_backend/__init__"}),": This function is responsible for initializing the ",(0,n.jsx)(t.code,{children:"samba_backend"})," object with the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," object and setting its initial values."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["When creating a new ",(0,n.jsx)(t.code,{children:"info_entry"})," object, make sure the name is unique among all other ",(0,n.jsx)(t.code,{children:"info_entry"})," objects in the database. Otherwise, an exception will be raised."]}),"\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"name"})," and ",(0,n.jsx)(t.code,{children:"value"})," parameters provided to this function are valid and appropriate for the ",(0,n.jsx)(t.code,{children:"info_entry"})," object being created or updated."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"set_info"})," function is called in the ",(0,n.jsx)(t.code,{children:"__init__"})," methods of the ",(0,n.jsx)(t.code,{children:"nodomain_backend"})," and ",(0,n.jsx)(t.code,{children:"samba_backend"})," classes. Therefore, any exceptions raised during the execution of the ",(0,n.jsx)(t.code,{children:"set_info"})," function will be propagated to these classes' ",(0,n.jsx)(t.code,{children:"__init__"})," methods."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_delete_hklm_keynameself-keyname",children:"FunctionDef _delete_hklm_keyname(self, keyname)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})}),": The function of ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," is to delete a registry key from the HKEY_LOCAL_MACHINE (HKLM) hive using the provided ",(0,n.jsx)(t.code,{children:"keyname"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),"\n\xb7 ",(0,n.jsx)(t.code,{children:"keyname"}),": A string that holds the name of the registry key to be deleted from the HKLM hive."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),"\nThe ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is responsible for performing CRUD (Create, Read, Update, Delete) operations on the HKLM table in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:["The function takes one parameter, ",(0,n.jsx)(t.code,{children:"keyname"}),", which is a string representing the name of the registry key to be deleted. It first creates a dictionary ",(0,n.jsx)(t.code,{children:"logdata"})," with the ",(0,n.jsx)(t.code,{children:"keyname"})," as a key and an empty string as its value. This dictionary is used to log the operation details."]}),"\n",(0,n.jsxs)(t.p,{children:["The function then begins a transaction by calling the ",(0,n.jsx)(t.code,{children:"db_session.query"})," method on the ",(0,n.jsx)(t.code,{children:"samba_preg"})," class and filtering the query results based on the ",(0,n.jsx)(t.code,{children:"keyname"})," parameter. The ",(0,n.jsx)(t.code,{children:"delete"})," method is called on the query results, and the ",(0,n.jsx)(t.code,{children:"synchronize_session"})," parameter is set to ",(0,n.jsx)(t.code,{children:"False"})," to avoid synchronizing the session with the database."]}),"\n",(0,n.jsxs)(t.p,{children:["After the deletion, the ",(0,n.jsx)(t.code,{children:"db_session.commit"})," method is called to commit the transaction to the database. The ",(0,n.jsx)(t.code,{children:"log"})," function is then called with the ",(0,n.jsx)(t.code,{children:"D65"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the successful deletion of the registry key."]}),"\n",(0,n.jsxs)(t.p,{children:["If an exception occurs during the execution of the function, the ",(0,n.jsx)(t.code,{children:"log"})," function is called with the ",(0,n.jsx)(t.code,{children:"D63"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the failure of the deletion operation."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),"\nThe ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class. The ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method takes two parameters, ",(0,n.jsx)(t.code,{children:"preg_entry"})," and ",(0,n.jsx)(t.code,{children:"policy_name"}),". The ",(0,n.jsx)(t.code,{children:"preg_entry"})," parameter is an object that contains the properties of a registry key, and the ",(0,n.jsx)(t.code,{children:"policy_name"})," parameter is a string that holds the name of the policy associated with the registry key."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method calls the ",(0,n.jsx)(t.code,{children:"samba_preg"})," class constructor to create a ",(0,n.jsx)(t.code,{children:"samba_preg"})," object from the ",(0,n.jsx)(t.code,{children:"preg_entry"})," parameter. It then checks if the ",(0,n.jsx)(t.code,{children:"valuename"})," attribute of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," object starts with ",(0,n.jsx)(t.code,{children:"**"}),". If it does, the ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," function is called with the ",(0,n.jsx)(t.code,{children:"keyname"})," attribute of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," object as the parameter."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),"\nThe ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," function is an internal method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and should not be used outside of it. It is recommended to use the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method to add or delete registry keys from the HKLM hive."]}),"\n",(0,n.jsxs)(t.p,{children:["Here's an example of how to use the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method to delete a registry key:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"registry = sqlite_registry('my_database')\nregistry.add_hklm_entry({'keyname': 'Software', 'valuename': 'Microsoft'}, 'MyPolicy')\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"add_hklm_entry"})," method is called with the ",(0,n.jsx)(t.code,{children:"preg_entry"})," parameter set to ",(0,n.jsx)(t.code,{children:"{'keyname': 'Software', 'valuename': 'Microsoft'}"})," and the ",(0,n.jsx)(t.code,{children:"policy_name"})," parameter set to ",(0,n.jsx)(t.code,{children:"'MyPolicy'"}),". The ",(0,n.jsx)(t.code,{children:"valuename"})," attribute of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," object created from the ",(0,n.jsx)(t.code,{children:"preg_entry"})," parameter starts with ",(0,n.jsx)(t.code,{children:"**"}),", so the ",(0,n.jsx)(t.code,{children:"_delete_hklm_keyname"})," function is called with the ",(0,n.jsx)(t.code,{children:"keyname"})," attribute of the ",(0,n.jsx)(t.code,{children:"samba_preg"})," object as the parameter. The registry key with the name ",(0,n.jsx)(t.code,{children:"Software"})," is then deleted from the HKLM hive."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_hklm_entryself-preg_entry-policy_name",children:"FunctionDef add_hklm_entry(self, preg_entry, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_hklm_entry"}),": The function of add_hklm_entry is to write a PReg entry to the HKEY_LOCAL_MACHINE registry hive. It takes two parameters: preg_entry and policy_name. The preg_entry parameter is an instance of the samba_preg class, which represents an entry in the HKLM registry. The policy_name parameter is a string that holds the name of the policy associated with the registry key."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),"\n\xb7 preg_entry: An instance of the samba_preg class representing an entry in the HKLM registry.\n\xb7 policy_name: A string that holds the name of the policy associated with the registry key."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),"\nThe add_hklm_entry function first creates a samba_preg object called pentry from the preg_entry parameter. It then checks if the valuename attribute of the pentry object starts with '**'. If it does, the function calls the _delete_hklm_keyname method with the keyname attribute of the pentry object as the parameter. This is done to delete the registry key associated with the pentry object."]}),"\n",(0,n.jsx)(t.p,{children:"If the valuename attribute of the pentry object does not start with '**', the function calls the _hklm_upsert method with the pentry object as the parameter. This method adds or updates the entry in the HKLM table of the SQLite database. If a unique constraint violation occurs during the addition, the function catches the exception, queries the existing row with the same hive_key value, and updates it with the new values from the pentry object. The database session is then committed using db_session.commit()."}),"\n",(0,n.jsx)(t.p,{children:"The add_hklm_entry function serves as a helper method for the merge_polfile method in the preg module. The merge_polfile method takes a preg file and a registry storage object as parameters and adds the entries in the preg file to the registry storage object. The add_hklm_entry method is called with the entries in the preg file and the policy_name parameter to add or update the entries in the HKLM table of the SQLite database."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),"\nThe add_hklm_entry function is called by the merge_polfile method in the preg module. The merge_polfile method takes a preg file and a registry storage object as parameters and adds the entries in the preg file to the registry storage object. The add_hklm_entry method is called with the entries in the preg file and the policy_name parameter to add or update the entries in the HKLM table of the SQLite database."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Note"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The add_hklm_entry function directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsx)(t.li,{children:"Ensure that the pentry object provided to this function is a valid instance of the samba_preg class, as it will be directly added or updated in the database."}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsx)(t.li,{children:"The add_hklm_entry function assumes that the hive_key attribute of the pentry object is unique in the database. If this assumption is violated, the function may update the wrong row or fail to update any row. Make sure to enforce the uniqueness of the hive_key attribute in the database schema or in the application logic."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_delete_hkcu_keynameself-keyname-sid",children:"FunctionDef _delete_hkcu_keyname(self, keyname, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})}),": The function of ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," is to delete a specific key-value pair from the HKEY_CURRENT_USER registry hive based on the provided ",(0,n.jsx)(t.code,{children:"keyname"})," and ",(0,n.jsx)(t.code,{children:"sid"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"keyname"}),": A string representing the name of the registry key to be deleted.\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": A string representing the Security Identifier (SID) of the user associated with the HKCU entry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," function is defined within the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and takes two parameters: ",(0,n.jsx)(t.code,{children:"keyname"})," and ",(0,n.jsx)(t.code,{children:"sid"}),". It first initializes a ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary containing the ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"keyname"})," parameters. Then, it begins a try-except block to handle any exceptions that might occur during the execution of the function."]}),"\n",(0,n.jsxs)(t.p,{children:["Within the try block, the function performs a double filter query on the ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," table using the ",(0,n.jsx)(t.code,{children:"db_session"})," object to find the specific key-value pair to be deleted. The first filter is based on the ",(0,n.jsx)(t.code,{children:"sid"})," parameter, and the second filter is based on the ",(0,n.jsx)(t.code,{children:"keyname"})," parameter. The ",(0,n.jsx)(t.code,{children:"delete"})," method is then called on the resulting query object with ",(0,n.jsx)(t.code,{children:"synchronize_session=False"})," to delete the matching record from the database."]}),"\n",(0,n.jsxs)(t.p,{children:["After the deletion, the ",(0,n.jsx)(t.code,{children:"db_session"})," object is committed using the ",(0,n.jsx)(t.code,{children:"commit"})," method. The ",(0,n.jsx)(t.code,{children:"log"})," function is then called with the ",(0,n.jsx)(t.code,{children:"D66"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the successful deletion of the key-value pair."]}),"\n",(0,n.jsxs)(t.p,{children:["If any exception occurs during the execution of the try block, the except block is executed, and the ",(0,n.jsx)(t.code,{children:"log"})," function is called with the ",(0,n.jsx)(t.code,{children:"D64"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the failure of the deletion operation."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," function is primarily used in the ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to delete existing key-value pairs when adding new ones. It is also used in the ",(0,n.jsx)(t.code,{children:"wipe_user"})," function to delete all key-value pairs associated with a specific user."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nWhen using the ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," function, ensure that the ",(0,n.jsx)(t.code,{children:"keyname"})," and ",(0,n.jsx)(t.code,{children:"sid"})," parameters are correctly set according to the target key-value pair in the Windows registry. Additionally, note that the function will delete the specific key-value pair and all its sub-keys and values. Therefore, use this function with caution, especially when deleting keys associated with critical system functionalities."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_hkcu_entryself-preg_entry-sid-policy_name",children:"FunctionDef add_hkcu_entry(self, preg_entry, sid, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_hkcu_entry"}),": The function of add_hkcu_entry is to write a PReg entry to the HKEY_CURRENT_USER registry hive."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"preg_entry"}),": An instance of the ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," class representing the PReg entry to be written.\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": A string representing the Security Identifier (SID) of the user associated with the HKCU entry.\n\xb7 ",(0,n.jsx)(t.code,{children:"policy_name"}),": A string specifying the name of the policy applied to the HKCU entry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function begins by creating a ",(0,n.jsx)(t.code,{children:"samba_hkcu_preg"})," object, ",(0,n.jsx)(t.code,{children:"hkcu_pentry"}),", using the provided ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"preg_entry"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"})," parameters. This object represents the PReg entry to be written to the HKCU registry hive."]}),"\n",(0,n.jsxs)(t.p,{children:["Next, a ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary is initialized with the ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"policy_name"}),", and ",(0,n.jsx)(t.code,{children:"hkcu_pentry.hive_key"})," as keys and their respective values. This dictionary is used to log the entry addition operation using the ",(0,n.jsx)(t.code,{children:"log"})," function."]}),"\n",(0,n.jsxs)(t.p,{children:["The function then checks if the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.valuename"})," starts with ",(0,n.jsx)(t.code,{children:"'**'"}),". If it does, the function performs different actions based on the value of ",(0,n.jsx)(t.code,{children:"hkcu_pentry.valuename"}),". If the value is ",(0,n.jsx)(t.code,{children:"'**delvals.'"}),", the ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," function is called with the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.keyname"})," and ",(0,n.jsx)(t.code,{children:"sid"})," parameters to delete the existing key-value pair. Otherwise, the ",(0,n.jsx)(t.code,{children:"log"})," function is called with the ",(0,n.jsx)(t.code,{children:"D51"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the failure of the entry addition operation."]}),"\n",(0,n.jsxs)(t.p,{children:["If the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.valuename"})," does not start with ",(0,n.jsx)(t.code,{children:"'**'"}),", the function checks if the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.valuename"})," starts with ",(0,n.jsx)(t.code,{children:"'**delvals.'"}),". If it does, the ",(0,n.jsx)(t.code,{children:"_delete_hkcu_keyname"})," function is called with the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.keyname"})," and ",(0,n.jsx)(t.code,{children:"sid"})," parameters to delete the existing key-value pair. Otherwise, the ",(0,n.jsx)(t.code,{children:"log"})," function is called with the ",(0,n.jsx)(t.code,{children:"D26"})," message code and the ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary as parameters to log the successful addition of the entry. After logging, the ",(0,n.jsx)(t.code,{children:"_hkcu_upsert"})," function is called with the ",(0,n.jsx)(t.code,{children:"hkcu_pentry"})," object to update or insert the HKCU registry entry in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function is primarily called by the ",(0,n.jsx)(t.code,{children:"merge_polfile"})," function in the ",(0,n.jsx)(t.code,{children:"preg"})," module. The ",(0,n.jsx)(t.code,{children:"merge_polfile"})," function reads a PReg file and calls ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," for each entry in the file to write the entries to the HKCU registry hive."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nWhen using the ",(0,n.jsx)(t.code,{children:"add_hkcu_entry"})," function, ensure that the ",(0,n.jsx)(t.code,{children:"preg_entry"}),", ",(0,n.jsx)(t.code,{children:"sid"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"})," parameters are correctly set according to the target HKCU entry in the Windows registry. Additionally, note that the function will delete the specific key-value pair and all its sub-keys and values if the ",(0,n.jsx)(t.code,{children:"hkcu_pentry.valuename"})," starts with ",(0,n.jsx)(t.code,{children:"'**'"})," and has a value of ",(0,n.jsx)(t.code,{children:"'**delvals.'"}),". Therefore, use this function with caution, especially when deleting keys associated with critical system functionalities."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_shortcutself-sid-sc_obj-policy_name",children:"FunctionDef add_shortcut(self, sid, sc_obj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_shortcut"}),": The function of add_shortcut is to store shortcut information in the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function are:\n\xb7 sid: A unique identifier for the shortcut's owner.\n\xb7 sc_obj: An object of the Shortcut class representing the shortcut.\n\xb7 policy_name: The name of the policy associated with the shortcut."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe add_shortcut function begins by creating an instance of the ad_shortcut class, passing in the sid, sc_obj, and policy_name parameters (line 2). The ad_shortcut class is a mapping representation of a Windows shortcut object, which has four attributes: sid, policy_name, path, and shortcut."]}),"\n",(0,n.jsx)(t.p,{children:"The function then creates a dictionary called logdata, which contains the link and sid attributes (line 3). The link attribute is set to the path attribute of the ad_shortcut instance, and the sid attribute is set to the sid attribute of the ad_shortcut instance."}),"\n",(0,n.jsx)(t.p,{children:"The function then calls the log() function, passing in the message code 'D41' and the logdata dictionary (line 4). The log() function logs the message code and data to the log file."}),"\n",(0,n.jsx)(t.p,{children:"Finally, the function calls the _shortcut_upsert() method of the sqlite_registry instance, passing in the ad_shortcut instance (line 5). The _shortcut_upsert() method adds the ad_shortcut instance to the database or updates an existing entry if a unique constraint violation occurs."}),"\n",(0,n.jsx)(t.p,{children:"The add_shortcut function is called by the add_shortcut() method in the sqlite_registry class (line 4 in the sqlite_registry code). The add_shortcut() method takes three parameters: sid, sc_obj, and policy_name. It creates an instance of the ad_shortcut class with these parameters and calls the add_shortcut() method to add or update the shortcut entry in the database."}),"\n",(0,n.jsx)(t.p,{children:"The add_shortcut function plays a crucial role in ensuring data consistency and atomicity of the database operations. By handling exceptions and rolling back the database session, it ensures that the database remains in a consistent state even in the event of a unique constraint violation."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsx)(t.li,{children:"Ensure that the ad_shortcut instance provided to this function is a valid instance of the ad_shortcut class, as it will be directly added to the database session."}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsx)(t.li,{children:"The add_shortcut function assumes that the db_session attribute has been properly initialized and configured in the caller function. Make sure to properly initialize and configure the db_session attribute before calling this function."}),"\n",(0,n.jsx)(t.li,{children:"The add_shortcut function relies on the _shortcut_upsert() method to add new records to the database. Make sure to properly handle exceptions and rollbacks in the _shortcut_upsert() method to ensure data consistency and atomicity of the database operations."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nHere is an example of how the add_shortcut function is used in the sqlite_registry module:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"sid = '12345678-1234-1234-1234-1234567890ab'\nsc_obj = Shortcut('C:\\\\Users\\\\User\\\\Desktop\\\\shortcut.lnk')\npolicy_name = 'My Policy'\n\nregistry = sqlite_registry('my_registry')\nregistry.add_shortcut(sid, sc_obj, policy_name)\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the add_shortcut function is used to store shortcut information in the database. The sid parameter is a unique identifier for the shortcut's owner, sc_obj is an object of the Shortcut class representing the shortcut, and policy_name is the name of the policy associated with the shortcut. If a unique constraint violation occurs, the _shortcut_upsert() method will update the existing record in the database with the new policy_name, path, and shortcut attributes."}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_printerself-sid-pobj-policy_name",children:"FunctionDef add_printer(self, sid, pobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_printer"}),": The function of ",(0,n.jsx)(t.code,{children:"add_printer"})," is to store printer configuration in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": A string representing the security identifier (SID) of the user or group associated with the printer.\n\xb7 ",(0,n.jsx)(t.code,{children:"pobj"}),": A printer object containing the printer's configuration.\n\xb7 ",(0,n.jsx)(t.code,{children:"policy_name"}),": A string representing the name of the policy associated with the printer."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"add_printer"})," function begins by creating a ",(0,n.jsx)(t.code,{children:"printer_entry"})," object with the given ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"pobj"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"})," parameters. It then logs the ",(0,n.jsx)(t.code,{children:"printer"})," and ",(0,n.jsx)(t.code,{children:"sid"})," parameters using the ",(0,n.jsx)(t.code,{children:"log()"})," function."]}),"\n",(0,n.jsxs)(t.p,{children:["Next, it calls the ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," method to either add the new ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to the database or update an existing object with the same SID and name. The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," method is a helper method that handles exceptions and rolls back the database session to ensure data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_printer_entry"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to store a new printer configuration in the database. It assumes that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object has been properly initialized and contains valid values. It does not perform any error checking or exception handling."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["When creating a new ",(0,n.jsx)(t.code,{children:"printer_entry"})," object, make sure to pass in a valid printer object with a ",(0,n.jsx)(t.code,{children:"name"})," attribute."]}),"\n",(0,n.jsxs)(t.li,{children:["Be cautious when using the ",(0,n.jsx)(t.code,{children:"add_printer"})," function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."]}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object provided to this function is a valid instance of the ",(0,n.jsx)(t.code,{children:"printer_entry"})," class, as it will be directly added to the database session."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["This function assumes that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object has been properly initialized and contains valid values. It does not perform any error checking or exception handling."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"_printer_upsert"})," function is called to add the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object to the database session. If an exception occurs during this operation, the existing printer entries with the same SID and name are filtered and updated with the new fields."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function is used to store a new printer configuration in the database."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_printer_entry"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function assumes that the ",(0,n.jsx)(t.code,{children:"printer_entry"})," object has been properly initialized and contains valid values. It does not perform any error checking or exception handling."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function handles exceptions and rolls back the database session to ensure data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_printer"})," function is used to maintain data consistency and atomicity of the database operations in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_driveself-sid-dobj-policy_name",children:"FunctionDef add_drive(self, sid, dobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_drive"}),": The function of add_drive is to add a new drive entry or update an existing one in the SQLite registry using the provided drive entry details."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of the add_drive function are:\n\xb7 sid: A string representing the security identifier (SID) of the user or group to which the drive mapping applies.\n\xb7 dobj: An object containing login, password, dir, path, action, thisDrive, allDrives, label, persistent, and useLetter attributes.\n\xb7 policy_name: A string representing the name of the policy that the drive mapping belongs to."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe add_drive function begins by creating a new drive_entry object using the provided sid, dobj, and policy_name. The drive_entry object contains the drive entry details such as SID, policy name, login, password, and other relevant attributes."]}),"\n",(0,n.jsx)(t.p,{children:"Next, the function logs the drive entry details using the log() function from the logging.py module. The logdata dictionary contains the 'uri' and 'sid' keys, which are set to the path of the drive entry and the provided sid, respectively."}),"\n",(0,n.jsx)(t.p,{children:"Finally, the function calls the _drive_upsert() method of the sqlite_registry object, passing the drive_entry object as a parameter. The _drive_upsert() method adds the provided drive_entry object to the database session using the _add() method. If adding the row raises an exception (which could occur due to a unique constraint violation, for example), the function catches the exception and proceeds to update the existing record in the database with the new values of the object's attributes."}),"\n",(0,n.jsx)(t.p,{children:"After updating the record, the function commits the database session using db_session.commit()."}),"\n",(0,n.jsx)(t.p,{children:"This function is called by the add_drive() method of the sqlite_registry class, which creates a new drive_entry object and inserts or updates it in the database using the _drive_upsert() method."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The add_drive function assumes that the provided sid, dobj, and policy_name parameters contain valid values."}),"\n",(0,n.jsx)(t.li,{children:"The function directly interacts with the database, so be cautious when using it and make sure to handle exceptions and rollbacks appropriately in the caller function."}),"\n",(0,n.jsx)(t.li,{children:"Ensure that the provided drive_entry object is a valid instance of the drive_entry class, as it will be directly added to the database session or used to update an existing record."}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_folderself-sid-fobj-policy_name",children:"FunctionDef add_folder(self, sid, fobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_folder"}),": The function of ",(0,n.jsx)(t.code,{children:"add_folder"})," is to add a new folder entry to the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The function ",(0,n.jsx)(t.code,{children:"add_folder"})," takes three parameters:\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": A string representing the security identifier (SID) of the user or group associated with the folder.\n\xb7 ",(0,n.jsx)(t.code,{children:"fobj"}),": An instance of the ",(0,n.jsx)(t.code,{children:"folder_entry"})," class, which contains information about the folder such as its path, policy name, and actions to be taken.\n\xb7 ",(0,n.jsx)(t.code,{children:"policy_name"}),": A string representing the name of the policy associated with the folder."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"add_folder"})," function begins by creating a new ",(0,n.jsx)(t.code,{children:"folder_entry"})," instance with the provided ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"fobj"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"})," parameters. It then logs the folder path and SID using the ",(0,n.jsx)(t.code,{children:"log"})," function."]}),"\n",(0,n.jsxs)(t.p,{children:["Next, the function attempts to add the ",(0,n.jsx)(t.code,{children:"folder_entry"})," instance to the SQLite registry using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If an exception occurs during the addition, the function filters the existing entries in the ",(0,n.jsx)(t.code,{children:"Folders"})," table based on the provided SID and specific attributes using the ",(0,n.jsx)(t.code,{children:"_filter_sid_obj"})," method. It then updates the existing entries using the ",(0,n.jsx)(t.code,{children:"update"})," method."]}),"\n",(0,n.jsxs)(t.p,{children:["If no exception occurs during the addition, the function commits the database session using ",(0,n.jsx)(t.code,{children:"db_session.commit()"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,n.jsx)(t.code,{children:"add_folder"})," function is called by the ",(0,n.jsx)(t.code,{children:"add_folder_entry"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class. This method is responsible for adding new folder entries to the SQLite registry based on user input."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nWhen using the ",(0,n.jsx)(t.code,{children:"add_folder"})," function, ensure that the ",(0,n.jsx)(t.code,{children:"sid"})," parameter contains a valid SID value and that the ",(0,n.jsx)(t.code,{children:"fobj"})," parameter is an instance of the ",(0,n.jsx)(t.code,{children:"folder_entry"})," class. Also, make sure to handle exceptions appropriately in the caller function."]}),"\n",(0,n.jsxs)(t.p,{children:["Here is an example of how the ",(0,n.jsx)(t.code,{children:"add_folder"})," function could be used in the ",(0,n.jsx)(t.code,{children:"add_folder_entry"})," method:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"try:\n    self.add_folder(sid, folder_entry_instance, policy_name)\nexcept Exception as e:\n    # Handle exception\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, ",(0,n.jsx)(t.code,{children:"sid"})," is a valid SID value, ",(0,n.jsx)(t.code,{children:"folder_entry_instance"})," is an instance of the ",(0,n.jsx)(t.code,{children:"folder_entry"})," class, and ",(0,n.jsx)(t.code,{children:"policy_name"})," is a string representing the name of the policy associated with the folder. If an exception occurs during the addition of the ",(0,n.jsx)(t.code,{children:"folder_entry"})," instance, the ",(0,n.jsx)(t.code,{children:"add_folder_entry"})," method handles the exception appropriately."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_envvarself-sid-evobj-policy_name",children:"FunctionDef add_envvar(self, sid, evobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_envvar"}),": The function of add_envvar is to add an environment variable entry to the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function are as follows:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": A string representing the SID (Security Identifier) of the user or group."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"evobj"}),": An object representing the environment variable, with attributes name and value."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"policy_name"}),": A string representing the name of the policy."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"add_envvar"})," creates an ",(0,n.jsx)(t.code,{children:"envvar_entry"})," object by calling its constructor and passing the ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"evobj"}),", and ",(0,n.jsx)(t.code,{children:"policy_name"})," parameters. It then initializes a ",(0,n.jsx)(t.code,{children:"logdata"})," dictionary to store log data, including the environment variable name and SID. The log data is then used to log a message with the log function."]}),"\n",(0,n.jsxs)(t.p,{children:["Next, the function attempts to add the ",(0,n.jsx)(t.code,{children:"envvar_entry"})," object to the SQLite registry using the ",(0,n.jsx)(t.code,{children:"_add"})," method. If an exception occurs during this process, the function filters the existing ",(0,n.jsx)(t.code,{children:"envvar_entry"})," objects based on the provided SID and environment variable name using the ",(0,n.jsx)(t.code,{children:"_filter_sid_obj"})," method. It then updates the filtered objects' policy name, action, and value fields using the ",(0,n.jsx)(t.code,{children:"update"})," method with the fields returned by the ",(0,n.jsx)(t.code,{children:"update_fields"})," method of the ",(0,n.jsx)(t.code,{children:"envvar_entry"})," object."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"db_session.commit()"})," method is called to commit the transaction, and the function returns nothing."]}),"\n",(0,n.jsxs)(t.p,{children:["From a functional perspective, the ",(0,n.jsx)(t.code,{children:"add_envvar"})," method is responsible for adding or updating environment variable entries in the SQLite registry based on the provided SID, environment variable object, and policy name. It handles exceptions and updates existing entries if necessary, ensuring data consistency and atomicity of the database operations."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"evobj"})," parameters contain valid values, as they will be used to filter and update existing entries in the database."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"add_envvar"})," function is designed to be used as part of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and should not be called independently."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_scriptself-sid-scrobj-policy_name",children:"FunctionDef add_script(self, sid, scrobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_script"}),": The function of add_script is to add a new script entry to the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function are as follows:\n\xb7 sid: A unique identifier for the script entry.\n\xb7 scrobj: A script object containing attributes such as action, number, path, and arg.\n\xb7 policy_name: The name of the policy associated with the script."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe add_script function begins by creating a new script_entry object with the provided sid, scrobj, and policy_name. It then logs the script path and sid using the log() function."]}),"\n",(0,n.jsxs)(t.p,{children:["Next, the function attempts to add the script_entry object to the SQLite registry using the ",(0,n.jsx)(t.code,{children:"self._add"})," method. If an exception occurs during this process, the function filters the existing script entries based on the provided sid and specific attributes using the ",(0,n.jsx)(t.code,{children:"self._filter_sid_obj"})," method. It then updates the existing entries using the ",(0,n.jsx)(t.code,{children:"update"})," method."]}),"\n",(0,n.jsxs)(t.p,{children:["Finally, the function commits the database session using ",(0,n.jsx)(t.code,{children:"self.db_session.commit()"}),". If an exception occurs during any of these steps, the function rolls back the database session using ",(0,n.jsx)(t.code,{children:"self.db_session.rollback()"})," and re-raises the exception to be handled by the caller."]}),"\n",(0,n.jsx)(t.p,{children:"The add_script function serves as a helper method for adding new script entries to the SQLite registry. It handles exceptions and rolls back the database session, ensuring data consistency and atomicity of the database operations."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relation with Callees"}),":\nThe add_script function calls the ",(0,n.jsx)(t.code,{children:"self._add"})," and ",(0,n.jsx)(t.code,{children:"self._filter_sid_obj"})," methods, which are helper methods for adding and filtering rows in the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"scrobj"})," object provided to this function contains valid attributes, as it will be used to create a new script_entry object."]}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_fileself-sid-fileobj-policy_name",children:"FunctionDef add_file(self, sid, fileobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_file"}),": The function of add_file is to add a new file entry to the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function are as follows:\n\xb7 sid: A string representing the unique identifier of the user or group.\n\xb7 fileobj: An object containing file-related information.\n\xb7 policy_name: A string representing the name of the policy associated with the file."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe add_file function begins by creating a new file_entry object using the provided sid, fileobj, and policy_name. It then logs the targetPath and fromPath attributes of the file_entry object using the log() function."]}),"\n",(0,n.jsx)(t.p,{children:"Next, the function attempts to add the file_entry object to the database using the _add method of the sqlite_registry object. If an exception occurs during this process, the function filters the existing file entries based on the provided sid and specific attributes using the _filter_sid_obj method. It then updates these existing entries using the update method."}),"\n",(0,n.jsx)(t.p,{children:"Finally, the function commits the database session using the db_session.commit() method."}),"\n",(0,n.jsx)(t.p,{children:"The add_file function serves as a helper method for adding new file entries to the database. It handles exceptions and rolls back the database session, ensuring data consistency and atomicity of the database operations."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relation with Callers"}),":\nThe add_file function is utilized in various methods of the project that need to add new file entries to the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsx)(t.li,{children:"Ensure that the file_entry object provided to this function is a valid instance of the file_entry class, as it will be directly added to the database session."}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nSuppose we have a database table named file_entries with columns sid, policy_name, action, fromPath, targetPath, readOnly, archive, hidden, suppress, and executable. Here's an example of how the add_file function could be used:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"sqlite_registry_obj.add_file('1234567890', {'action': 'copy', 'fromPath': '/path/to/file', 'targetPath': '/new/path/to/file', 'readOnly': False, 'archive': False, 'hidden': False, 'suppress': False, 'executable': False}, 'MyPolicy')\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the add_file function adds a new file entry to the file_entries table with the sid value of '1234567890', associated with the 'MyPolicy' policy, and has the file-related information of copying the file from '/path/to/file' to '/new/path/to/file'."}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-add_iniself-sid-iniobj-policy_name",children:"FunctionDef add_ini(self, sid, iniobj, policy_name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"add_ini"}),": The function of add_ini is to add an ini_entry object to the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function are as follows:\n\xb7 sid: A string representing the security identifier (SID) of the user or group.\n\xb7 iniobj: An instance of the iniobj class, which contains information about the INI file entries.\n\xb7 policy_name: A string representing the name of the policy."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe add_ini function begins by creating an ini_entry object with the provided sid, iniobj, and policy_name. It then logs some data related to the ini_entry object, including its path and action."]}),"\n",(0,n.jsx)(t.p,{children:"If an exception occurs during the addition of the ini_entry object to the SQLite registry, the function filters the existing entries based on the provided SID and specific attributes, and updates them with the new ini_entry object's fields."}),"\n",(0,n.jsx)(t.p,{children:"The function uses the _add method of the sqlite_registry object to add the ini_entry object to the SQLite registry. If an exception occurs during the addition, the function catches it, rolls back the database session to undo any changes made in the current transaction, and re-raises the exception to be handled by the caller."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relation with Callees"}),":\nThe add_ini function is called by the add_ini method of the sqlite_registry class."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function."}),"\n",(0,n.jsx)(t.li,{children:"Ensure that the iniobj parameter provided to this function is a valid instance of the iniobj class, as it will be directly added to the database session."}),"\n",(0,n.jsx)(t.li,{children:"When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nSuppose we have a SQLite registry with a table named ini_entries. Here's an example of how the add_ini function could be used in the add_ini method:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"sqlite_registry.add_ini('S-1-5-21-123456789-123456789-123456789-12345', iniobj, 'my_policy')\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the add_ini function adds a new ini_entry object to the ini_entries table with the provided SID, iniobj, and policy_name. If an exception occurs during the addition, the function filters the existing entries based on the provided SID and specific attributes, and updates them with the new ini_entry object's fields."}),"\n",(0,n.jsx)(t.p,{children:"Raw code:```\ndef add_ini(self, sid, iniobj, policy_name):\ninientry = ini_entry(sid, iniobj, policy_name)\nlogdata = dict()\nlogdata['path'] = inientry.path\nlogdata['action'] = inientry.action\nlog('D177', logdata)\ntry:\nself._add(inientry)\nexcept Exception as exc:\n(self\n._filter_sid_obj(ini_entry, sid)\n.filter(ini_entry.path == inientry.path)\n.update(inientry.update_fields()))\nself.db_session.commit()"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-==========",children:"***\n### FunctionDef add_networkshare(self, sid, networkshareobj, policy_name)\n **add\\_networkshare**: The function of add\\_networkshare is to add a new network share entry to the SQLite registry in the project.\n\n**parameters**: The parameters of this Function are as follows:\n\xb7 sid: A string representing the SID (Security Identifier) of the user or group associated with the network share.\n\xb7 networkshareobj: An object containing the details of the network share, such as name, action, path, and other attributes.\n\xb7 policy\\_name: A string representing the name of the policy associated with the network share.\n\n**Code Description**:\nThe function add\\_networkshare creates a new networkshare\\_entry object by passing the provided parameters to its constructor. It then initializes a dictionary called logdata with the name, path, and action attributes of the networkshare\\_entry object. This logdata dictionary is used to log the details of the network share being added.\n\nThe function then calls the _add method of the sqlite\\_registry object, passing the networkshare\\_entry object as a parameter. If an exception occurs during the execution of the _add method, the function catches it and proceeds to filter the existing network share entries based on the provided SID and other attributes. It does this by calling the _filter\\_sid\\_obj method of the sqlite\\_registry object, passing the networkshare\\_entry class and the SID as parameters. The resulting queryset is then updated using the update method, passing the update\\_fields method of the networkshare\\_entry object as a parameter.\n\nFinally, the function commits the database session using the db\\_session.commit() method.\n\nThe add\\_networkshare function serves as a helper method for adding new network share entries to the SQLite registry in the project. It handles exceptions and rolls back the database session, ensuring data consistency and atomicity of the database operations.\n\n**Relation with Callers**:\nThe add\\_networkshare function is called by the add\\_networkshare method of the sqlite\\_registry class. This method is responsible for adding new network share entries to the SQLite registry based on the provided parameters.\n\n**Note**:\n- Be cautious when using this function, as it directly interacts with the database. Make sure to properly handle exceptions and rollbacks in the caller function.\n- Ensure that the networkshareobj parameter contains valid attributes, as it will be used to create the networkshare\\_entry object.\n- When using this function in a transaction, make sure to commit or rollback the session appropriately after the operation to maintain data consistency.\n***\n### FunctionDef _filter_sid_obj(self, row_object, sid)\n **`_filter_sid_obj`**: The function of `_filter_sid_obj` is to filter a row object based on a specified SID (Security Identifier).\n\n**parameters**:\n\xb7 `row_object`: The database model class that represents the table to be queried.\n\xb7 `sid`: The Security Identifier (SID) to be used in the filtering process.\n\n**Code Description**:\nThe function `_filter_sid_obj` is a method of the `sqlite_registry` class, which takes two parameters: `row_object` and `sid`. The purpose of this function is to filter rows in the database table represented by the `row_object` parameter where the `sid` column matches the provided `sid` value.\n\nThe function begins by creating a query using the `db_session.query()` method with the `row_object` parameter. This query is then filtered using the `filter()` method, which checks if the `sid` column of the queried table matches the provided `sid` value.\n\nThe resulting query is then returned by the function. If there are no matching rows in the table, an empty queryset will be returned.\n\n**Relation with Callers**:\nThe function `_filter_sid_obj` is utilized in various methods of the `sqlite_registry` class, such as `add_folder`, `add_envvar`, `add_script`, `add_file`, `add_ini`, and `add_networkshare`. In these methods, if an exception occurs during the addition of a new entry, the existing entry with the same SID and other attributes is updated instead. The `_filter_sid_obj` function is used to filter the existing entries based on the provided SID and specific attributes, which are then updated using the `update()` method.\n\n**Note**:\nWhen using the `_filter_sid_obj` function, ensure that the `row_object` parameter corresponds to the correct database table model class and that the `sid` parameter contains a valid SID value.\n\n**Output Example**:\nSuppose we have a database table named `folders` with columns `sid`, `path`, and `policy_name`. Here's an example of how the `_filter_sid_obj` function could be used in the `add_folder` method:\n\n```python\nresult = self._filter_sid_obj(folder_entry, 'S-1-5-21-123456789-123456789-123456789-12345')\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"_filter_sid_obj"})," function filters the ",(0,n.jsx)(t.code,{children:"folders"})," table for rows with a ",(0,n.jsx)(t.code,{children:"sid"})," value of 'S-1-5-21-123456789-123456789-123456789-12345'. The resulting queryset will contain all rows that match the filter criteria."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_filter_sid_listself-row_object-sid",children:"FunctionDef _filter_sid_list(self, row_object, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_filter_sid_list"})}),": The function of ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," is to filter and retrieve a list of objects from the database based on a given SID (Security Identifier)."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"row_object"}),": The database model class (e.g., ",(0,n.jsx)(t.code,{children:"ad_shortcut"}),", ",(0,n.jsx)(t.code,{children:"printer_entry"}),", ",(0,n.jsx)(t.code,{children:"drive_entry"}),", etc.) to be used for querying the database."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the objects in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," uses the SQLAlchemy query API to filter the objects based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. It first initializes a query for the provided ",(0,n.jsx)(t.code,{children:"row_object"})," and then applies a filter on the ",(0,n.jsx)(t.code,{children:"sid"})," column with the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. The query results are then ordered by the ",(0,n.jsx)(t.code,{children:"id"})," column and returned as a list of objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The function ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," is used as a helper function for other functions in the project, such as ",(0,n.jsx)(t.code,{children:"get_shortcuts"}),", ",(0,n.jsx)(t.code,{children:"get_printers"}),", ",(0,n.jsx)(t.code,{children:"get_drives"}),", ",(0,n.jsx)(t.code,{children:"get_folders"}),", ",(0,n.jsx)(t.code,{children:"get_envvars"}),", ",(0,n.jsx)(t.code,{children:"get_files"}),", ",(0,n.jsx)(t.code,{children:"get_networkshare"}),", and ",(0,n.jsx)(t.code,{children:"get_ini"}),". These functions call ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," with the appropriate database model class and SID to retrieve a filtered list of objects from the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"row_object"})," parameter should be a database model class that is mapped to a table in the database."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_shortcutsself-sid",children:"FunctionDef get_shortcuts(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_shortcuts"}),": The function of ",(0,n.jsx)(t.code,{children:"get_shortcuts"})," is to retrieve a list of shortcut objects associated with a given SID (Security Identifier) from the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the shortcut objects in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"get_shortcuts"})," is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is used to retrieve a list of shortcut objects from the database based on a given SID. It first initializes an instance of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which represents a connection to the SQLite database used in the project. Then, it calls the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," method of this instance, passing the ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class and the given SID as parameters. The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," method filters and retrieves a list of objects from the database based on the given SID and returns this list."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"ad_shortcut"})," class is a mapping representation of a Windows shortcut object, which has four attributes: ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"policy_name"}),", ",(0,n.jsx)(t.code,{children:"path"}),", and ",(0,n.jsx)(t.code,{children:"shortcut"}),". The ",(0,n.jsx)(t.code,{children:"sid"})," attribute is a unique identifier for the shortcut's owner, ",(0,n.jsx)(t.code,{children:"policy_name"})," is the name of the policy associated with the shortcut, ",(0,n.jsx)(t.code,{children:"path"})," is the path of the shortcut, and ",(0,n.jsx)(t.code,{children:"shortcut"})," is a JSON representation of the shortcut."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," method uses the SQLAlchemy query API to filter the objects based on the given SID parameter. It first initializes a query for the provided ",(0,n.jsx)(t.code,{children:"row_object"})," and then applies a filter on the ",(0,n.jsx)(t.code,{children:"sid"})," column with the given SID parameter. The query results are then ordered by the ",(0,n.jsx)(t.code,{children:"id"})," column and returned as a list of objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_shortcuts"})," function is used in the ",(0,n.jsx)(t.code,{children:"storage_get_shortcuts"})," function in the ",(0,n.jsx)(t.code,{children:"shortcut_applier.py"})," module to retrieve a list of shortcut objects from the database and convert them into a list of ",(0,n.jsx)(t.code,{children:"Shortcut"})," objects, which are used in the frontend of the project."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_printersself-sid",children:"FunctionDef get_printers(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_printers"}),": The function of ",(0,n.jsx)(t.code,{children:"get_printers"})," is to retrieve a list of ",(0,n.jsx)(t.code,{children:"printer_entry"})," objects associated with a given SID (Security Identifier) from a SQLite database using the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"self"}),": The instance of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class that the method is called upon.\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the ",(0,n.jsx)(t.code,{children:"printer_entry"})," objects in the database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_printers"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class that takes a SID as an argument and returns a list of ",(0,n.jsx)(t.code,{children:"printer_entry"})," objects associated with that SID. It does this by calling the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function with the ",(0,n.jsx)(t.code,{children:"printer_entry"})," class and the given SID as arguments."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," function returns a list of objects that match the given SID, which is then returned by the ",(0,n.jsx)(t.code,{children:"get_printers"})," function. The ",(0,n.jsx)(t.code,{children:"printer_entry"})," class is used to represent Windows printer configurations in the form of an object mapping, and it has attributes such as ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"policy_name"}),", ",(0,n.jsx)(t.code,{children:"name"}),", and ",(0,n.jsx)(t.code,{children:"printer"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_printers"})," function is called by the ",(0,n.jsx)(t.code,{children:"storage_get_printers"})," function in the ",(0,n.jsx)(t.code,{children:"cups_applier.py"})," module, which is used to query printers configuration from the storage. The ",(0,n.jsx)(t.code,{children:"storage_get_printers"})," function takes a ",(0,n.jsx)(t.code,{children:"storage"})," object and a SID as arguments and returns a list of ",(0,n.jsx)(t.code,{children:"printer_entry"})," objects associated with the given SID."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_printers"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, and it should be called on an instance of that class. The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_drivesself-sid",children:"FunctionDef get_drives(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_drives"}),": The function of ",(0,n.jsx)(t.code,{children:"get_drives"})," is to retrieve a list of drive mappings for a given security identifier (SID) from the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The security identifier (SID) to filter the drive mappings in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_drives"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is responsible for managing various types of records in a SQLite database. It uses the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function to filter the drive mappings based on the provided SID. The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," function performs a SQL query on the ",(0,n.jsx)(t.code,{children:"drive_entry"})," table, filtering the rows where the ",(0,n.jsx)(t.code,{children:"sid"})," column matches the given SID. The query results are then returned as a list of ",(0,n.jsx)(t.code,{children:"drive_entry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_drives"})," function is called by the ",(0,n.jsx)(t.code,{children:"storage_get_drives"})," function in the ",(0,n.jsx)(t.code,{children:"cifs_applier.py"})," module, which is part of the frontend of the project. The ",(0,n.jsx)(t.code,{children:"storage_get_drives"})," function retrieves the drive mappings for a given SID and returns them as a list of ",(0,n.jsx)(t.code,{children:"drive_entry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:["Here's an example of how the ",(0,n.jsx)(t.code,{children:"get_drives"})," function can be used:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"# Initialize a sqlite_registry object\nstorage = sqlite_registry('sqlite:///registry.db')\n\n# Call the get_drives function with a SID\ndrives = storage.get_drives('S-1-5-21-1234567890-1234567890-1234567890-12345')\n\n# The drives variable now contains a list of drive_entry objects\n# representing the drive mappings for the given SID\nfor drive in drives:\n    print(drive.thisDrive, drive.path)\n"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The provided SID should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"get_drives"})," function returns a list of ",(0,n.jsx)(t.code,{children:"drive_entry"})," objects, which can be used to access the attributes of each drive mapping."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_foldersself-sid",children:"FunctionDef get_folders(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_folders"}),": The function of ",(0,n.jsx)(t.code,{children:"get_folders"})," is to retrieve a list of ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects associated with a given SID (Security Identifier) from the 'Folders' table in the SQLite database using the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects in the 'Folders' table."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_folders"})," function is defined in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, and it takes a single parameter ",(0,n.jsx)(t.code,{children:"sid"}),". It calls the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function with ",(0,n.jsx)(t.code,{children:"folder_entry"})," as the ",(0,n.jsx)(t.code,{children:"row_object"})," parameter and the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter to filter and retrieve a list of ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects associated with the given SID from the 'Folders' table in the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_folders"})," function is called in the ",(0,n.jsx)(t.code,{children:"__init__"})," method of the ",(0,n.jsx)(t.code,{children:"folder_applier"})," and ",(0,n.jsx)(t.code,{children:"folder_applier_user"})," classes in the ",(0,n.jsx)(t.code,{children:"folder_applier.py"})," module to initialize the ",(0,n.jsx)(t.code,{children:"folders"})," attribute of these classes. The ",(0,n.jsx)(t.code,{children:"folders"})," attribute is then used in these classes to apply folder settings based on the retrieved ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_folders"})," function is called by the ",(0,n.jsx)(t.code,{children:"__init__"})," method of the ",(0,n.jsx)(t.code,{children:"folder_applier"})," and ",(0,n.jsx)(t.code,{children:"folder_applier_user"})," classes in the ",(0,n.jsx)(t.code,{children:"folder_applier.py"})," module to initialize the ",(0,n.jsx)(t.code,{children:"folders"})," attribute of these classes."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"get_folders"})," function returns a list of ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects associated with the given SID from the 'Folders' table in the SQLite database."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"get_folders"})," function calls the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function to filter and retrieve the ",(0,n.jsx)(t.code,{children:"folder_entry"})," objects from the database."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_envvarsself-sid",children:"FunctionDef get_envvars(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_envvars"}),": The function of ",(0,n.jsx)(t.code,{children:"get_envvars"})," is to retrieve a list of environment variable entries from the database based on a given SID (Security Identifier)."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the environment variable entries in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"get_envvars"})," uses the helper function ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," to filter and retrieve a list of environment variable entries from the database based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. It first initializes a query for the ",(0,n.jsx)(t.code,{children:"envvar_entry"})," model class and then applies a filter on the ",(0,n.jsx)(t.code,{children:"sid"})," column with the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. The query results are then returned as a list of ",(0,n.jsx)(t.code,{children:"envvar_entry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"envvar_entry"})," objects represent environment variables in an object mapping format, with attributes such as ",(0,n.jsx)(t.code,{children:"sid"}),", ",(0,n.jsx)(t.code,{children:"policy_name"}),", ",(0,n.jsx)(t.code,{children:"name"}),", ",(0,n.jsx)(t.code,{children:"value"}),", and ",(0,n.jsx)(t.code,{children:"action"}),". These objects are used in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to manage environment variables in a SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_envvars"})," function is called in the ",(0,n.jsx)(t.code,{children:"__init__"})," methods of the ",(0,n.jsx)(t.code,{children:"envvar_applier"})," and ",(0,n.jsx)(t.code,{children:"envvar_applier_user"})," classes in the ",(0,n.jsx)(t.code,{children:"envvar_applier"})," module. These classes use the function to retrieve a list of environment variable entries for a given SID and store it in an instance variable for further processing."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nA possible appearance of the code's return value when calling the ",(0,n.jsx)(t.code,{children:"get_envvars"})," method in ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," with a given SID:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"[\n    envvar_entry(sid='S-1-5-21-123456789-123456789-123456789-12345', policy_name='test_policy', name='TEST_VAR', value='test_value', action='create'),\n    envvar_entry(sid='S-1-5-21-123456789-123456789-123456789-12345', policy_name='test_policy2', name='TEST_VAR2', value='test_value2', action='create')\n]\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"get_envvars"})," function has successfully retrieved a list of ",(0,n.jsx)(t.code,{children:"envvar_entry"})," objects with the given SID from the database."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_filter_scripts_listself-row_object-sid-action",children:"FunctionDef _filter_scripts_list(self, row_object, sid, action)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"_filter_scripts_list"})}),": The function of ",(0,n.jsx)(t.code,{children:"_filter_scripts_list"})," is to filter and retrieve a list of script entries from the SQLite registry based on the provided ",(0,n.jsx)(t.code,{children:"sid"})," (script ID) and ",(0,n.jsx)(t.code,{children:"action"})," parameters."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),"\n\xb7 ",(0,n.jsx)(t.code,{children:"row_object"}),": The mapped class object representing the table in the SQLite database. In this case, it is ",(0,n.jsx)(t.code,{children:"script_entry"}),".\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": An integer representing the script ID.\n\xb7 ",(0,n.jsx)(t.code,{children:"action"}),": A string representing the action associated with the script."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Code Description"})}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"self.db_session.query(row_object)"}),": This initializes a query for the specified ",(0,n.jsx)(t.code,{children:"row_object"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:".filter(row_object.sid == sid)"}),": This filters the query results based on the ",(0,n.jsx)(t.code,{children:"sid"})," (script ID) provided. It returns only those rows where the ",(0,n.jsx)(t.code,{children:"sid"})," matches the given ",(0,n.jsx)(t.code,{children:"sid"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:".filter(row_object.action == action)"}),": This filters the query results based on the ",(0,n.jsx)(t.code,{children:"action"})," parameter provided. It returns only those rows where the ",(0,n.jsx)(t.code,{children:"action"})," matches the given ",(0,n.jsx)(t.code,{children:"action"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:".order_by(row_object.id)"}),": This orders the query results by the ",(0,n.jsx)(t.code,{children:"id"})," column in ascending order."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:".all()"}),": This executes the query and returns all the results as a list of tuples."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"_filter_scripts_list"})," function is used by the ",(0,n.jsx)(t.code,{children:"get_scripts"})," function in the project to filter and retrieve a list of script entries based on the provided ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"action"}),". By using this function, the code can reuse the filtering logic and maintain consistency in the SQL queries throughout the project."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Note"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Ensure that the ",(0,n.jsx)(t.code,{children:"row_object"})," parameter matches the mapped class object representing the table in the SQLite database."]}),"\n",(0,n.jsxs)(t.li,{children:["Provide valid ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"action"})," parameters to filter the script entries correctly."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),"\nAssuming the SQLite registry contains the following script entries:"]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"id"}),(0,n.jsx)(t.th,{children:"sid"}),(0,n.jsx)(t.th,{children:"action"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"100"}),(0,n.jsx)(t.td,{children:'"start"'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"2"}),(0,n.jsx)(t.td,{children:"101"}),(0,n.jsx)(t.td,{children:'"stop"'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"3"}),(0,n.jsx)(t.td,{children:"100"}),(0,n.jsx)(t.td,{children:'"stop"'})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["A possible output for ",(0,n.jsx)(t.code,{children:'_filter_scripts_list(script_entry, 100, "start")'})," would be:"]}),"\n",(0,n.jsx)(t.p,{children:'[\n(1, 100, "start")\n]'}),"\n",(0,n.jsxs)(t.p,{children:["This output indicates that there is one script entry with ",(0,n.jsx)(t.code,{children:"sid"})," 100 and ",(0,n.jsx)(t.code,{children:"action"}),' "start".']}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_scriptsself-sid-action",children:"FunctionDef get_scripts(self, sid, action)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_scripts"}),": The function of get_scripts is to retrieve a list of script entries from the SQLite registry based on the provided script ID (sid) and action."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),"\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": An integer representing the script ID.\n\xb7 ",(0,n.jsx)(t.code,{children:"action"}),": A string representing the action associated with the script."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Code Description"})}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"self._filter_scripts_list(script_entry, sid, action)"}),": This calls the ",(0,n.jsx)(t.code,{children:"_filter_scripts_list"})," function with the ",(0,n.jsx)(t.code,{children:"script_entry"})," class object, ",(0,n.jsx)(t.code,{children:"sid"}),", and ",(0,n.jsx)(t.code,{children:"action"})," parameters. The ",(0,n.jsx)(t.code,{children:"_filter_scripts_list"})," function filters and retrieves a list of script entries based on the provided ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"action"})," parameters."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_scripts"})," function is used in the project to retrieve the script entries associated with a given user and action from the database. It is called in the ",(0,n.jsx)(t.code,{children:"gpoa/frontend/scripts_applier.py"})," module in both ",(0,n.jsx)(t.code,{children:"scripts_applier"})," and ",(0,n.jsx)(t.code,{children:"scripts_applier_user"})," classes."]}),"\n",(0,n.jsxs)(t.p,{children:["In the ",(0,n.jsx)(t.code,{children:"scripts_applier"})," class, ",(0,n.jsx)(t.code,{children:"get_scripts"})," is called with ",(0,n.jsx)(t.code,{children:"'STARTUP'"})," and ",(0,n.jsx)(t.code,{children:"'SHUTDOWN'"})," actions to initialize the ",(0,n.jsx)(t.code,{children:"startup_scripts"})," and ",(0,n.jsx)(t.code,{children:"shutdown_scripts"})," attributes, respectively. In the ",(0,n.jsx)(t.code,{children:"scripts_applier_user"})," class, ",(0,n.jsx)(t.code,{children:"get_scripts"})," is called with ",(0,n.jsx)(t.code,{children:"'LOGON'"})," and ",(0,n.jsx)(t.code,{children:"'LOGOFF'"})," actions to initialize the ",(0,n.jsx)(t.code,{children:"logon_scripts"})," and ",(0,n.jsx)(t.code,{children:"logoff_scripts"})," attributes, respectively."]}),"\n",(0,n.jsxs)(t.p,{children:["By using the ",(0,n.jsx)(t.code,{children:"get_scripts"})," function, the code can reuse the filtering logic and maintain consistency in retrieving script entries throughout the project."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Note"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Ensure that valid ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"action"})," parameters are provided to filter the script entries correctly."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),"\nAssuming the SQLite registry contains the following script entries:"]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"id"}),(0,n.jsx)(t.th,{children:"sid"}),(0,n.jsx)(t.th,{children:"action"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"1"}),(0,n.jsx)(t.td,{children:"100"}),(0,n.jsx)(t.td,{children:'"start"'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"2"}),(0,n.jsx)(t.td,{children:"101"}),(0,n.jsx)(t.td,{children:'"stop"'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"3"}),(0,n.jsx)(t.td,{children:"100"}),(0,n.jsx)(t.td,{children:'"stop"'})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["A possible output for ",(0,n.jsx)(t.code,{children:'get_scripts(script_entry, 100, "start")'})," would be:"]}),"\n",(0,n.jsx)(t.p,{children:'[\n(1, 100, "start")\n]'}),"\n",(0,n.jsxs)(t.p,{children:["This output indicates that there is one script entry with ",(0,n.jsx)(t.code,{children:"sid"})," 100 and ",(0,n.jsx)(t.code,{children:"action"}),' "start".']}),"\n",(0,n.jsx)(t.p,{children:"Raw code:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"def get_scripts(self, sid, action):\n    return self._filter_scripts_list(script_entry, sid, action)\n"})}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_filesself-sid",children:"FunctionDef get_files(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_files"}),": The function of ",(0,n.jsx)(t.code,{children:"get_files"})," is to retrieve a list of ",(0,n.jsx)(t.code,{children:"file_entry"})," objects from the database based on a given SID (Security Identifier) using the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the ",(0,n.jsx)(t.code,{children:"file_entry"})," objects in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_files"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class that uses the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function to filter and retrieve a list of ",(0,n.jsx)(t.code,{children:"file_entry"})," objects from the database based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. It first initializes a query for the ",(0,n.jsx)(t.code,{children:"file_entry"})," database model class and then applies a filter on the ",(0,n.jsx)(t.code,{children:"sid"})," column with the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. The query results are then returned as a list of ",(0,n.jsx)(t.code,{children:"file_entry"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_files"})," function is called in the ",(0,n.jsx)(t.code,{children:"__init__"})," method of the ",(0,n.jsx)(t.code,{children:"file_applier"})," and ",(0,n.jsx)(t.code,{children:"file_applier_user"})," classes in the ",(0,n.jsx)(t.code,{children:"file_applier.py"})," module. In the ",(0,n.jsx)(t.code,{children:"__init__"})," method, the ",(0,n.jsx)(t.code,{children:"get_files"})," function is called with the ",(0,n.jsx)(t.code,{children:"sid"})," parameter to retrieve a list of ",(0,n.jsx)(t.code,{children:"file_entry"})," objects associated with the given ",(0,n.jsx)(t.code,{children:"sid"}),". The returned list of ",(0,n.jsx)(t.code,{children:"file_entry"})," objects is then assigned to the ",(0,n.jsx)(t.code,{children:"files"})," attribute of the ",(0,n.jsx)(t.code,{children:"file_applier"})," and ",(0,n.jsx)(t.code,{children:"file_applier_user"})," objects."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_networkshareself-sid",children:"FunctionDef get_networkshare(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_networkshare"}),": The function of ",(0,n.jsx)(t.code,{children:"get_networkshare"})," is to retrieve a list of network share entries from the database based on a given SID (Security Identifier)."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be used for filtering the network share entries in the database."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"get_networkshare"})," uses the helper function ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," to filter and retrieve a list of network share entries from the database based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. It first initializes the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," function with the ",(0,n.jsx)(t.code,{children:"networkshare_entry"})," class and the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," function then uses the SQLAlchemy query API to filter the network share entries based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter and returns the query results as a list of objects."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_networkshare"})," function is used in the ",(0,n.jsx)(t.code,{children:"__init__"})," method of the ",(0,n.jsx)(t.code,{children:"networkshare_applier"})," class in the ",(0,n.jsx)(t.code,{children:"networkshare_applier"})," module. In ",(0,n.jsx)(t.code,{children:"__init__"}),", the method initializes the ",(0,n.jsx)(t.code,{children:"networkshare_info"})," attribute with the list of network share entries that belong to the specified SID."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_iniself-sid",children:"FunctionDef get_ini(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_ini"}),": The function of ",(0,n.jsx)(t.code,{children:"get_ini"})," is to retrieve a list of ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects associated with a given security identifier (SID) from the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sid"}),": The security identifier (SID) to filter the ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"get_ini"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, and it is called with a single parameter ",(0,n.jsx)(t.code,{children:"sid"}),". It uses the ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," helper function to filter the ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects based on the given ",(0,n.jsx)(t.code,{children:"sid"})," parameter. The ",(0,n.jsx)(t.code,{children:"_filter_sid_list"})," function returns a list of objects that match the filter criteria, which in this case is the ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects associated with the given ",(0,n.jsx)(t.code,{children:"sid"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_ini"})," function is used in the ",(0,n.jsx)(t.code,{children:"ini_applier"})," class, which is a part of the frontend of the project. The ",(0,n.jsx)(t.code,{children:"ini_applier"})," class initializes an instance of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and calls the ",(0,n.jsx)(t.code,{children:"get_ini"})," function to retrieve a list of ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects associated with the given ",(0,n.jsx)(t.code,{children:"sid"}),". The ",(0,n.jsx)(t.code,{children:"ini_applier"})," class then uses this list to apply INI file settings to the user's profile."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"get_ini"})," function is also used in the ",(0,n.jsx)(t.code,{children:"ini_applier_user"})," class, which is a subclass of the ",(0,n.jsx)(t.code,{children:"ini_applier"})," class. The ",(0,n.jsx)(t.code,{children:"ini_applier_user"})," class initializes an instance of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and calls the ",(0,n.jsx)(t.code,{children:"get_ini"})," function to retrieve a list of ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects associated with the given ",(0,n.jsx)(t.code,{children:"sid"})," and ",(0,n.jsx)(t.code,{children:"username"}),". The ",(0,n.jsx)(t.code,{children:"ini_applier_user"})," class then uses this list to apply INI file settings to the user's profile based on their username."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"})," parameter should be a valid SID in the format of S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-xxxx."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"get_ini"})," function returns a list of ",(0,n.jsx)(t.code,{children:"ini_entry"})," objects, so you may need to iterate over the list to access individual instances."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_hkcu_entryself-sid-hive_key",children:"FunctionDef get_hkcu_entry(self, sid, hive_key)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_hkcu_entry"}),": The function of get_hkcu_entry is to retrieve a samba_hkcu_preg object from the SQLite registry based on the provided SID and hive_key."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 sid (str): The Security Identifier (SID) of the user associated with the HKCU entry.\n\xb7 hive_key (str): A string formed by concatenating keyname and valuename with a backslash, representing the full path of the registry key-value pair."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe get_hkcu_entry function first queries the SQLite database using the db_session object, filtering for the samba_hkcu_preg object with the matching sid and hive_key. If a result is found, the function returns the object directly. If no result is found, the function tries to get the value from the machine SID as a default. It queries the SQLite database again, filtering for the samba_hkcu_preg object with the machine SID and the same hive_key. If a result is found, the function returns the object. Otherwise, it returns None."]}),"\n",(0,n.jsx)(t.p,{children:"The samba_hkcu_preg object represents an HKCU (HKEY_CURRENT_USER) entry in the Windows registry, which is a key-value pair with a Security Identifier (SID). The sid attribute is the SID of the user associated with the HKCU entry. The hive_key attribute is the full path of the registry key-value pair."}),"\n",(0,n.jsx)(t.p,{children:"The get_hkcu_entry function is primarily used in the gpoa/frontend/cifs_applier.py/cifs_applier_user/check_enable_home_link, gpoa/frontend/gsettings_applier.py/gsettings_applier_user/windows_mapping_append, and gpoa/frontend/gsettings_applier.py/gsettings_applier_user/admin_context_apply functions to retrieve the samba_hkcu_preg object based on the provided SID and hive_key."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nThe get_hkcu_entry function assumes that a result will be found in the database for the given SID and hive_key. If no result is found, the function will return None."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"# Example usage of get_hkcu_entry function\nstorage = sqlite_registry()\nhkcu_entry = storage.get_hkcu_entry('S-1-5-21-123456789-0123456789-123456789-12345', 'HKCU\\\\MyValue')\nprint(hkcu_entry.sid)  # Output: S-1-5-21-123456789-0123456789-123456789-12345\nprint(hkcu_entry.hive_key)  # Output: HKCU\\MyValue\nprint(hkcu_entry.type)  # Output: 1 (REG_SZ)\nprint(hkcu_entry.data)  # Output: 'Hello, World!'\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the get_hkcu_entry function is called with the parameters 'S-1-5-21-123456789-0123456789-123456789-12345' and 'HKCU\\MyValue'. The function queries the SQLite registry for the samba_hkcu_preg object with the matching SID and hive_key and returns the object. The returned object contains the sid, hive_key, type, and data attributes. The sid attribute is the SID of the user associated with the HKCU entry. The hive_key attribute is the full path of the registry key-value pair. The type attribute is the data type of the registry value. The data attribute is the data stored in the registry value."}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-filter_hkcu_entriesself-sid-startswith",children:"FunctionDef filter_hkcu_entries(self, sid, startswith)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"filter_hkcu_entries"}),": The function of filter_hkcu_entries is to filter HKCU (HKEY_CURRENT_USER) entries in the Windows registry based on a specific Security Identifier (SID) and a given string that the hive key starts with."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": A string representing the SID of the user associated with the HKCU entry.\n\xb7 ",(0,n.jsx)(t.code,{children:"startswith"}),": A string specifying the beginning part of the hive key to filter the entries."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe filter_hkcu_entries function is defined within the sqlite_registry class in the sqlite_registry.py module. It takes two parameters, sid and startswith, and returns a query result that matches the specified conditions."]}),"\n",(0,n.jsx)(t.p,{children:"The function first initializes a query by calling the db_session attribute of the sqlite_registry class, which is an instance of SQLAlchemy's Session class. It then applies filters to the query by calling the filter method twice, once for the sid and another for the hive_key attribute of the samba_hkcu_preg class. The like operator is used in the second filter to match the startswith parameter."}),"\n",(0,n.jsx)(t.p,{children:"By returning the res object, the filter_hkcu_entries function enables further processing of the query result, such as fetching all matching entries or iterating over them."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Relationship with its callers in the project"}),":\nThe filter_hkcu_entries function is primarily used in the frontend modules of the gpoa project, specifically in gsettings_applier.py, kde_applier.py, and package_applier.py. In these modules, the function is utilized to filter HKCU entries based on specific SIDs and string patterns, allowing for targeted manipulation of registry settings."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nWhen using the filter_hkcu_entries function, ensure that the provided sid and startswith parameters are correctly formatted and match the desired HKCU entries in the Windows registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nA possible appearance of the code's return value:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"filtered_entries = filter_hkcu_entries('S-1-5-21-123456789-0123456789-123456789-12345', 'HKCU\\\\Software\\\\Policies\\\\')\nfor entry in filtered_entries:\n    print(entry.hive_key)  # Output: HKCU\\Software\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\ScreenSaveActive\n    print(entry.type)  # Output: 1 (REG_SZ)\n    print(entry.data)  # Output: 'False'\n"})}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_infoself-name",children:"FunctionDef get_info(self, name)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_info"}),": The function of get_info is to retrieve the value of a specified info entry from the SQLite registry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 name (str): The unique name of the info entry."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe get_info function takes in a single parameter, name, which is a string representing the unique name of the info entry. It then queries the SQLite database using the db_session object, filtering for the info entry with the matching name. If a result is found, the function returns the value attribute of the info entry."]}),"\n",(0,n.jsx)(t.p,{children:"The SQLite registry is implemented as a SQLite database with a table for storing info entries. Each info entry has a name and a value attribute, with the name serving as the unique identifier for the entry. The SQLite registry is used to store global policy settings for a system."}),"\n",(0,n.jsx)(t.p,{children:"The get_info function is called by the retrieve_and_store function in the nodomain_backend and samba_backend modules. In both cases, the function is used to retrieve the value of a specific info entry from the SQLite registry."}),"\n",(0,n.jsx)(t.p,{children:"In the nodomain_backend module, the function is used to retrieve the value of the 'machine_sid' info entry, which represents the security identifier (SID) of the machine. This value is then used to wipe the HKLM and HKU hives of the registry, which contain machine-level and user-level settings, respectively."}),"\n",(0,n.jsx)(t.p,{children:"In the samba_backend module, the function is used to retrieve the value of the 'domain' info entry, which represents the name of the domain to which the machine belongs. This value is then used to set the domain name in the storage object."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nThe get_info function assumes that a result will be found in the database for the given name. If no result is found, the function will raise a AttributeError."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"# Example usage of get_info function\nregistry = sqlite_registry()\ndomain_name = registry.get_info('domain')\nprint(domain_name)  # Output: 'example.com'\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the get_info function is called with the parameter 'domain'. The function queries the SQLite registry for the info entry with the name 'domain' and returns its value. The returned value is then printed to the console."}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-get_hklm_entryself-hive_key",children:"FunctionDef get_hklm_entry(self, hive_key)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"get_hklm_entry"}),": The function of get_hklm_entry is to retrieve an entry from the HKLM (HKEY_LOCAL_MACHINE) table in the SQLite database based on the provided hive_key."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),"\n\xb7 hive_key: A string that holds the full path of the registry key in the format of ",(0,n.jsx)(t.code,{children:"{keyname}\\{valuename}"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),"\nThe get_hklm_entry function is a method of the sqlite_registry class. It takes one parameter, hive_key, which is a string that holds the full path of the registry key in the format of ",(0,n.jsx)(t.code,{children:"{keyname}\\{valuename}"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"The function queries the SQLite database using the db_session object and returns the first result that matches the filter condition where the hive_key attribute of the samba_preg object is equal to the provided hive_key."}),"\n",(0,n.jsx)(t.p,{children:"The samba_preg object is an internal class of the sqlite_registry class and is used to represent an object mapping for HKLM (HKEY_LOCAL_MACHINE) entry in the Windows registry. It holds the properties of a registry key without the SID (Security Identifier)."}),"\n",(0,n.jsx)(t.p,{children:"The get_hklm_entry function is used in various parts of the project to retrieve entries from the HKLM table in the SQLite database. It is called in the get_policy_mode method of the samba_backend class to retrieve the UserPolicyMode parameter value in order to determine if it is possible to work with the user's part of GPT. It is also called in the check_experimental_enabled, check_windows_mapping_enabled, and check_module_enabled methods of the applier_frontend class to retrieve the values of specific registry keys to determine if certain features are enabled."}),"\n",(0,n.jsx)(t.p,{children:"Additionally, the get_hklm_entry function is called in the __init__ method of the firewall_applier class to retrieve the value of the firewall_switch registry key, and in the run method of the ntp_applier class to retrieve the values of the ntp_server_type, ntp_server_address_key, ntp_server_enabled, and ntp_client_enabled registry keys."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),"\nThe samba_preg class is an internal class of the sqlite_registry class and should not be used outside of it."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),"\nHere's an example of how to use the get_hklm_entry method of the sqlite_registry class:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"registry = sqlite_registry('my_database')\nhive_key = 'Software\\\\BaseALT\\\\Policies\\\\GPUpdate\\\\GlobalExperimental'\nentry = registry.get_hklm_entry(hive_key)\nprint(entry.policy_name) # Output: GlobalExperimental\nprint(entry.hive_key) # Output: Software\\BaseALT\\Policies\\GPUpdate\\GlobalExperimental\nprint(entry.type) # Output: 1 (for example)\nprint(entry.data) # Output: 1 (for example)\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the get_hklm_entry method is called with the hive_key parameter set to 'Software\\BaseALT\\Policies\\GPUpdate\\GlobalExperimental'. The method returns an instance of the samba_preg class, which holds the properties of the registry key associated with the provided hive_key. The policy_name, hive_key, type, and data attributes of the returned object are printed as an example."}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-filter_hklm_entriesself-startswith",children:"FunctionDef filter_hklm_entries(self, startswith)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"filter_hklm_entries"}),": The function of ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," is to filter the HKLM (HKEY_LOCAL_MACHINE) entries in the Windows registry based on a given prefix string."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"startswith"}),": A string that specifies the prefix to filter the HKLM entries."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," function is a method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class, which is defined in the ",(0,n.jsx)(t.code,{children:"sqlite_registry.py"})," module. It takes a single parameter ",(0,n.jsx)(t.code,{children:"startswith"}),", which is a string that specifies the prefix to filter the HKLM entries."]}),"\n",(0,n.jsxs)(t.p,{children:["The function uses the ",(0,n.jsx)(t.code,{children:"db_session"})," attribute of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class to query the ",(0,n.jsx)(t.code,{children:"samba_preg"})," objects from the SQLite database. The ",(0,n.jsx)(t.code,{children:"db_session"})," attribute is an instance of the SQLAlchemy ",(0,n.jsx)(t.code,{children:"Session"})," class, which provides a handle to the database session and allows executing database queries."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"query"})," method of the ",(0,n.jsx)(t.code,{children:"db_session"})," object is called with the ",(0,n.jsx)(t.code,{children:"samba_preg"})," class as an argument, which specifies that the query should return the ",(0,n.jsx)(t.code,{children:"samba_preg"})," objects. The ",(0,n.jsx)(t.code,{children:"filter"})," method is then called on the query object to filter the ",(0,n.jsx)(t.code,{children:"samba_preg"})," objects based on the ",(0,n.jsx)(t.code,{children:"startswith"})," parameter. Specifically, the ",(0,n.jsx)(t.code,{children:"hive_key"})," attribute of each ",(0,n.jsx)(t.code,{children:"samba_preg"})," object is compared with the ",(0,n.jsx)(t.code,{children:"startswith"})," parameter using the ",(0,n.jsx)(t.code,{children:"like"})," operator, which performs a prefix match."]}),"\n",(0,n.jsxs)(t.p,{children:["Finally, the ",(0,n.jsx)(t.code,{children:"all"})," method is called on the filtered query object to execute the query and return a list of ",(0,n.jsx)(t.code,{children:"samba_preg"})," objects that match the ",(0,n.jsx)(t.code,{children:"startswith"})," parameter."]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," function is used in various parts of the project to filter the HKLM entries based on a given prefix string. For example, it is used in the ",(0,n.jsx)(t.code,{children:"control_applier"}),", ",(0,n.jsx)(t.code,{children:"firewall_applier"}),", ",(0,n.jsx)(t.code,{children:"kde_applier"}),", ",(0,n.jsx)(t.code,{children:"package_applier"}),", ",(0,n.jsx)(t.code,{children:"polkit_applier"}),", and ",(0,n.jsx)(t.code,{children:"yandex_browser_applier"})," modules to filter the HKLM entries that correspond to the respective policies or settings."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nThe ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," function is an internal method of the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class and should not be used outside of it."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Output Example"}),":\nHere's an example of how to use the ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," method in the ",(0,n.jsx)(t.code,{children:"sqlite_registry"})," class:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"registry = sqlite_registry('my_database')\nhklm_entries = registry.filter_hklm_entries('Software\\\\Microsoft')\nfor entry in hklm_entries:\n    print(entry.hive_key)\n"})}),"\n",(0,n.jsxs)(t.p,{children:["In this example, the ",(0,n.jsx)(t.code,{children:"filter_hklm_entries"})," method is called with the prefix string ",(0,n.jsx)(t.code,{children:"'Software\\\\Microsoft'"}),", which filters the HKLM entries that have a ",(0,n.jsx)(t.code,{children:"hive_key"})," attribute that starts with ",(0,n.jsx)(t.code,{children:"'Software\\Microsoft'"}),". The method returns a list of ",(0,n.jsx)(t.code,{children:"samba_preg"})," objects that match the prefix string, which are then printed to the console."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-wipe_userself-sid",children:"FunctionDef wipe_user(self, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"wipe_user"}),": The function of wipe_user is to delete all records associated with a given user from the SQLite database."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 sid: The security identifier (SID) of the user to wipe."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe wipe_user method takes a SID as an argument and deletes all records associated with that user from the SQLite database. It does this by calling the wipe_user method of the sqlite_registry object, which in turn calls the wipe_user method of each record type object (drive_entry, script_entry, file_entry, ini_entry, and networkshare_entry). Each record type object then deletes all records with the given SID from its respective table in the database."]}),"\n",(0,n.jsx)(t.p,{children:"The wipe_user method is called by the wipe_user method of the sqlite_registry object, which is in turn called by the wipe_user method of the backend object. The backend object calls the wipe_user method of the appropriate backend object (nodomain_backend or samba_backend) based on the type of user (machine or user)."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The wipe_user method should only be called by the wipe_user method of the sqlite_registry object."}),"\n",(0,n.jsx)(t.li,{children:"The wipe_user method should only be called after all records have been retrieved and stored in the database."}),"\n",(0,n.jsx)(t.li,{children:"The wipe_user method should not be called if the user has not been authenticated."}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-_wipe_sidself-row_object-sid",children:"FunctionDef _wipe_sid(self, row_object, sid)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"_wipe_sid"}),": The function of ",(0,n.jsx)(t.code,{children:"_wipe_sid"})," is to delete a specified SID (Security Identifier) from a specific database table."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,n.jsx)(t.code,{children:"row_object"}),": The database table object to be operated.\n\xb7 ",(0,n.jsx)(t.code,{children:"sid"}),": The Security Identifier (SID) to be deleted."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe function ",(0,n.jsx)(t.code,{children:"_wipe_sid"})," first accesses the database session via the ",(0,n.jsx)(t.code,{children:"db_session"})," attribute of the class instance (",(0,n.jsx)(t.code,{children:"self.db_session"}),"). Then, it constructs a query to filter the rows in the ",(0,n.jsx)(t.code,{children:"row_object"})," table that have the specified ",(0,n.jsx)(t.code,{children:"sid"}),". Finally, it deletes the filtered rows and commits the transaction to the database."]}),"\n",(0,n.jsxs)(t.p,{children:["This function is designed to be a private method, indicated by the single underscore prefix ",(0,n.jsx)(t.code,{children:"_"}),", which is not intended to be called directly from outside the class. It is used as a helper method for other public methods in the class, such as ",(0,n.jsx)(t.code,{children:"wipe_user"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"row_object"})," parameter should be a SQLAlchemy query object that represents a database table."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"sid"}),' parameter should be a string or bytes object representing a SID in the format of "S-1-5-21-...".']}),"\n",(0,n.jsxs)(t.li,{children:["The function will delete all rows with the specified ",(0,n.jsx)(t.code,{children:"sid"})," in the ",(0,n.jsx)(t.code,{children:"row_object"})," table. Be cautious when using this function, as it will permanently remove data from the database."]}),"\n",(0,n.jsxs)(t.li,{children:["The function automatically commits the transaction to the database after deleting the rows. Therefore, there is no need to call ",(0,n.jsx)(t.code,{children:"commit()"})," again after calling this function."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["In the project, ",(0,n.jsx)(t.code,{children:"_wipe_sid"})," is called by the ",(0,n.jsx)(t.code,{children:"wipe_user"})," method to delete a specified SID from multiple database tables related to user management. By calling ",(0,n.jsx)(t.code,{children:"_wipe_sid"})," repeatedly with different table objects, ",(0,n.jsx)(t.code,{children:"wipe_user"})," ensures that the SID is removed consistently across all related tables."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"functiondef-wipe_hklmself",children:"FunctionDef wipe_hklm(self)"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"wipe_hklm"}),": The function of wipe_hklm is to delete all records in the HKLM (HKEY_LOCAL_MACHINE) table of the SQLite database used in the project."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"parameters"}),": This function does not take any parameters."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Code Description"}),":\nThe wipe_hklm function is a method of the sqlite_registry class, which is defined in the gpoa/storage/sqlite_registry.py file. It performs a delete query on all records of the samba_preg objects in the HKLM table of the SQLite database using the db_session object. After performing the delete operation, it calls the commit() method to save the changes to the database."]}),"\n",(0,n.jsx)(t.p,{children:"The samba_preg objects in the HKLM table represent the entries in the Windows registry's HKLM hive. By deleting all records in the HKLM table, the function effectively wipes out all the entries in the HKLM hive of the Windows registry."}),"\n",(0,n.jsx)(t.p,{children:"The wipe_hklm function is called by the retrieve_and_store method of the nodomain_backend and samba_backend classes, which are defined in the gpoa/backend/nodomain_backend.py and gpoa/backend/samba_backend.py files, respectively. These classes are responsible for retrieving settings and storing them in the database."}),"\n",(0,n.jsx)(t.p,{children:"In the retrieve_and_store method of the nodomain_backend class, the wipe_hklm function is called to delete all records in the HKLM table before storing new settings. In the retrieve_and_store method of the samba_backend class, the wipe_hklm function is called to delete all records in the HKLM table before storing new settings if the machine_username is set to True."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note"}),":\nThe wipe_hklm function is an internal method of the sqlite_registry class and should not be called outside of it. It is recommended to use the provided methods of the nodomain_backend and samba_backend classes to interact with the SQLite database."]}),"\n",(0,n.jsx)(t.p,{children:"Here's an example of how to use the wipe_hklm function in the retrieve_and_store method of the nodomain_backend class:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"registry = sqlite_registry('my_database')\nregistry.wipe_hklm()\n"})}),"\n",(0,n.jsx)(t.p,{children:"In this example, the wipe_hklm function is called on an instance of the sqlite_registry class, which is initialized with the name of the SQLite database. The function deletes all records in the HKLM table of the database."}),"\n",(0,n.jsx)(t.hr,{})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>d,x:()=>o});var n=i(6540);const s={},r=n.createContext(s);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);