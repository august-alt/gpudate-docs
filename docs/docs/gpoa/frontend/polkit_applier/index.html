<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gpoa/frontend/polkit_applier" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">polkit_applier | GPUpdate Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://august-alt.github.io/gpupdate-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://august-alt.github.io/gpupdate-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://august-alt.github.io/gpupdate-docs/docs/gpoa/frontend/polkit_applier"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="polkit_applier | GPUpdate Docs"><meta data-rh="true" name="description" content="ClassDef polkit_applier"><meta data-rh="true" property="og:description" content="ClassDef polkit_applier"><link data-rh="true" rel="icon" href="/gpupdate-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/frontend/polkit_applier"><link data-rh="true" rel="alternate" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/frontend/polkit_applier" hreflang="en"><link data-rh="true" rel="alternate" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/frontend/polkit_applier" hreflang="x-default"><link rel="stylesheet" href="/gpupdate-docs/assets/css/styles.d27c289a.css">
<script src="/gpupdate-docs/assets/js/runtime~main.9c9ca5ac.js" defer="defer"></script>
<script src="/gpupdate-docs/assets/js/main.77502ab4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/gpupdate-docs/"><div class="navbar__logo"><img src="/gpupdate-docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/gpupdate-docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GPUpdate Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/gpupdate-docs/docs/gpoa/backend/applier_backend">gpoa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/backend/applier_backend">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/applier_frontend">frontend</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/applier_frontend">applier_frontend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/appliers/control">appliers</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/chromium_applier">chromium_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/cifs_applier">cifs_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/control_applier">control_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/cups_applier">cups_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/envvar_applier">envvar_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/file_applier">file_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/firefox_applier">firefox_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/firewall_applier">firewall_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/folder_applier">folder_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/frontend_manager">frontend_manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/gsettings_applier">gsettings_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/ini_applier">ini_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/kde_applier">kde_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/networkshare_applier">networkshare_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/ntp_applier">ntp_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/package_applier">package_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/polkit_applier">polkit_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/scripts_applier">scripts_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/shortcut_applier">shortcut_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/systemd_applier">systemd_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/yandex_browser_applier">yandex_browser_applier</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/">gpt</a><button aria-label="Expand sidebar category &#x27;gpt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/plugin/">plugin</a><button aria-label="Expand sidebar category &#x27;plugin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/storage/cache">storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/test/frontend/appliers/test_controls">test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/util/">util</a><button aria-label="Expand sidebar category &#x27;util&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/gpupdate-docs/docs/tools/parsing_chrom_admx_intvalues">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/gpupdate-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">gpoa</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">frontend</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">polkit_applier</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>polkit_applier</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-polkit_applier">ClassDef polkit_applier<a href="#classdef-polkit_applier" class="hash-link" aria-label="Direct link to ClassDef polkit_applier" title="Direct link to ClassDef polkit_applier">​</a></h2>
<p><strong>polkit_applier</strong>: The <code>polkit_applier</code> class is a subclass of <code>applier_frontend</code> and is responsible for applying policies related to polkit, a component providing fine-grained access control for desktop applications through a centralized framework.</p>
<p><strong>Attributes</strong>:
· <code>storage</code>: An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.</p>
<p><strong>Code Description</strong>:
The <code>polkit_applier</code> class initializes the storage attribute and sets the <code>__module_enabled</code> attribute based on the result of a call to <code>check_enabled()</code>. The <code>check_enabled()</code> method checks whether the current module is enabled in the gpoa configuration, and returns True if it is, and False otherwise.</p>
<p>The class then initializes several variables related to polkit policies, such as <code>polkit_keys</code>, <code>polkit_locks</code>, and <code>deny_all_win</code>. It also creates a dictionary <code>dict_lists_rules</code> to store the policy rules for polkit.</p>
<p>The class then iterates through the <code>polkit_keys</code> and <code>polkit_locks</code> and populates the <code>dict_lists_rules</code> dictionary based on the values of the keys. It then updates the <code>__polkit_map</code> dictionary with the populated <code>dict_lists_rules</code> dictionary.</p>
<p>If the <code>deny_all_win</code> variable is not None, it logs the value of <code>deny_all_win.data</code> and updates the <code>__polkit_map</code> dictionary with the value of <code>deny_all_win.data</code>.</p>
<p>Finally, it creates a list of <code>polkit</code> objects, <code>self.policies</code>, and sets the <code>__module_enabled</code> attribute based on the result of a call to <code>check_enabled()</code>.</p>
<p>The <code>apply()</code> method of the class checks whether the <code>__module_enabled</code> attribute is True and, if so, iterates through the <code>self.policies</code> list and calls the <code>generate()</code> method of each <code>polkit</code> object.</p>
<p><strong>Note</strong>:
The <code>polkit_applier</code> class is intended to be used as a part of the gpoa project for applying polkit policies. It should be used in conjunction with the other classes and modules of the project.</p>
<p>The <code>polkit_applier</code> class is called by the <code>_init_machine_appliers</code> method of the <code>frontend_manager</code> class, which initializes the machine_appliers dictionary with an instance of the <code>polkit_applier</code> class.</p>
<p>It is important to note that the <code>polkit_applier</code> class is a part of the gpoa project and is intended to be used in the context of that project. It relies on other classes and modules of the project, such as the <code>applier_frontend</code> class and the <code>check_enabled()</code> method. It also relies on the <code>polkit</code> class and the <code>storage</code> class, which are not defined in the provided code snippet.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-storage">FunctionDef <strong>init</strong>(self, storage)<a href="#functiondef-initself-storage" class="hash-link" aria-label="Direct link to functiondef-initself-storage" title="Direct link to functiondef-initself-storage">​</a></h3>
<p><strong><code>__init__</code></strong>: The function of <code>__init__</code> is to initialize the <code>polkit_applier</code> object with a <code>storage</code> object.</p>
<p><strong>parameters</strong>:
· <code>storage</code>: An object of the <code>sqlite_registry</code> class, which provides an interface to access the SQLite database.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the <code>polkit_applier</code> object by setting the <code>storage</code> attribute to the <code>storage</code> parameter. It also initializes several variables to <code>None</code>: <code>deny_all_win</code>, <code>polkit_filter</code>, <code>polkit_locks_filter</code>, <code>polkit_keys</code>, <code>polkit_locks</code>, <code>locks</code>, <code>dict_lists_rules</code>, and <code>template_file</code>, <code>template_vars</code>, <code>template_file_all</code>, <code>template_vars_all</code>, <code>template_file_all_lock</code>, <code>template_vars_all_lock</code>.</p>
<p>The method then calls the <code>check_windows_mapping_enabled</code> function to determine if the Windows mapping feature is enabled or not. If it is enabled, the method calls the <code>storage.filter_hklm_entries</code> method to filter the HKLM entries based on the <code>self.__deny_all_win</code> prefix. It then gets the first entry from the result and assigns it to the <code>deny_all_win</code> variable.</p>
<p>Next, the method initializes several variables related to Polkit filters and templates. It uses the <code>self.__polkit_map</code> dictionary to get the template file and variables for the <code>self.__registry_branch</code>, <code>self.__registry_locks_branch</code>, and <code>self.__deny_all_win</code> keys. It also initializes a <code>locks</code> list and a <code>dict_lists_rules</code> dictionary.</p>
<p>The method then iterates over the <code>self.polkit_keys</code> list and checks if the data attribute of each entry is equal to <code>&#x27;Yes&#x27;</code>, <code>&#x27;No&#x27;</code>, <code>&#x27;Auth_self&#x27;</code>, <code>&#x27;Auth_admin&#x27;</code>, <code>&#x27;Auth_self_keep&#x27;</code>, or <code>&#x27;Auth_admin_keep&#x27;</code>. If the data attribute is not in this list, the method skips the entry. If it is, the method adds the valuename attribute of the entry to the corresponding list in the <code>dict_lists_rules</code> dictionary.</p>
<p>Finally, the method sets the <code>self.__module_enabled</code> attribute to the result of the <code>check_enabled</code> function, which takes the <code>storage</code>, <code>self.__module_name</code>, and <code>self.__module_experimental</code> parameters.</p>
<p>The <code>__init__</code> method is called when a new <code>polkit_applier</code> object is created. It initializes the object with the necessary attributes and variables, and sets up the Polkit filters and templates based on the <code>self.__polkit_map</code> dictionary. It also determines if the Windows mapping feature is enabled or not, and filters the HKLM entries based on the <code>self.__deny_all_win</code> prefix if it is enabled.</p>
<p><strong>Relationship with Callers</strong>:
The <code>__init__</code> method is called by the <code>polkit_applier</code> class to initialize a new <code>polkit_applier</code> object. It is called when the <code>polkit_applier</code> object is created, and is responsible for setting up the necessary attributes and variables for the object.</p>
<p><strong>Note</strong>:
The <code>__init__</code> method is an internal method of the <code>polkit_applier</code> class and should not be called directly. It is used to initialize the <code>polkit_applier</code> object with the necessary attributes and variables, and should only be called when creating a new <code>polkit_applier</code> object.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-applyself">FunctionDef apply(self)<a href="#functiondef-applyself" class="hash-link" aria-label="Direct link to FunctionDef apply(self)" title="Direct link to FunctionDef apply(self)">​</a></h3>
<p><strong>apply</strong>: The function of apply is to trigger control facility invocation.</p>
<p><strong>parameters</strong>:</p>
<p>· <code>self</code>: The instance of the <code>polkit_applier</code> class.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-polkit_applier_user">ClassDef polkit_applier_user<a href="#classdef-polkit_applier_user" class="hash-link" aria-label="Direct link to ClassDef polkit_applier_user" title="Direct link to ClassDef polkit_applier_user">​</a></h2>
<p><strong>polkit_applier_user</strong>: The function of polkit_applier_user is to handle the application of policies related to polkit for a specific user. It is a subclass of applier_frontend and is intended to be used in the context of the gpoa project.</p>
<p><strong>attributes</strong>:
· storage: An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.
· sid: The security identifier (SID) of the user or machine for which policies are being applied.
· username: The username for which policies are being applied, if applicable.</p>
<p><strong>Code Description</strong>:
The polkit_applier_user class is a subclass of applier_frontend and is used to handle the application of policies related to polkit for a specific user. It initializes the storage, sid, and username attributes in its constructor, and sets the __module_enabled__ attribute based on the result of a call to check_enabled().</p>
<p>The class contains a number of class variables that are used to map policy keys to their corresponding values. These mappings are used to initialize the policy objects in the constructor.</p>
<p>The constructor also initializes a number of policy objects using the policy keys and values obtained from the storage object. These policy objects are stored in the policies list and are used to apply the policies in the user and admin contexts.</p>
<p>The user_context_apply() method is intended to be overridden by subclasses to provide the logic for applying policies in the user context, and the admin_context_apply() method is intended to be overridden by subclasses to provide the logic for applying policies in the admin context. These methods are called by the gpoa application depending on the context in which policies are being applied.</p>
<p>The __module_name__, __module_experimental__, and __module_enabled__ attributes are used by the gpoa application to determine whether the current module should be loaded and applied.</p>
<p>The polkit_applier_user class is used by the frontend_manager to initialize the user appliers dictionary in the _init_user_appliers() method. This allows the gpoa application to apply policies related to polkit for a specific user.</p>
<p><strong>Note</strong>:
The polkit_applier_user class is intended to be used as a subclass by other modules that apply policies in the gpoa project. Subclasses should override the user_context_apply() and admin_context_apply() methods to provide the logic for applying policies in the user and admin contexts, respectively. Subclasses should also set the __module_name__, __module_experimental__, and __module_enabled__ attributes appropriately.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-storage-sid-username">FunctionDef <strong>init</strong>(self, storage, sid, username)<a href="#functiondef-initself-storage-sid-username" class="hash-link" aria-label="Direct link to functiondef-initself-storage-sid-username" title="Direct link to functiondef-initself-storage-sid-username">​</a></h3>
<p><strong><code>__init__</code></strong>: The function of <code>__init__</code> is to initialize the <code>polkit_applier_user</code> object with the required parameters.</p>
<p><strong>parameters</strong>:
· <code>storage</code>: An instance of the <code>sqlite_registry</code> class that provides access to the SQLite registry database.
· <code>sid</code>: A string representing the security identifier (SID) of the user.
· <code>username</code>: A string representing the username associated with the SID.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes several attributes of the <code>polkit_applier_user</code> class. First, it sets the <code>storage</code>, <code>sid</code>, and <code>username</code> attributes using the provided parameters. Then, it initializes the <code>deny_all_win</code> attribute to <code>None</code>.</p>
<p>The method then checks if the <code>check_windows_mapping_enabled</code> function returns <code>True</code> for the provided <code>storage</code>. If it does, the method sets the <code>deny_all_win</code> attribute to the result of filtering the registry entries in the HKCU hive with the SID and a specific string pattern.</p>
<p>Next, the method sets the <code>polkit_filter</code> attribute to a string that represents the beginning part of the hive key to filter the entries. It then filters the registry entries in the HKCU hive with the SID and the <code>polkit_filter</code> string pattern, and sets the <code>polkit_keys</code> attribute to the result.</p>
<p>The method then initializes the <code>template_file</code>, <code>template_vars</code>, <code>template_file_all</code>, and <code>template_vars_all</code> attributes using the <code>__polkit_map</code> dictionary and the <code>sid</code> and <code>username</code> attributes.</p>
<p>Finally, the method initializes the <code>dict_lists_rules</code> dictionary with several empty lists, and sets the <code>User</code> key of the <code>template_vars</code> dictionary to the <code>username</code> attribute. It then iterates over the <code>polkit_keys</code> attribute and populates the <code>dict_lists_rules</code> dictionary with the data and value names of the registry entries.</p>
<p>If the <code>deny_all_win</code> attribute is not <code>None</code>, the method logs data about the <code>Deny_All_win</code> and <code>User</code> attributes. Otherwise, it logs a simple message.</p>
<p>The <code>__init__</code> method is called when a new <code>polkit_applier_user</code> object is created. It sets up the object&#x27;s attributes with the required parameters and initializes several variables that are used throughout the object&#x27;s methods.</p>
<p><strong>Relationship with Callers</strong>:
The <code>__init__</code> method is called by the <code>polkit_applier</code> class when it creates a new <code>polkit_applier_user</code> object for each user in the SQLite registry database.</p>
<p><strong>Note</strong>:
The <code>__init__</code> method initializes several attributes that are used throughout the <code>polkit_applier_user</code> object&#x27;s methods. It is important to provide the correct parameters when creating a new <code>polkit_applier_user</code> object to ensure that the object functions correctly.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-user_context_applyself">FunctionDef user_context_apply(self)<a href="#functiondef-user_context_applyself" class="hash-link" aria-label="Direct link to FunctionDef user_context_apply(self)" title="Direct link to FunctionDef user_context_apply(self)">​</a></h3>
<p><strong>user_context_apply</strong>: The function of user_context_apply is to apply the user context.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:
The user_context_apply function is a method of the polkit_applier_user class, which is defined in the polkit_applier.py module. This function does not contain any code implementation, as indicated by the pass statement. Its purpose is to serve as a placeholder for future implementation.</p>
<p>When this function is called, it will not perform any actions. However, since it is a part of the polkit_applier_user class, it is likely that it will be used to apply a user context in a Polkit-related operation.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>This function does not take any parameters, so there is no need to pass any arguments when calling this function.</li>
<li>Since this function is a placeholder, it is not currently functional. It should be implemented with the necessary code to apply the user context as intended.</li>
<li>It is important to ensure that the user context is applied correctly to avoid any security vulnerabilities or unintended behavior.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-admin_context_applyself">FunctionDef admin_context_apply(self)<a href="#functiondef-admin_context_applyself" class="hash-link" aria-label="Direct link to FunctionDef admin_context_apply(self)" title="Direct link to FunctionDef admin_context_apply(self)">​</a></h3>
<p><strong>admin_context_apply</strong>: The function of <code>admin_context_apply</code> is to trigger control facility invocation if the <code>module_enabled</code> attribute of the <code>polkit_applier_user</code> object is set to True.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:</p>
<p>The <code>admin_context_apply</code> function first checks if the <code>module_enabled</code> attribute of the <code>polkit_applier_user</code> object is set to True by calling the <code>__module_enabled</code> attribute. If it is True, it logs a message &#x27;D74&#x27; using the <code>log</code> function from the <code>logging</code> module.</p>
<p>Then, it iterates over the <code>policies</code> list of the <code>polkit_applier_user</code> object and calls the <code>generate</code> function of each <code>policy</code> object in the list. The <code>generate</code> function is defined in the <code>polkit</code> module and is responsible for rendering and writing a policy template to a file if the <code>args</code> attribute of the <code>polkit</code> object is not empty.</p>
<p>If the <code>module_enabled</code> attribute is not set to True, it logs a message &#x27;D76&#x27; using the <code>log</code> function.</p>
<p>The <code>log</code> function is defined in the <code>logging</code> module and logs messages with different levels (debug, info, warning, error, fatal) based on the message code.</p>
<p>The <code>polkit</code> module is responsible for generating policy files based on the provided arguments and template files. The <code>polkit_applier</code> module is responsible for applying the generated policy files to the system.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>admin_context_apply</code> function assumes that the <code>policies</code> list of the <code>polkit_applier_user</code> object is not empty and contains valid <code>polkit</code> object instances.</li>
<li>The <code>admin_context_apply</code> function does not check if the <code>generate</code> function of each <code>policy</code> object is successful or not. If the <code>generate</code> function of any <code>policy</code> object fails, the exception will be caught and logged by the <code>log</code> function.</li>
<li>The <code>admin_context_apply</code> function logs messages with different levels (debug, info, warning, error, fatal) using the <code>log</code> function. It is recommended to use the appropriate message level based on the importance and urgency of the message.</li>
<li>The <code>admin_context_apply</code> function is called by the <code>apply</code> function of the <code>polkit_applier</code> class, which is responsible for triggering the control facility invocation.</li>
</ul>
<hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/gpupdate-docs/docs/gpoa/frontend/package_applier"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">package_applier</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/gpupdate-docs/docs/gpoa/frontend/scripts_applier"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">scripts_applier</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#classdef-polkit_applier" class="table-of-contents__link toc-highlight">ClassDef polkit_applier</a><ul><li><a href="#functiondef-initself-storage" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, storage)</a></li><li><a href="#functiondef-applyself" class="table-of-contents__link toc-highlight">FunctionDef apply(self)</a></li></ul></li><li><a href="#classdef-polkit_applier_user" class="table-of-contents__link toc-highlight">ClassDef polkit_applier_user</a><ul><li><a href="#functiondef-initself-storage-sid-username" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, storage, sid, username)</a></li><li><a href="#functiondef-user_context_applyself" class="table-of-contents__link toc-highlight">FunctionDef user_context_apply(self)</a></li><li><a href="#functiondef-admin_context_applyself" class="table-of-contents__link toc-highlight">FunctionDef admin_context_apply(self)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/gpupdate-docs/docs/gpoa/backend/samba_backend">Samba Backend</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 BaseALT LTD, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>