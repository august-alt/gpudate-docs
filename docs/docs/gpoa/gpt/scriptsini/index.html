<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gpoa/gpt/scriptsini" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">scriptsini | GPUpdate Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://august-alt.github.io/gpupdate-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://august-alt.github.io/gpupdate-docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://august-alt.github.io/gpupdate-docs/docs/gpoa/gpt/scriptsini"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="scriptsini | GPUpdate Docs"><meta data-rh="true" name="description" content="FunctionDef readscripts(scriptsfile)"><meta data-rh="true" property="og:description" content="FunctionDef readscripts(scriptsfile)"><link data-rh="true" rel="icon" href="/gpupdate-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/gpt/scriptsini"><link data-rh="true" rel="alternate" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/gpt/scriptsini" hreflang="en"><link data-rh="true" rel="alternate" href="https://august-alt.github.io/gpupdate-docs/docs/gpoa/gpt/scriptsini" hreflang="x-default"><link rel="stylesheet" href="/gpupdate-docs/assets/css/styles.d27c289a.css">
<script src="/gpupdate-docs/assets/js/runtime~main.9c9ca5ac.js" defer="defer"></script>
<script src="/gpupdate-docs/assets/js/main.77502ab4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/gpupdate-docs/"><div class="navbar__logo"><img src="/gpupdate-docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/gpupdate-docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GPUpdate Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/gpupdate-docs/docs/gpoa/backend/applier_backend">gpoa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/backend/applier_backend">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/frontend/applier_frontend">frontend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/">gpt</a><button aria-label="Collapse sidebar category &#x27;gpt&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/drives">drives</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/envvars">envvars</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/files">files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/folders">folders</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/inifiles">inifiles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/networkshares">networkshares</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/polfile">polfile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/printers">printers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/scriptsini">scriptsini</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/services">services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/shortcuts">shortcuts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/gpupdate-docs/docs/gpoa/gpt/tasks">tasks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/plugin/">plugin</a><button aria-label="Expand sidebar category &#x27;plugin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/storage/cache">storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/test/frontend/appliers/test_controls">test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/gpupdate-docs/docs/gpoa/util/">util</a><button aria-label="Expand sidebar category &#x27;util&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/gpupdate-docs/docs/tools/parsing_chrom_admx_intvalues">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/gpupdate-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">gpoa</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/gpupdate-docs/docs/gpoa/gpt/"><span itemprop="name">gpt</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">scriptsini</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>scriptsini</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-read_scriptsscripts_file">FunctionDef read_scripts(scripts_file)<a href="#functiondef-read_scriptsscripts_file" class="hash-link" aria-label="Direct link to FunctionDef read_scripts(scripts_file)" title="Direct link to FunctionDef read_scripts(scripts_file)">​</a></h2>
<p><strong>read_scripts</strong>: The function of read_scripts is to read a scripts file and populate a Scripts_lists object with Script objects based on the contents of the file.</p>
<p><strong>parameters</strong>:
· scripts_file: A string representing the file path of the scripts file to be read.</p>
<p><strong>Code Description</strong>:
The read_scripts function takes a single parameter, scripts_file, which is the file path of the scripts file to be read. It first creates an instance of the Scripts_lists class, which will manage and store the Script objects created from the scripts file.</p>
<p>Next, it initializes four empty dictionaries to store the logon, logoff, startup, and shutdown scripts, respectively. These dictionaries will be populated with Script objects as the function reads the scripts file.</p>
<p>The function then reads the scripts file using a ConfigParser object and iterates through the sections and keys to create Script objects based on the action type and script filename. The script objects are then added to the corresponding action dictionary (logon, logoff, startup, or shutdown) based on their action type.</p>
<p>Finally, the function returns the Scripts_lists object, which now contains the Script objects created from the scripts file.</p>
<p>The read_scripts function is called by the pref_parsers function in the gpoa/gpt/gpt.py/pref_parsers module. The pref_parsers function creates a dictionary of parser functions for different types of files, and read_scripts is the parser function for scripts files.</p>
<p>The read_scripts function is responsible for creating Script objects based on the contents of a scripts file, and it is a crucial part of the project as it allows scripts to be added to the appropriate lists based on the action. This is important for managing and executing scripts based on the action.</p>
<p><strong>Note</strong>:
It is important to note that the scripts file should be a valid file path to ensure that the function can read the file. If an invalid file path is passed, the function will not be able to create any Script objects and will return an empty Scripts_lists object.</p>
<p>Additionally, the scripts file should be formatted correctly with the appropriate sections and keys for each script. If the scripts file is not formatted correctly, the function may not be able to create the correct Script objects and may return an incomplete Scripts_lists object.</p>
<p>The following is an example of how the read_scripts function may be called:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scripts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> read_scripts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/path/to/scripts/file&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the read_scripts function is called with the file path of the scripts file as a parameter. The function will read the scripts file and return a Scripts_lists object containing the Script objects created from the file.</p>
<p><strong>Output Example</strong>:
Here is an example of the output of the read_scripts function:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Scripts_lists </span><span class="token builtin">object</span><span class="token plain"> containing the following Script objects</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Logon Script </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">logon</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">directory</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Logon Script </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">logon</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">directory</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Logoff Script </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">logoff</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">directory</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Startup Script </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">startup</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">directory</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Shutdown Script </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">path</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">shutdown</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">directory</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the Scripts_lists object contains five Script objects, each representing a different script based on the action type. The Script objects contain the action type, file path, and arguments for each script.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-merge_scriptsstorage-sid-scripts_objects-policy_name">FunctionDef merge_scripts(storage, sid, scripts_objects, policy_name)<a href="#functiondef-merge_scriptsstorage-sid-scripts_objects-policy_name" class="hash-link" aria-label="Direct link to FunctionDef merge_scripts(storage, sid, scripts_objects, policy_name)" title="Direct link to FunctionDef merge_scripts(storage, sid, scripts_objects, policy_name)">​</a></h2>
<p><strong>merge_scripts</strong>: The function of merge_scripts is to merge scripts from different policies into a single storage object.</p>
<p><strong>parameters</strong>:
· <code>storage</code>: The storage object where the merged scripts will be added.
· <code>sid</code>: The unique identifier for the policy.
· <code>scripts_objects</code>: The object containing the scripts to be merged.
· <code>policy_name</code>: The name of the policy.</p>
<p><strong>Code Description</strong>:
The function iterates over the logon, logoff, startup, and shutdown scripts in the <code>scripts_objects</code> object and adds each script to the <code>storage</code> object using the <code>add_script</code> method. The <code>sid</code> and <code>policy_name</code> are passed as arguments to the <code>add_script</code> method for each script added.</p>
<p>This function is used in the <code>pref_mergers</code> object in <code>gpoa/gpt/gpt.py</code> to merge scripts for different file types. It is called with the <code>merge_scripts</code> parameter set to the <code>merge_scripts</code> function, allowing it to merge scripts for the <code>FileType.SCRIPTS</code> file type.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>scripts_objects</code> parameter should be an object containing logon, logoff, startup, and shutdown scripts.</li>
<li>The <code>storage</code> parameter should be a storage object that supports the <code>add_script</code> method.</li>
<li>The <code>sid</code> and <code>policy_name</code> parameters should be unique identifiers and names for the policy being merged.</li>
<li>The function does not validate the input parameters, so it is the responsibility of the caller to ensure that the parameters are valid.</li>
<li>The function assumes that the <code>scripts_objects</code> parameter contains the necessary scripts, and does not handle cases where scripts are missing or invalid.</li>
<li>The function does not return a value, and the merged scripts can only be accessed through the <code>storage</code> parameter.</li>
<li>The function is not thread-safe and should not be called concurrently with the same <code>storage</code> parameter.</li>
<li>The function may raise exceptions if the <code>add_script</code> method raises exceptions or if the input parameters are invalid. It is the responsibility of the caller to handle these exceptions.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-scripts_lists">ClassDef Scripts_lists<a href="#classdef-scripts_lists" class="hash-link" aria-label="Direct link to ClassDef Scripts_lists" title="Direct link to ClassDef Scripts_lists">​</a></h2>
<p><strong>Scripts_lists</strong>: The function of Scripts_lists is to manage and store lists of scripts for different system actions such as logon, logoff, startup, and shutdown.</p>
<p><strong>Attributes</strong>:
· <code>__logon_scripts</code>: A list to store the logon scripts.
· <code>__logoff_scripts</code>: A list to store the logoff scripts.
· <code>__startup_scripts</code>: A list to store the startup scripts.
· <code>__shutdown_scripts</code>: A list to store the shutdown scripts.</p>
<p><strong>Code Description</strong>:
The Scripts_lists class is initialized with four empty lists to manage scripts for different system actions. The class provides methods to get these lists and add scripts to them. The <code>add_script</code> method takes two parameters: <code>action</code> and <code>script</code>. The <code>action</code> parameter determines which list to add the <code>script</code> to, based on the value of <code>action</code> (LOGON, LOGOFF, STARTUP, or SHUTDOWN).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself">FunctionDef <strong>init</strong>(self)<a href="#functiondef-initself" class="hash-link" aria-label="Direct link to functiondef-initself" title="Direct link to functiondef-initself">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the Scripts_lists class and create empty lists for storing logon, logoff, startup, and shutdown scripts.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:</p>
<p>The __init__ function is a special method in Python classes, called when an object is created from the class. It is used to initialize the attributes of the class.</p>
<p>In this specific __init__ function, four empty lists are created as attributes of the Scripts_lists class:</p>
<ol>
<li>__logon_scripts: This list will store logon scripts.</li>
<li>__logoff_scripts: This list will store logoff scripts.</li>
<li>__startup_scripts: This list will store startup scripts.</li>
<li>__shutdown_scripts: This list will store shutdown scripts.</li>
</ol>
<p>These lists will be used to manage and organize different types of scripts within the application.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The __init__ function is automatically called when a new object is created from the Scripts_lists class.</li>
<li>Make sure to use self when referring to these lists within other methods of the Scripts_lists class.</li>
<li>The purpose of these lists is to manage and organize different types of scripts, so ensure that scripts are added to the appropriate list when working with the class.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_logon_scriptsself">FunctionDef get_logon_scripts(self)<a href="#functiondef-get_logon_scriptsself" class="hash-link" aria-label="Direct link to FunctionDef get_logon_scripts(self)" title="Direct link to FunctionDef get_logon_scripts(self)">​</a></h3>
<p><strong>get_logon_scripts</strong>: The function of get_logon_scripts is to return the list of logon scripts.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The get_logon_scripts function is a simple method that returns the logon scripts list stored in the object&#x27;s attribute <code>__logon_scripts</code>. This method does not contain any logic or computation, and its sole purpose is to provide access to the logon scripts list.</p>
<p>The <code>self</code> parameter in the function signature represents the instance of the object that the method is called on. Since this is an instance method, it can only be called on an object of the class that defines it.</p>
<p>The <code>return</code> statement returns the <code>__logon_scripts</code> attribute of the object, which is a list of logon scripts added using the <code>add_script</code> method.</p>
<p>From a functional perspective, <code>get_logon_scripts</code> plays a crucial role in the project by providing access to the logon scripts list. This list can be used by other parts of the program to perform actions on the logon scripts, such as executing them or modifying them.</p>
<p><strong>Note</strong>: It is important to note that the <code>get_logon_scripts</code> method returns a reference to the <code>__logon_scripts</code> list, not a copy. Therefore, any modifications made to the list using the <code>add_script</code> method will be reflected in the list returned by <code>get_logon_scripts</code>.</p>
<p><strong>Output Example</strong>:</p>
<p>Assuming that the <code>__logon_scripts</code> attribute contains the following values:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script3.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>get_logon_scripts</code> method will return the same list:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script3.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This list can then be used by other parts of the program to perform actions on the logon scripts.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_logoff_scriptsself">FunctionDef get_logoff_scripts(self)<a href="#functiondef-get_logoff_scriptsself" class="hash-link" aria-label="Direct link to FunctionDef get_logoff_scripts(self)" title="Direct link to FunctionDef get_logoff_scripts(self)">​</a></h3>
<p><strong>get_logoff_scripts</strong>: This function is used to retrieve the list of logoff scripts.</p>
<p><strong>Parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The function returns the <code>__logoff_scripts</code> attribute of the object. This attribute is expected to be a list containing all the logoff scripts added using the <code>add_script</code> function.</p>
<p><strong>Relationship with its callers in the project</strong>: This function is used in the <code>add_script</code> function of the <code>gpoa/gpt/scriptsini.py/Scripts_lists/add_script</code> object to add scripts to the appropriate list based on the action. When the action is &#x27;LOGOFF&#x27;, the script is added to the <code>__logoff_scripts</code> list, which can be retrieved using the <code>get_logoff_scripts</code> function.</p>
<p><strong>Note</strong>: The <code>get_logoff_scripts</code> function does not add scripts to the list. It only retrieves the list. To add scripts, use the <code>add_script</code> function with the &#x27;LOGOFF&#x27; action.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script3.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the <code>get_logoff_scripts</code> function would return a list of three logoff scripts: &#x27;script1.bat&#x27;, &#x27;script2.bat&#x27;, and &#x27;script3.bat&#x27;.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_startup_scriptsself">FunctionDef get_startup_scripts(self)<a href="#functiondef-get_startup_scriptsself" class="hash-link" aria-label="Direct link to FunctionDef get_startup_scripts(self)" title="Direct link to FunctionDef get_startup_scripts(self)">​</a></h3>
<p><strong>get_startup_scripts</strong>: This function is used to retrieve the list of startup scripts.</p>
<p><strong>Parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The function returns the value of the <code>__startup_scripts</code> attribute of the object. This attribute is expected to be a list of scripts that should be executed at startup. The function does not contain any logic for modifying the list or executing the scripts. It is simply used to retrieve the list of startup scripts.</p>
<p>This function is called by the <code>add_script</code> function in the <code>add_script</code> module. The <code>add_script</code> function uses <code>get_startup_scripts</code> to get the list of startup scripts and then appends the script passed to it as a parameter to this list. This allows scripts to be added to the list of startup scripts.</p>
<p><strong>Note</strong>: It is important to note that this function does not add scripts to the list of startup scripts. It only retrieves the list. To add scripts to the list, use the <code>add_script</code> function.</p>
<p><strong>Output Example</strong>:</p>
<p>Assuming the <code>__startup_scripts</code> attribute of the object is initialized as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__startup_scripts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A call to <code>get_startup_scripts</code> would return:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This indicates that the scripts <code>script1.bat</code> and <code>script2.bat</code> are currently set as startup scripts.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_shutdown_scriptsself">FunctionDef get_shutdown_scripts(self)<a href="#functiondef-get_shutdown_scriptsself" class="hash-link" aria-label="Direct link to FunctionDef get_shutdown_scripts(self)" title="Direct link to FunctionDef get_shutdown_scripts(self)">​</a></h3>
<p><strong>get_shutdown_scripts</strong>: This function is used to retrieve the list of shutdown scripts.</p>
<p><strong>Parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The function returns the value of the private attribute <code>__shutdown_scripts</code> which is a list containing all the shutdown scripts added using the <code>add_script</code> function. This function does not perform any filtering or validation, it simply returns the current list of shutdown scripts.</p>
<p><strong>Relationship with its callers in the project</strong>: This function is called by the <code>add_script</code> function in the <code>gpoa/gpt/scriptsini.py/Scripts_lists/add_script</code> module. When the <code>action</code> parameter of the <code>add_script</code> function is &#x27;SHUTDOWN&#x27;, the script is added to the list of shutdown scripts using this function.</p>
<p><strong>Note</strong>: The <code>get_shutdown_scripts</code> function is a simple getter method, it does not perform any operation other than returning the current list of shutdown scripts. It is important to note that this function does not return a copy of the list, but the actual list object. Therefore, any modification made to this list will affect the original list of shutdown scripts.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;script1.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script2.bat&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script3.bat&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is an example of the output of the <code>get_shutdown_scripts</code> function, it returns a list of shutdown scripts, in this case, three scripts named &#x27;script1.bat&#x27;, &#x27;script2.bat&#x27; and &#x27;script3.bat&#x27;.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-add_scriptself-action-script">FunctionDef add_script(self, action, script)<a href="#functiondef-add_scriptself-action-script" class="hash-link" aria-label="Direct link to FunctionDef add_script(self, action, script)" title="Direct link to FunctionDef add_script(self, action, script)">​</a></h3>
<p><strong>add_script</strong>: The function of add_script is to add a script to the appropriate list based on the specified action.</p>
<p><strong>parameters</strong>:
· action: A string representing the action for which the script is being added. The possible values are &#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;, &#x27;STARTUP&#x27;, and &#x27;SHUTDOWN&#x27;.
· script: A Script object representing the script to be added.</p>
<p><strong>Code Description</strong>:
The add_script function first checks the value of the action parameter. If the action is &#x27;LOGON&#x27;, it appends the script to the logon scripts list by calling the get_logon_scripts() method. If the action is &#x27;LOGOFF&#x27;, it appends the script to the logoff scripts list by calling the get_logoff_scripts() method. If the action is &#x27;STARTUP&#x27;, it appends the script to the startup scripts list by calling the get_startup_scripts() method. If the action is &#x27;SHUTDOWN&#x27;, it appends the script to the shutdown scripts list by calling the get_shutdown_scripts() method.</p>
<p>The get_logon_scripts(), get_logoff_scripts(), get_startup_scripts(), and get_shutdown_scripts() methods all return a list of scripts that have been added for the corresponding action. These methods are defined in the same Scripts_lists class as the add_script method.</p>
<p>The add_script method is called by the read_scripts function in the gpoa/gpt/scriptsini.py/read_scripts module. The read_scripts function reads a script file and adds the scripts to the appropriate lists based on the action specified in the file.</p>
<p>The add_script method is an instance method, meaning it can only be called on an instance of the Scripts_lists class. It modifies the state of the object by adding the script to the appropriate list.</p>
<p><strong>Note</strong>:
It is important to note that the add_script method does not return any value. Instead, it modifies the state of the object by adding the script to the appropriate list.</p>
<p>When calling the add_script method, it is important to ensure that the action parameter is one of the valid values (&#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;, &#x27;STARTUP&#x27;, or &#x27;SHUTDOWN&#x27;). Passing an invalid value will result in an error.</p>
<p>It is also important to note that the add_script method does not validate the script parameter. It is assumed that the script parameter is a valid Script object. If an invalid object is passed, it may result in unexpected behavior.</p>
<p>The add_script method is a crucial part of the project as it allows scripts to be added to the appropriate lists based on the action. This is important for managing and executing scripts based on the action.</p>
<p>The following is an example of how the add_script method may be called:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scripts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Scripts_lists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;LOGON&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;parameters&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scripts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;LOGON&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> script</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, a new instance of the Scripts_lists class is created. A new Script object is also created, representing a script that should be added to the logon scripts list. The add_script method is then called with the &#x27;LOGON&#x27; action and the script object as parameters. This will add the script to the logon scripts list.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-script">ClassDef Script<a href="#classdef-script" class="hash-link" aria-label="Direct link to ClassDef Script" title="Direct link to ClassDef Script">​</a></h2>
<p><strong>Script</strong>: The Script class is a blueprint for creating script objects, which are used to manage and execute different types of scripts based on specific actions such as logon, logoff, startup, and shutdown.</p>
<p><strong>attributes</strong>: The Script class has the following attributes:</p>
<p>· <code>action</code>: A string representing the action associated with the script (e.g., &#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;, &#x27;STARTUP&#x27;, &#x27;SHUTDOWN&#x27;).</p>
<p>· <code>path</code>: A string representing the file path of the script.</p>
<p>· <code>args</code>: An optional argument that can be used to pass command-line arguments to the script.</p>
<p>· <code>number</code>: An integer representing the sequence number of the script for a given action.</p>
<p><strong>Code Description</strong>: The Script class initializes the action, path, and number attributes in the constructor. The action attribute is set to the uppercase value of the input action parameter. The path attribute is constructed by joining the script directory, the action uppercase value, and the script filename (in uppercase) using the <code>os.path.join()</code> method. If the script file does not exist, the constructor returns <code>None</code>. The number attribute is set based on the action type (logon, logoff, startup, or shutdown) and increments the corresponding counter.</p>
<p>The <code>set_args()</code> method is used to set the <code>args</code> attribute of the Script object.</p>
<p>The Script class is used in the <code>read_scripts()</code> function to create script objects based on the input scripts file. The function reads the scripts file using a ConfigParser object and iterates through the sections and keys to create script objects based on the action type and script filename. The script objects are then added to the corresponding action dictionary (logon, logoff, startup, or shutdown) based on their action type.</p>
<p><strong>Note</strong>: It is important to note that the <code>set_args()</code> method should be called after creating a Script object to set the <code>args</code> attribute. Additionally, the script file path should be a valid path to ensure that the script object is initialized correctly.</p>
<p><strong>Output Example</strong>: Here is an example of how the Script class can be used to create script objects:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a Script object for a logon script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logon_script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;logon&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script/directory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script.bat&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set the command-line arguments for the logon script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logon_script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_args</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;/arg1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/arg2&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create script objects for logoff, startup, and shutdown scripts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logoff_script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;logoff&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script/directory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script.bat&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">startup_script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;startup&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script/directory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script.bat&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shutdown_script </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Script</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;shutdown&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script/directory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script.bat&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-action-script_dir-script_filename">FunctionDef <strong>init</strong>(self, action, script_dir, script_filename)<a href="#functiondef-initself-action-script_dir-script_filename" class="hash-link" aria-label="Direct link to functiondef-initself-action-script_dir-script_filename" title="Direct link to functiondef-initself-action-script_dir-script_filename">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the Script object with the given parameters and set up necessary attributes.</p>
<p><strong>parameters</strong>
· action: A string representing the action to be taken by the Script object. It can be &#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;, &#x27;STARTUP&#x27;, or &#x27;SHUTDOWN&#x27;.
· script_dir: A string representing the directory path where the script file is located.
· script_filename: A string representing the name of the script file.</p>
<p><strong>Code Description</strong>
The <strong>init</strong> function starts by converting the action parameter to uppercase and storing it in the action attribute of the object. Then, it constructs the path to the script file by joining the script_dir, action_upper, and script_filename_upper using the os.path.join() function.</p>
<p>Next, it checks if the constructed path is a valid file using os.path.isfile(). If the file does not exist, the function returns None.</p>
<p>After that, it initializes the args attribute to None.</p>
<p>Then, it checks the value of action_upper and sets the number attribute accordingly. If the action is &#x27;LOGON&#x27;, it sets the number attribute to the value of Script.__logon_counter and increments Script.__logon_counter by 1. It does the same for &#x27;LOGOFF&#x27;, &#x27;STARTUP&#x27;, and &#x27;SHUTDOWN&#x27; actions.</p>
<p><strong>Note</strong>
The Script class must have the following class attributes defined:
· Script.__logon_counter: An integer representing the number of logon scripts.
· Script.__logoff_counter: An integer representing the number of logoff scripts.
· Script.__startup_counter: An integer representing the number of startup scripts.
· Script.__shutdown_counter: An integer representing the number of shutdown scripts.</p>
<p>These attributes are used to assign unique numbers to each script of the same type.</p>
<p><strong>Output Example</strong>
Assuming the following inputs:
action = &#x27;logon&#x27;
script_dir = &#x27;/path/to/scripts&#x27;
script_filename = &#x27;my_script.py&#x27;</p>
<p>The output of the <strong>init</strong> function would be:</p>
<p>Script object with the following attributes:
· action = &#x27;LOGON&#x27;
· path = &#x27;/path/to/scripts/LOGON/MY_SCRIPT.PY&#x27;
· args = None
· number = 0 (assuming Script.__logon_counter was 0 before the initialization)</p>
<p>If the file at &#x27;/path/to/scripts/LOGON/MY_SCRIPT.PY&#x27; does not exist, the output would be None.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-set_argsself-args">FunctionDef set_args(self, args)<a href="#functiondef-set_argsself-args" class="hash-link" aria-label="Direct link to FunctionDef set_args(self, args)" title="Direct link to FunctionDef set_args(self, args)">​</a></h3>
<p><strong>set_args</strong>: The function of set_args is to set the arguments of a Script object.</p>
<p><strong>parameters</strong>:
· args: The arguments to be set for the Script object.</p>
<hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/gpupdate-docs/docs/gpoa/gpt/printers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">printers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/gpupdate-docs/docs/gpoa/gpt/services"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">services</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#functiondef-read_scriptsscripts_file" class="table-of-contents__link toc-highlight">FunctionDef read_scripts(scripts_file)</a></li><li><a href="#functiondef-merge_scriptsstorage-sid-scripts_objects-policy_name" class="table-of-contents__link toc-highlight">FunctionDef merge_scripts(storage, sid, scripts_objects, policy_name)</a></li><li><a href="#classdef-scripts_lists" class="table-of-contents__link toc-highlight">ClassDef Scripts_lists</a><ul><li><a href="#functiondef-initself" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self)</a></li><li><a href="#functiondef-get_logon_scriptsself" class="table-of-contents__link toc-highlight">FunctionDef get_logon_scripts(self)</a></li><li><a href="#functiondef-get_logoff_scriptsself" class="table-of-contents__link toc-highlight">FunctionDef get_logoff_scripts(self)</a></li><li><a href="#functiondef-get_startup_scriptsself" class="table-of-contents__link toc-highlight">FunctionDef get_startup_scripts(self)</a></li><li><a href="#functiondef-get_shutdown_scriptsself" class="table-of-contents__link toc-highlight">FunctionDef get_shutdown_scripts(self)</a></li><li><a href="#functiondef-add_scriptself-action-script" class="table-of-contents__link toc-highlight">FunctionDef add_script(self, action, script)</a></li></ul></li><li><a href="#classdef-script" class="table-of-contents__link toc-highlight">ClassDef Script</a><ul><li><a href="#functiondef-initself-action-script_dir-script_filename" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, action, script_dir, script_filename)</a></li><li><a href="#functiondef-set_argsself-args" class="table-of-contents__link toc-highlight">FunctionDef set_args(self, args)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/gpupdate-docs/docs/gpoa/backend/samba_backend">Samba Backend</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 BaseALT LTD, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>