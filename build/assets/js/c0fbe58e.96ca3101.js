"use strict";(self.webpackChunkgpupdate_docs=self.webpackChunkgpupdate_docs||[]).push([[8985],{8084:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var s=n(4848),o=n(8453);const i={},r=void 0,l={id:"gpoa/frontend/control_applier",title:"control_applier",description:"ClassDef control_applier",source:"@site/docs/gpoa/frontend/control_applier.md",sourceDirName:"gpoa/frontend",slug:"/gpoa/frontend/control_applier",permalink:"/docs/gpoa/frontend/control_applier",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"cifs_applier",permalink:"/docs/gpoa/frontend/cifs_applier"},next:{title:"cups_applier",permalink:"/docs/gpoa/frontend/cups_applier"}},c={},a=[{value:"ClassDef control_applier",id:"classdef-control_applier",level:2},{value:"FunctionDef <strong>init</strong>(self, storage)",id:"functiondef-initself-storage",level:3},{value:"FunctionDef run(self)",id:"functiondef-runself",level:3},{value:"FunctionDef apply(self)",id:"functiondef-applyself",level:3}];function d(e){const t={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"classdef-control_applier",children:"ClassDef control_applier"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"control_applier"}),": The function of control_applier is to manage and apply control settings in the Windows Registry for the gpoa project. It is a subclass of applier_frontend and is intended to be used as a frontend module that applies policies."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"attributes"}),":\n\xb7 storage: An instance of the storage class, which is used to interact with the Windows Registry and other storage mechanisms.\n\xb7 control_settings: A list of control setting entries filtered from the Windows Registry.\n\xb7 controls: A list of control objects, each representing a control setting."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":\nThe control_applier class is a subclass of applier_frontend and is used to manage and apply control settings in the Windows Registry for the gpoa project. It initializes the storage attribute and filters control setting entries from the Windows Registry in the __init__() method. The control_settings attribute is a list of control setting entries, and the controls attribute is a list of control objects, each representing a control setting."]}),"\n",(0,s.jsx)(t.p,{children:"The run() method iterates through the control_settings list and creates control objects for each entry. It handles exceptions when creating control objects and logs error messages when necessary. The set_control_status() method is called for each control object to set the control status."}),"\n",(0,s.jsx)(t.p,{children:"The apply() method checks whether the current module is enabled and calls the run() method if it is. It logs a debug message when the run() method is called and an error message when the module is not enabled."}),"\n",(0,s.jsx)(t.p,{children:"The __module_name__, __module_experimental__, and __module_enabled__ attributes are used by the gpoa application to determine whether the current module should be loaded and applied."}),"\n",(0,s.jsx)(t.p,{children:"The control_applier class is intended to be used as a frontend module that applies policies in the gpoa project. It is called by the frontend_manager module to initialize machine appliers and is used to manage and apply control settings in the Windows Registry."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":\nThe control_applier class is intended to be used as a frontend module that applies policies in the gpoa project. Subclasses should not override the run() method, as it contains the logic for creating control objects and setting control status. Subclasses should set the __module_name__, __module_experimental__, and __module_enabled__ attributes appropriately."]}),"\n",(0,s.jsxs)(t.h3,{id:"functiondef-initself-storage",children:["FunctionDef ",(0,s.jsx)(t.strong,{children:"init"}),"(self, storage)"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})}),": The function of ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})})," is to initialize the control applier object with a storage object."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),": The parameters of this Function.\n\xb7 storage: The storage object that contains the information about the modules and policies."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),": The ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.strong,{children:"init"})})," function is the constructor of the control applier class, which is defined in the ",(0,s.jsx)(t.code,{children:"control_applier.py"})," module. It takes a single parameter ",(0,s.jsx)(t.code,{children:"storage"}),", which is a storage object that contains the information about the modules and policies."]}),"\n",(0,s.jsxs)(t.p,{children:["The function initializes the ",(0,s.jsx)(t.code,{children:"control_settings"})," attribute of the class by calling the ",(0,s.jsx)(t.code,{children:"filter_hklm_entries"})," method of the ",(0,s.jsx)(t.code,{children:"storage"})," object with the prefix string ",(0,s.jsx)(t.code,{children:"'Software\\\\BaseALT\\\\Policies\\\\Control%'"}),". This filters the HKLM entries in the Windows registry that start with the given prefix string and assigns the result to the ",(0,s.jsx)(t.code,{children:"control_settings"})," attribute."]}),"\n",(0,s.jsxs)(t.p,{children:["The function also initializes an empty list ",(0,s.jsx)(t.code,{children:"controls"})," attribute, which will be used to store the control objects that are created based on the ",(0,s.jsx)(t.code,{children:"control_settings"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Additionally, the function calls the ",(0,s.jsx)(t.code,{children:"check_enabled"})," function with the ",(0,s.jsx)(t.code,{children:"storage"}),", ",(0,s.jsx)(t.code,{children:"__module_name"}),", and ",(0,s.jsx)(t.code,{children:"__module_experimental"})," attributes of the class as arguments. The ",(0,s.jsx)(t.code,{children:"check_enabled"})," function checks if the module is enabled or not based on the storage and the name of the module. The result of this function call is assigned to the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute of the class."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),": The ",(0,s.jsx)(t.code,{children:"control_applier"})," class is used to apply the policies and settings that are stored in the Windows registry to the system. The ",(0,s.jsx)(t.code,{children:"storage"})," parameter is used to retrieve the policy and setting information from the registry. The ",(0,s.jsx)(t.code,{children:"control_settings"})," attribute is used to store the filtered HKLM entries that correspond to the Control policies. The ",(0,s.jsx)(t.code,{children:"controls"})," attribute is used to store the control objects that are created based on the ",(0,s.jsx)(t.code,{children:"control_settings"}),". The ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute is used to determine whether the module is enabled or not."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-runself",children:"FunctionDef run(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"run"}),": The function of run is to apply a list of control settings to their corresponding controls."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,s.jsx)(t.code,{children:"self"}),": The instance of the ",(0,s.jsx)(t.code,{children:"control_applier"})," class."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"functiondef-applyself",children:"FunctionDef apply(self)"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"apply"}),": The function of apply is to trigger control facility invocation."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"parameters"}),": This function does not take any parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Code Description"}),":"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function checks if the module is enabled using the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute. If the module is enabled, it logs a message with the code 'D67' and then calls the ",(0,s.jsx)(t.code,{children:"run"})," function. If the module is not enabled, it logs a message with the code 'E40'."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function is defined in the same class and is responsible for applying a list of control settings to their corresponding controls. It iterates through the ",(0,s.jsx)(t.code,{children:"control_settings"})," list and for each setting, it extracts the value name and tries to create a new ",(0,s.jsx)(t.code,{children:"control"})," object with the value name and the setting's data. If the data can be converted to an integer, an integer value is used, otherwise, the data is used as a string value. The function logs information about the created control object."]}),"\n",(0,s.jsxs)(t.p,{children:["If there is an exception while creating the ",(0,s.jsx)(t.code,{children:"control"})," object with an integer value, the function tries to create the object with the data as a string value. If there is an exception while creating the ",(0,s.jsx)(t.code,{children:"control"})," object in both cases, the function logs an error message with the control name and the exception."]}),"\n",(0,s.jsxs)(t.p,{children:["After creating all the control objects, the function sets the control status for each control object in the ",(0,s.jsx)(t.code,{children:"controls"})," list."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"control"})," class and the ",(0,s.jsx)(t.code,{children:"control_settings"})," list are not defined in this module, they are defined in the same class as the ",(0,s.jsx)(t.code,{children:"apply"})," and ",(0,s.jsx)(t.code,{children:"run"})," functions."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function assumes that the ",(0,s.jsx)(t.code,{children:"__module_enabled"})," attribute is set and can be used to check if the module is enabled."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"run"})," function assumes that the ",(0,s.jsx)(t.code,{children:"control_settings"})," list is populated with valid settings and that the ",(0,s.jsx)(t.code,{children:"controls"})," list is empty before adding new control objects."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"control"})," class must have a ",(0,s.jsx)(t.code,{children:"set_control_status"})," method for the ",(0,s.jsx)(t.code,{children:"run"})," function to work correctly."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.code,{children:"apply"})," function logs messages with the 'D67' and 'E40' codes, which are not defined in the provided log function documentation. It is unclear what these codes mean and how they are handled by the logging system."]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(6540);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);