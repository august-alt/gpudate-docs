"use strict";(self.webpackChunkgpupdate_docs=self.webpackChunkgpupdate_docs||[]).push([[7478],{7199:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var i=n(4848),a=n(8453);const o={},s=void 0,r={id:"gpoa/gpt/envvars",title:"envvars",description:"ClassDef FileAction",source:"@site/docs/gpoa/gpt/envvars.md",sourceDirName:"gpoa/gpt",slug:"/gpoa/gpt/envvars",permalink:"/docs/gpoa/gpt/envvars",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"drives",permalink:"/docs/gpoa/gpt/drives"},next:{title:"files",permalink:"/docs/gpoa/gpt/files"}},c={},l=[{value:"ClassDef FileAction",id:"classdef-fileaction",level:2},{value:"FunctionDef action_letter2enum(letter)",id:"functiondef-action_letter2enumletter",level:2},{value:"FunctionDef read_envvars(envvars_file)",id:"functiondef-read_envvarsenvvars_file",level:2},{value:"FunctionDef merge_envvars(storage, sid, envvar_objects, policy_name)",id:"functiondef-merge_envvarsstorage-sid-envvar_objects-policy_name",level:2},{value:"ClassDef envvar",id:"classdef-envvar",level:2},{value:"FunctionDef <strong>init</strong>(self, name, value)",id:"functiondef-initself-name-value",level:3},{value:"FunctionDef set_action(self, action)",id:"functiondef-set_actionself-action",level:3}];function h(e){const t={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"classdef-fileaction",children:"ClassDef FileAction"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"FileAction"}),": The FileAction class is an enumeration type that defines four actions related to file management: CREATE, REPLACE, UPDATE, and DELETE."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Attributes"}),":\n\xb7 CREATE: A constant that represents the action of creating a new file.\n\xb7 REPLACE: A constant that represents the action of replacing the content of an existing file.\n\xb7 UPDATE: A constant that represents the action of updating the content of an existing file.\n\xb7 DELETE: A constant that represents the action of deleting a file."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe FileAction class is used to represent different actions that can be performed on a file. It is defined as an enumeration type with four constants: CREATE, REPLACE, UPDATE, and DELETE. These constants are used to indicate the desired action to be taken on a file in various parts of the project."]}),"\n",(0,i.jsx)(t.p,{children:"For instance, in the Envvar class (gpoa/frontend/appliers/envvar.py/Envvar), the act method uses the FileAction enumeration to determine the action to be performed on a file based on the action attribute of each Envvar object. The action_letter2enum function (gpoa/gpt/envvars.py/action_letter2enum) is then used to convert the action letter (C, R, U, or D) to the corresponding FileAction constant."}),"\n",(0,i.jsx)(t.p,{children:"In the act method, the file content is updated based on the action attribute of each Envvar object. If the action is CREATE, the file is created if it does not exist; if the action is DELETE, the file is deleted if it exists; if the action is REPLACE or UPDATE, the file content is replaced or updated accordingly."}),"\n",(0,i.jsx)(t.p,{children:"The FileAction enumeration is also used in the envvar module (gpoa/gpt/envvars.py) to initialize the action attribute of each Envvar object to the CREATE constant by default."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The FileAction enumeration should be used consistently throughout the project to indicate file actions."}),"\n",(0,i.jsx)(t.li,{children:"The action_letter2enum function should be used to convert action letters to FileAction constants."}),"\n",(0,i.jsx)(t.li,{children:"The Envvar class uses the FileAction enumeration to determine the action to be performed on a file."}),"\n",(0,i.jsx)(t.li,{children:"The envvar module initializes the action attribute of each Envvar object to the CREATE constant by default."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"functiondef-action_letter2enumletter",children:"FunctionDef action_letter2enum(letter)"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"action_letter2enum"}),": The function of action_letter2enum is to convert a file action letter (C, R, U, or D) to the corresponding FileAction enumeration constant."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"parameters"}),":\n\xb7 letter (str): A single character representing a file action (C for create, R for replace, U for update, or D for delete)."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe action_letter2enum function takes a single character string parameter, letter, which represents a file action. It checks if the letter is one of the four valid action letters (C, R, U, or D) and returns the corresponding FileAction enumeration constant. If the letter is not a valid action letter, it defaults to returning the FileAction.CREATE constant."]}),"\n",(0,i.jsx)(t.p,{children:"This function is used to convert action letters to FileAction constants, providing a consistent and clear way to represent file actions throughout the project. It is called by the Envvar class's act method (gpoa/frontend/appliers/envvar.py/Envvar/act) and the read_envvars function (gpoa/gpt/envvars.py/read_envvars) to determine the action to be performed on a file based on the action attribute of each Envvar object."}),"\n",(0,i.jsx)(t.p,{children:"In the Envvar class's act method, action_letter2enum converts the action letter to the corresponding FileAction constant, which is then used to determine the action to be performed on the file. In the read_envvars function, action_letter2enum sets the action attribute of each Envvar object to the corresponding FileAction constant based on the action letter provided in the XML file."}),"\n",(0,i.jsx)(t.p,{children:"By using the action_letter2enum function, the project ensures consistency in representing file actions and makes it easier to maintain and extend the codebase."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The action_letter2enum function should be used consistently throughout the project to convert action letters to FileAction constants."}),"\n",(0,i.jsx)(t.li,{children:"The input parameter, letter, should be a single character representing a file action (C, R, U, or D)."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Output Example"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"action_letter2enum('C')  # returns FileAction.CREATE\naction_letter2enum('R')  # returns FileAction.REPLACE\naction_letter2enum('U')  # returns FileAction.UPDATE\naction_letter2enum('D')  # returns FileAction.DELETE\naction_letter2enum('X')  # returns FileAction.CREATE (as 'X' is not a valid action letter)\n"})}),"\n",(0,i.jsx)(t.h2,{id:"functiondef-read_envvarsenvvars_file",children:"FunctionDef read_envvars(envvars_file)"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"read_envvars"}),": The function of read_envvars is to read environment variables from an XML file and convert them into a list of envvar objects, each with a name, value, and action attribute."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"parameters"}),":\n\xb7 envvars_file: A string representing the path to the XML file containing the environment variables."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe read_envvars function begins by initializing an empty list called variables, which will store the envvar objects created from the XML file."]}),"\n",(0,i.jsx)(t.p,{children:"Next, the function calls the get_xml_root function (gpoa/util/xml.py/get_xml_root), passing in the envvars_file parameter to parse the XML file and return its root element."}),"\n",(0,i.jsx)(t.p,{children:"The function then iterates over each child element of the root element, which should correspond to an environment variable in the XML file. For each child element, the function extracts the 'name', 'value', and 'action' attributes using the find() and get() methods of the ElementTree module."}),"\n",(0,i.jsx)(t.p,{children:"The 'name' and 'value' attributes are used to create a new envvar object, which is added to the variables list. The 'action' attribute is converted to the corresponding FileAction enumeration constant using the action_letter2enum function (gpoa/gpt/envvars.py/action_letter2enum). The set_action method of the envvar class is then called to set the action attribute of the envvar object to the converted FileAction enumeration constant."}),"\n",(0,i.jsx)(t.p,{children:"Finally, the function returns the variables list containing the envvar objects created from the XML file."}),"\n",(0,i.jsx)(t.p,{children:"The read_envvars function is called by the pref_parsers function (gpoa/gpt/gpt.py/pref_parsers) to parse environment variables from an XML file and convert them into a list of envvar objects. The envvar objects are then used to perform actions on the environment variables based on their name, value, and action attributes."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The read_envvars function assumes that the XML file passed in as the envvars_file parameter is valid and can be parsed by the ElementTree module. If an invalid XML file is passed in, the function may raise an exception."}),"\n",(0,i.jsx)(t.li,{children:"The read_envvars function sets the default action attribute of each envvar object to FileAction.CREATE if the 'action' attribute is not specified in the XML file."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Output Example"}),':\nSuppose we have an XML file named "envvars.xml" with the following contents:']}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:"<root>\n  <envvar>\n    <name>VAR1</name>\n    <value>value1</value>\n    <action>U</action>\n  </envvar>\n  <envvar>\n    <name>VAR2</name>\n    <value>value2</value>\n  </envvar>\n</root>\n"})}),"\n",(0,i.jsx)(t.p,{children:"Calling the read_envvars function with the path to this file as its parameter would return the following list:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"[\n  envvar(name='VAR1', value='value1', action=FileAction.UPDATE),\n  envvar(name='VAR2', value='value2', action=FileAction.CREATE)\n]\n"})}),"\n",(0,i.jsx)(t.p,{children:'This list contains two envvar objects, one with the name "VAR1", value "value1", and action FileAction.UPDATE, and another with the name "VAR2", value "value2", and action FileAction.CREATE. The second envvar object has a default action of CREATE since the \'action\' attribute is not specified in the XML file.'}),"\n",(0,i.jsx)(t.h2,{id:"functiondef-merge_envvarsstorage-sid-envvar_objects-policy_name",children:"FunctionDef merge_envvars(storage, sid, envvar_objects, policy_name)"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"merge_envvars"}),": The function of merge_envvars is to merge environment variables in the storage object based on the input environment variable objects and policy name."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"parameters"}),":\n\xb7 storage: An object that has the method add_envvar to add environment variables.\n\xb7 sid: A string that represents the session ID.\n\xb7 envvar_objects: A list of environment variable objects to be merged.\n\xb7 policy_name: A string that represents the name of the policy."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe function iterates over each environment variable object in the envvar_objects list and calls the add_envvar method of the storage object to add the environment variable to the storage. The session ID (sid) and policy name are also passed as arguments while adding the environment variable. This way, the function helps in organizing and managing environment variables in a centralized storage object by merging them based on the provided session ID and policy name."]}),"\n",(0,i.jsx)(t.p,{children:"From a functional perspective, this code plays a crucial role in the pref_mergers object defined in gpoa/gpt/gpt.py. The pref_mergers object is a dictionary that maps different file types to their corresponding merger functions. The merge_envvars function is assigned as the merger function for the FileType.ENVIRONMENTVARIABLES file type. When the pref_mergers object is called with this file type, it invokes the merge_envvars function to merge the environment variables based on the provided storage, session ID, environment variable objects, and policy name."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":\nIt is essential to ensure that the storage object passed as an argument has the add_envvar method defined, and it can handle the merging of environment variables efficiently. Also, the envvar_objects list should contain well-structured environment variable objects for successful merging. Lastly, the policy_name should be a valid string to ensure proper merging based on the policy."]}),"\n",(0,i.jsx)(t.h2,{id:"classdef-envvar",children:"ClassDef envvar"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"envvar"}),": The function of envvar is to represent an environment variable with a name and value, as well as an action associated with it."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"attributes"}),":\n\xb7 name: The name of the environment variable.\n\xb7 value: The value of the environment variable.\n\xb7 action: The action to be taken on the environment variable. This is an instance of the FileAction enum and can be CREATE, UPDATE, or DELETE."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe envvar class is instantiated with a name and value for the environment variable. It has a default action of CREATE. The set_action method allows for changing the action associated with the environment variable."]}),"\n",(0,i.jsx)(t.p,{children:"The envvar class is used in the read_envvars function to read environment variables from an XML file and create envvar objects for each one. The action for each environment variable is determined by the 'action' attribute in the XML file, which is converted to the corresponding FileAction enum value using the action_letter2enum function."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":\nIt is important to note that the envvar class is designed to work with environment variables in the context of an XML file. The name and value attributes correspond to the 'name' and 'value' elements in the XML file, and the action attribute corresponds to the 'action' element. When creating envvar objects, make sure to provide the name and value as strings. The action can be provided as a string or as a FileAction enum value."]}),"\n",(0,i.jsx)(t.p,{children:"Additionally, the set_action method allows for changing the action associated with an envvar object after it has been created. This can be useful if the action for a particular environment variable needs to be updated based on new information."}),"\n",(0,i.jsx)(t.p,{children:"When working with the envvar class, it is also important to ensure that the action attribute is set to a valid FileAction enum value (CREATE, UPDATE, or DELETE). Attempting to set the action to an invalid value will result in a ValueError."}),"\n",(0,i.jsxs)(t.h3,{id:"functiondef-initself-name-value",children:["FunctionDef ",(0,i.jsx)(t.strong,{children:"init"}),"(self, name, value)"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.strong,{children:"init"})}),": The function of the ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.strong,{children:"init"})})," method in the ",(0,i.jsx)(t.code,{children:"envvar"})," class is to initialize the attributes of an ",(0,i.jsx)(t.code,{children:"envvar"})," object with the given ",(0,i.jsx)(t.code,{children:"name"})," and ",(0,i.jsx)(t.code,{children:"value"}),", and set the default ",(0,i.jsx)(t.code,{children:"action"})," to ",(0,i.jsx)(t.code,{children:"FileAction.CREATE"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,i.jsx)(t.code,{children:"name"}),": A string representing the name of the environment variable.\n\xb7 ",(0,i.jsx)(t.code,{children:"value"}),": A string representing the value of the environment variable."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe ",(0,i.jsx)(t.code,{children:"__init__"})," method is a special method in Python classes that gets called when a new instance of the class is created. In this case, it sets the ",(0,i.jsx)(t.code,{children:"name"})," and ",(0,i.jsx)(t.code,{children:"value"})," attributes of the ",(0,i.jsx)(t.code,{children:"envvar"})," object to the given ",(0,i.jsx)(t.code,{children:"name"})," and ",(0,i.jsx)(t.code,{children:"value"})," parameters, respectively."]}),"\n",(0,i.jsxs)(t.p,{children:["Additionally, the ",(0,i.jsx)(t.code,{children:"action"})," attribute is set to ",(0,i.jsx)(t.code,{children:"FileAction.CREATE"}),", which is an enumeration constant defined in the ",(0,i.jsx)(t.code,{children:"FileAction"})," class. This constant represents the action of creating a new file, and it is used to indicate the desired action to be taken on a file in various parts of the project."]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"FileAction"})," enumeration is used consistently throughout the project to indicate file actions, and it should be used consistently in this class as well. By setting the default ",(0,i.jsx)(t.code,{children:"action"})," to ",(0,i.jsx)(t.code,{children:"FileAction.CREATE"}),", the ",(0,i.jsx)(t.code,{children:"envvar"})," class ensures that any new ",(0,i.jsx)(t.code,{children:"envvar"})," object will have a default action set, which can be changed later if necessary."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"FileAction"})," enumeration should be used consistently throughout the project to indicate file actions."]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"action"})," attribute of an ",(0,i.jsx)(t.code,{children:"envvar"})," object should be set to the appropriate ",(0,i.jsx)(t.code,{children:"FileAction"})," constant to indicate the desired action to be taken on a file."]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"__init__"})," method is a special method in Python classes that gets called when a new instance of the class is created. It is used to initialize the attributes of the new instance."]}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h3,{id:"functiondef-set_actionself-action",children:"FunctionDef set_action(self, action)"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"set_action"}),": The function of set_action is to set the action attribute of an envvar object."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"parameters"}),":\n\xb7 ",(0,i.jsx)(t.strong,{children:"action"}),": The action to be set for the envvar object. This is expected to be an integer value representing the action type."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Code Description"}),":\nThe set_action function is a simple method that sets the action attribute of an envvar object to the input action value. It is defined within the envvar class and takes a single parameter, action, which is the action to be set for the object."]}),"\n",(0,i.jsx)(t.p,{children:"In the project, this function is called by the read_envvars function, which is responsible for reading environment variables from an XML file and creating envvar objects for each variable. After creating an envvar object, the read_envvars function calls the set_action function to set the action attribute of the object based on the action value specified in the XML file."}),"\n",(0,i.jsx)(t.p,{children:"It is important to note that the action value passed to the set_action function is obtained from the XML file using the get() method, which returns the value of the specified attribute if it exists or a default value if it does not. In the case of the read_envvars function, the default value is set to 'C', which represents the default action type."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Note"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"The set_action function expects the action parameter to be an integer value representing the action type. It is important to ensure that the value passed to this function is valid and correctly represents the desired action type."}),"\n",(0,i.jsx)(t.li,{children:"The set_action function is called by the read_envvars function to set the action attribute of envvar objects created from an XML file. It is important to ensure that the XML file is correctly formatted and that the action attribute is specified correctly for each variable."}),"\n",(0,i.jsx)(t.li,{children:"The set_action function is defined within the envvar class and is only accessible through an envvar object. It is not intended to be called as a standalone function."}),"\n"]}),"\n",(0,i.jsx)(t.hr,{})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var i=n(6540);const a={},o=i.createContext(a);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);