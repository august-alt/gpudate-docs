<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gpoa/frontend/appliers/firewall_rule" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">firewall_rule | GPUpdate Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://gpupdate-docs.github.io/docs/gpoa/frontend/appliers/firewall_rule"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="firewall_rule | GPUpdate Docs"><meta data-rh="true" name="description" content="FunctionDef getprops(param_list)"><meta data-rh="true" property="og:description" content="FunctionDef getprops(param_list)"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gpupdate-docs.github.io/docs/gpoa/frontend/appliers/firewall_rule"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/frontend/appliers/firewall_rule" hreflang="en"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/frontend/appliers/firewall_rule" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d27c289a.css">
<script src="/assets/js/runtime~main.e7149247.js" defer="defer"></script>
<script src="/assets/js/main.19b81b89.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GPUpdate Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/gpoa/backend/applier_backend">gpoa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/backend/applier_backend">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/gpoa/frontend/applier_frontend">frontend</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/applier_frontend">applier_frontend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/gpoa/frontend/appliers/control">appliers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/control">control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/envvar">envvar</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/file_cp">file_cp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/gpoa/frontend/appliers/firewall_rule">firewall_rule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/folder">folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/gsettings">gsettings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/ini_file">ini_file</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/netshare">netshare</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/polkit">polkit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/systemd">systemd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/appliers/util">util</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/chromium_applier">chromium_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/cifs_applier">cifs_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/control_applier">control_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/cups_applier">cups_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/envvar_applier">envvar_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/file_applier">file_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/firefox_applier">firefox_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/firewall_applier">firewall_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/folder_applier">folder_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/frontend_manager">frontend_manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/gsettings_applier">gsettings_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/ini_applier">ini_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/kde_applier">kde_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/networkshare_applier">networkshare_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/ntp_applier">ntp_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/package_applier">package_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/polkit_applier">polkit_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/scripts_applier">scripts_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/shortcut_applier">shortcut_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/systemd_applier">systemd_applier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/frontend/yandex_browser_applier">yandex_browser_applier</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/gpt/">gpt</a><button aria-label="Expand sidebar category &#x27;gpt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/plugin/">plugin</a><button aria-label="Expand sidebar category &#x27;plugin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/storage/cache">storage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/test/frontend/appliers/test_controls">test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/util/">util</a><button aria-label="Expand sidebar category &#x27;util&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools/parsing_chrom_admx_intvalues">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">gpoa</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">frontend</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">appliers</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">firewall_rule</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>firewall_rule</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-getpropsparam_list">FunctionDef getprops(param_list)<a href="#functiondef-getpropsparam_list" class="hash-link" aria-label="Direct link to FunctionDef getprops(param_list)" title="Direct link to FunctionDef getprops(param_list)">​</a></h2>
<p><strong>getprops</strong>: The function of getprops is to extract and store properties from a given list of string entries into a dictionary object.</p>
<p><strong>parameters</strong>:
· param_list: A list of string entries obtained by splitting a delimited string value.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_portsparam_list">FunctionDef get_ports(param_list)<a href="#functiondef-get_portsparam_list" class="hash-link" aria-label="Direct link to FunctionDef get_ports(param_list)" title="Direct link to FunctionDef get_ports(param_list)">​</a></h2>
<p><strong>get_ports</strong>: The function of get_ports is to extract and return a list of ports from a given list of string entries.</p>
<p><strong>parameters</strong>:
· param_list: A list of string entries from which the ports need to be extracted.</p>
<p><strong>Code Description</strong>:
The function initializes an empty list named portlist to store the extracted ports. It then iterates over each entry in the given param_list. For each entry, it converts the entry to lowercase and checks if it starts with the string &#x27;lport&#x27;. If it does, the function extracts the port number from the entry by splitting it at the &#x27;=&#x27; sign and appending the extracted port number to the portlist. Finally, the function returns the portlist containing all the extracted port numbers.</p>
<p>This function is used in the FirewallRule&#x27;s constructor to initialize the ports attribute of the FirewallRule object. The constructor takes a string data as input, which is split into an array of string entries using the &#x27;|&#x27; separator. The function get_ports is then called with the array of string entries (excluding the first entry which contains the version number) to extract the list of ports.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The function assumes that the port numbers in the input string entries are separated by the &#x27;=&#x27; sign and that they start with the string &#x27;lport&#x27;.</li>
<li>The function is case-sensitive and converts all entries to lowercase before processing them.</li>
</ul>
<p><strong>Output Example</strong>:
If the input param_list is [ &#x27;lport=80&#x27;, &#x27;lport=443&#x27;, &#x27;lport=1234&#x27; ], the output portlist will be [ &#x27;80&#x27;, &#x27;443&#x27;, &#x27;1234&#x27; ].</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-portstate">ClassDef PortState<a href="#classdef-portstate" class="hash-link" aria-label="Direct link to ClassDef PortState" title="Direct link to ClassDef PortState">​</a></h2>
<p><strong>PortState</strong>: The function of PortState is to represent the state of a port, which can be either open or closed.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li>OPEN: Represents the open state of a port. Its value is &#x27;Allow&#x27;.</li>
<li>CLOSE: Represents the closed state of a port. Its value is &#x27;Deny&#x27;.</li>
</ul>
<p><strong>Code Description</strong>:
The PortState class is an enumeration class that defines two states: OPEN and CLOSE. Each state has a corresponding value, &#x27;Allow&#x27; for OPEN and &#x27;Deny&#x27; for CLOSE. These states are used in the FirewallRule&#x27;s apply method to determine whether to allow or deny traffic through a specific port.</p>
<p>In the FirewallRule&#x27;s apply method, the PortState class is used to determine the action to take on a port based on its state. If the state is OPEN, the port is opened by adding it to the firewall rules. If the state is CLOSE, the port is closed by removing it from the firewall rules.</p>
<p>Here&#x27;s an example of how the PortState class is used in the FirewallRule&#x27;s apply method:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if PortState.OPEN.value == self.properties[&#x27;action&#x27;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tcp_port = &#x27;+&#x27; + tcp_port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    udp_port = &#x27;+&#x27; + udp_port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if PortState.CLOSE.value == self.properties[&#x27;action&#x27;]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tcp_port = &#x27;-&#x27; + tcp_port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    udp_port = &#x27;-&#x27; + udp_port</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the value of the &#x27;action&#x27; property is compared to the values of the PortState class to determine whether to open or close the port. If the &#x27;action&#x27; property matches the value of the OPEN state, the port is opened by adding it to the firewall rules. If the &#x27;action&#x27; property matches the value of the CLOSE state, the port is closed by removing it from the firewall rules.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The PortState class should only be used to represent the state of a port, either open or closed.</li>
<li>The values of the PortState class should not be modified, as they are used to determine the action to take on a port in the FirewallRule&#x27;s apply method.</li>
<li>The PortState class is used in the FirewallRule&#x27;s apply method to determine whether to allow or deny traffic through a specific port.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-protocol">ClassDef Protocol<a href="#classdef-protocol" class="hash-link" aria-label="Direct link to ClassDef Protocol" title="Direct link to ClassDef Protocol">​</a></h2>
<p><strong>Protocol</strong>: This class is used to define a set of predefined network protocol types.</p>
<p><strong>Attributes</strong>:</p>
<ul>
<li>TCP: This is an attribute of the Protocol class and it is set to the string value &#x27;tcp&#x27;. It is used to represent the Transmission Control Protocol.</li>
<li>UDP: This is an attribute of the Protocol class and it is set to the string value &#x27;udp&#x27;. It is used to represent the User Datagram Protocol.</li>
</ul>
<p><strong>Code Description</strong>:
The Protocol class is a subclass of the Enum class, which is a built-in class in Python. The Enum class is used to create a set of symbolic names (enumerations) for a set of related values, and it provides a way to define types with a limited, fixed set of values.</p>
<p>In this case, the Protocol class is used to define two enumerations, TCP and UDP, which represent two common network protocol types, Transmission Control Protocol and User Datagram Protocol, respectively. By using the Protocol class, you can ensure that only these two predefined values can be used when referring to network protocol types in the rest of the code, reducing the chance of errors and improving code readability.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>Always use the Protocol class to represent network protocol types in the code, instead of using the string values &#x27;tcp&#x27; and &#x27;udp&#x27; directly. This can help to make the code more self-explanatory and easier to maintain.</li>
<li>Be careful not to create new instances of the Protocol class directly, as it is intended to be a singleton class. Instead, use the predefined enumerations TCP and UDP to refer to the network protocol types.</li>
<li>If you need to add more network protocol types to the Protocol class in the future, you can do so by adding new attributes to the class, as long as they are unique and have a string value that represents the protocol type.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-firewallmode">ClassDef FirewallMode<a href="#classdef-firewallmode" class="hash-link" aria-label="Direct link to ClassDef FirewallMode" title="Direct link to ClassDef FirewallMode">​</a></h2>
<p><strong>FirewallMode</strong>: The function of FirewallMode is to define the mode of the firewall.</p>
<p><strong>Attributes</strong>:
· ROUTER: A string representing the firewall mode as a router.
· GATEWAY: A string representing the firewall mode as a gateway.
· HOST: A string representing the firewall mode as a host.</p>
<p><strong>Code Description</strong>:
The FirewallMode class is an Enum class that defines three different modes for a firewall: ROUTER, GATEWAY, and HOST. These modes determine the behavior of the firewall in different network environments.</p>
<p>In the code, the FirewallMode class is used in the <code>apply</code> function of the <code>FirewallRule</code> class to specify the mode of the firewall. Specifically, the <code>-m</code> option in the <code>portcmd</code> list is set to <code>FirewallMode.HOST.value</code>, which means that the firewall will operate in HOST mode.</p>
<p>It is worth noting that the <code>FirewallMode</code> class is not responsible for the actual firewall functionality. Instead, it provides a way to configure the firewall behavior based on the network environment.</p>
<p><strong>Note</strong>:
When using the <code>FirewallMode</code> class, it is important to understand the implications of each mode and choose the appropriate one based on the network environment. In the current implementation, the firewall always operates in HOST mode, but this may change in the future. Therefore, it is recommended to use the <code>FirewallMode</code> class to ensure flexibility and adaptability in different network scenarios.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-firewallrule">ClassDef FirewallRule<a href="#classdef-firewallrule" class="hash-link" aria-label="Direct link to ClassDef FirewallRule" title="Direct link to ClassDef FirewallRule">​</a></h2>
<p><strong>FirewallRule</strong>: The function of FirewallRule is to manage and apply firewall rules based on provided data.</p>
<p><strong>attributes</strong>:
· version: The version of the firewall rule.
· ports: A list of ports to be managed in the firewall rule.
· properties: A dictionary containing properties of the firewall rule, such as action (open or close).</p>
<p><strong>Code Description</strong>:
The <code>FirewallRule</code> class takes a string <code>data</code> as input during initialization, which is then split into an array <code>data_array</code> based on the &#x27;|&#x27; delimiter. The first element of the array is assigned to the <code>version</code> attribute, while the remaining elements are used to determine the <code>ports</code> and <code>properties</code> attributes by calling the <code>get_ports</code> and <code>getprops</code> functions, respectively.</p>
<p>The primary responsibility of the <code>FirewallRule</code> class is to apply the firewall rules using the <code>apply</code> method. This method creates two lists, <code>tcp_command</code> and <code>udp_command</code>, which are then populated with commands based on the <code>ports</code> and <code>properties</code> attributes. The <code>subprocess.Popen</code> function is used to execute these commands, and the <code>wait</code> method is called to ensure the process has completed before moving on to the next rule.</p>
<p>The <code>FirewallRule</code> class is utilized in the <code>run</code> method of the <code>firewall_applier</code> class, which is located in the <code>gpoa/frontend/firewall_applier.py/firewall_applier</code> object. The <code>run</code> method iterates through a list of <code>firewall_settings</code>, initializing a new <code>FirewallRule</code> instance for each setting and applying the rule using the <code>apply</code> method.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>FirewallRule</code> class assumes the existence and correctness of the <code>get_ports</code> and <code>getprops</code> functions, which are not provided in the code snippet. Ensure these functions are correctly implemented and available in the project.</li>
<li>The <code>subprocess.Popen</code> function is used to execute shell commands, which can potentially introduce security risks if not handled carefully. Ensure proper input validation and sanitization are in place to mitigate these risks.</li>
<li>The <code>apply</code> method modifies the firewall rules directly, which might cause unexpected behavior if applied concurrently with other firewall management tools or processes. Consider implementing locking mechanisms or other synchronization strategies to prevent conflicts.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-data">FunctionDef <strong>init</strong>(self, data)<a href="#functiondef-initself-data" class="hash-link" aria-label="Direct link to functiondef-initself-data" title="Direct link to functiondef-initself-data">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>__init__</strong> is to initialize a FirewallRule object with the given data.</p>
<p><strong>parameters</strong>: The parameters of this Function.
· data: A string containing firewall rule information, delimited by the &#x27;|&#x27; character.</p>
<p><strong>Code Description</strong>:
The constructor of the FirewallRule class takes a single parameter, data, which is a string containing the firewall rule information. It first splits this string into an array of string entries using the &#x27;|&#x27; separator.</p>
<p>The first entry in the resulting array is the version number, which is stored in the version attribute of the FirewallRule object. The remaining entries are passed to the get_ports() function, which extracts and returns a list of ports from the given list of string entries. This list of ports is stored in the ports attribute of the FirewallRule object.</p>
<p>Finally, the remaining entries are passed to the getprops() function, which extracts and returns a dictionary of properties from the given list of string entries. This dictionary of properties is stored in the properties attribute of the FirewallRule object.</p>
<p>The get_ports() and getprops() functions are helper functions defined in the same module as the FirewallRule class. They are used to extract and process the relevant information from the input data string.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The data string passed to the constructor must be in the correct format, with the firewall rule information delimited by the &#x27;|&#x27; character.</li>
<li>The version number must be the first entry in the data string.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-applyself">FunctionDef apply(self)<a href="#functiondef-applyself" class="hash-link" aria-label="Direct link to FunctionDef apply(self)" title="Direct link to FunctionDef apply(self)">​</a></h3>
<p><strong>apply</strong>: The function of apply in the FirewallRule class is to open or close the specified ports based on their current state and the firewall mode.</p>
<p><strong>parameters</strong>:
· self: The instance of the FirewallRule class.</p>
<hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/gpoa/frontend/appliers/file_cp"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">file_cp</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/gpoa/frontend/appliers/folder"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">folder</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#functiondef-getpropsparam_list" class="table-of-contents__link toc-highlight">FunctionDef getprops(param_list)</a></li><li><a href="#functiondef-get_portsparam_list" class="table-of-contents__link toc-highlight">FunctionDef get_ports(param_list)</a></li><li><a href="#classdef-portstate" class="table-of-contents__link toc-highlight">ClassDef PortState</a></li><li><a href="#classdef-protocol" class="table-of-contents__link toc-highlight">ClassDef Protocol</a></li><li><a href="#classdef-firewallmode" class="table-of-contents__link toc-highlight">ClassDef FirewallMode</a></li><li><a href="#classdef-firewallrule" class="table-of-contents__link toc-highlight">ClassDef FirewallRule</a><ul><li><a href="#functiondef-initself-data" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, data)</a></li><li><a href="#functiondef-applyself" class="table-of-contents__link toc-highlight">FunctionDef apply(self)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/gpoa/backend/samba_backend">Samba Backend</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 BaseALT LTD, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>