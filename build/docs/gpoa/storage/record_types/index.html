<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gpoa/storage/record_types" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">record_types | GPUpdate Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://gpupdate-docs.github.io/docs/gpoa/storage/record_types"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="record_types | GPUpdate Docs"><meta data-rh="true" name="description" content="ClassDef samba_preg"><meta data-rh="true" property="og:description" content="ClassDef samba_preg"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gpupdate-docs.github.io/docs/gpoa/storage/record_types"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/storage/record_types" hreflang="en"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/storage/record_types" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d27c289a.css">
<script src="/assets/js/runtime~main.e7149247.js" defer="defer"></script>
<script src="/assets/js/main.19b81b89.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GPUpdate Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/gpoa/backend/applier_backend">gpoa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/backend/applier_backend">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/frontend/applier_frontend">frontend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/gpt/">gpt</a><button aria-label="Expand sidebar category &#x27;gpt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/plugin/">plugin</a><button aria-label="Expand sidebar category &#x27;plugin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/gpoa/storage/cache">storage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/cache">cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/fs_file_cache">fs_file_cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/gpoa/storage/record_types">record_types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/registry">registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_cache">sqlite_cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_registry">sqlite_registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_registry_compat">sqlite_registry_compat</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/test/frontend/appliers/test_controls">test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/util/">util</a><button aria-label="Expand sidebar category &#x27;util&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools/parsing_chrom_admx_intvalues">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">gpoa</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">storage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">record_types</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>record_types</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-samba_preg">ClassDef samba_preg<a href="#classdef-samba_preg" class="hash-link" aria-label="Direct link to ClassDef samba_preg" title="Direct link to ClassDef samba_preg">​</a></h2>
<p><strong>samba_preg</strong>: The function of samba_preg is to represent an object mapping for HKLM (HKEY_LOCAL_MACHINE) entry in the Windows registry. It holds the properties of a registry key without the SID (Security Identifier).</p>
<p><strong>attributes</strong>:
· <strong>policy_name</strong>: A string that holds the name of the policy associated with the registry key.
· <strong>keyname</strong>: A string that holds the name of the registry key.
· <strong>valuename</strong>: A string that holds the name of the value associated with the registry key.
· <strong>hive_key</strong>: A string that holds the full path of the registry key in the format of <code>{keyname}\{valuename}</code>.
· <strong>type</strong>: An integer that holds the type of the value (e.g., REG_SZ, REG_DWORD, etc.).
· <strong>data</strong>: A string that holds the data associated with the value.</p>
<p><strong>Code Description</strong>:
The samba_preg class is defined as a subclass of the built-in object class. It has an initializer method that takes two parameters, preg_obj and policy_name. preg_obj is an object that contains the properties of a registry key, and policy_name is a string that holds the name of the policy associated with the registry key.</p>
<p>The initializer method assigns the properties of preg_obj and policy_name to the respective attributes of the samba_preg object. It also creates the hive_key attribute by concatenating the keyname and valuename attributes.</p>
<p>The update_fields method returns a dictionary of the attributes that can be updated in the database. These attributes are policy_name, type, and data.</p>
<p><strong>Relationship with its callers in the project</strong>:
The samba_preg class is used in the sqlite_registry class to map the HKLM table in the SQLite database. The sqlite_registry class uses the samba_preg class to perform CRUD (Create, Read, Update, Delete) operations on the HKLM table.</p>
<p>The samba_preg class is used in the add_hklm_entry method of the sqlite_registry class to insert a new entry into the HKLM table. The method takes two parameters, preg_entry and policy_name. preg_entry is an object that contains the properties of a registry key, and policy_name is a string that holds the name of the policy associated with the registry key.</p>
<p>The samba_preg class is also used in the _hklm_upsert method of the sqlite_registry class to update an existing entry in the HKLM table. The method takes a row parameter, which is an instance of the samba_preg class.</p>
<p><strong>Note</strong>:
The samba_preg class is an internal class of the sqlite_registry class and should not be used outside of it.</p>
<p><strong>Output Example</strong>:
Here&#x27;s an example of how to use the samba_preg class in the add_hklm_entry method of the sqlite_registry class:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">preg_obj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;keyname&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Software&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;valuename&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Microsoft&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Windows&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;MyPolicy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">registry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sqlite_registry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;my_database&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_hklm_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">preg_obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, a new entry is inserted into the HKLM table with the keyname &quot;Software&quot;, valuename &quot;Microsoft&quot;, type REG_SZ, and data &quot;Windows&quot;. The policy name associated with the entry is &quot;MyPolicy&quot;.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-preg_obj-policy_name">FunctionDef <strong>init</strong>(self, preg_obj, policy_name)<a href="#functiondef-initself-preg_obj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-preg_obj-policy_name" title="Direct link to functiondef-initself-preg_obj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the samba_preg object with the given parameters.</p>
<p><strong>parameters</strong>:
· <code>preg_obj</code>: An object containing the necessary information for initializing the samba_preg object, such as <code>keyname</code>, <code>valuename</code>, <code>type</code>, and <code>data</code>.
· <code>policy_name</code>: A string representing the name of the policy.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> function initializes the samba_preg object by setting the <code>policy_name</code> attribute to the given <code>policy_name</code> parameter. It then sets the <code>keyname</code>, <code>valuename</code>, <code>type</code>, and <code>data</code> attributes by accessing the corresponding attributes of the <code>preg_obj</code> parameter.</p>
<p>The <code>hive_key</code> attribute is then created by concatenating the <code>keyname</code> and <code>valuename</code> attributes with a backslash in between.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>preg_obj</code> parameter is expected to have the attributes <code>keyname</code>, <code>valuename</code>, <code>type</code>, and <code>data</code>. If it does not have any of these attributes, an <code>AttributeError</code> may be raised.</li>
<li>The <code>policy_name</code> parameter is expected to be a string. If it is not a string, a <code>TypeError</code> may be raised.</li>
<li>The <code>hive_key</code> attribute is a string that represents the key in the registry where the policy data is stored. It is created by concatenating the <code>keyname</code> and <code>valuename</code> attributes with a backslash in between.</li>
<li>The <code>type</code> and <code>data</code> attributes are determined by the <code>preg_obj</code> parameter and are not modified in the <code>__init__</code> function.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create a dictionary of fields with values from the object&#x27;s properties.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The update_fields function initializes a new dictionary called fields. It then adds three key-value pairs to the dictionary, where the keys are &#x27;policy_name&#x27;, &#x27;type&#x27;, and &#x27;data&#x27;, and the values are the corresponding properties of the object. These properties are: self.policy_name, self.type, and self.data. The function then returns the created dictionary.</p>
<p>From a functional perspective, this function is used to prepare a set of fields to be updated in a database. The fields and their values are extracted from an object and returned as a dictionary, which can then be passed to a database query to update the corresponding fields in a record.</p>
<p>The update_fields function is called by the _hklm_upsert function in the sqlite_registry module. The _hklm_upsert function uses the returned dictionary to update a record in the database. If adding a new record fails due to a unique constraint violation, the function retrieves the existing record and updates it with the new values.</p>
<p><strong>Note</strong>: It is important to ensure that the object properties used in the update_fields function are correctly set before calling the function. If any of the properties are None or have not been initialized, the resulting dictionary will contain missing or incorrect values.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_data&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-samba_hkcu_preg">ClassDef samba_hkcu_preg<a href="#classdef-samba_hkcu_preg" class="hash-link" aria-label="Direct link to ClassDef samba_hkcu_preg" title="Direct link to ClassDef samba_hkcu_preg">​</a></h2>
<p><strong>samba_hkcu_preg</strong>: The function of samba_hkcu_preg is to represent an object mapping for HKCU (HKEY_CURRENT_USER) entries in the Windows registry, which are key-value pairs with a Security Identifier (SID).</p>
<p><strong>attributes</strong>:
· <code>sid</code>: A string representing the SID of the user associated with the HKCU entry.
· <code>policy_name</code>: A string specifying the name of the policy applied to the HKCU entry.
· <code>keyname</code>: A string representing the name of the registry key.
· <code>valuename</code>: A string representing the name of the registry value.
· <code>hive_key</code>: A string formed by concatenating <code>keyname</code> and <code>valuename</code> with a backslash, representing the full path of the registry key-value pair.
· <code>type</code>: An integer representing the data type of the registry value.
· <code>data</code>: A string representing the data stored in the registry value.</p>
<p><strong>Code Description</strong>:
The samba_hkcu_preg class is defined with an initializer method that takes <code>sid</code>, <code>preg_obj</code>, and <code>policy_name</code> as parameters. The <code>preg_obj</code> parameter is an instance of the <code>Preg</code> class from the <code>samba.net</code> package, which contains the registry key-value pair information. The initializer method extracts the necessary information from <code>preg_obj</code> and assigns it to the class attributes.</p>
<p>The <code>update_fields</code> method returns a dictionary containing the <code>policy_name</code>, <code>type</code>, and <code>data</code> attributes of the class. This method is used when updating the database with new or modified HKCU entries.</p>
<p><strong>Relationship with its callers in the project</strong>:
The samba_hkcu_preg class is primarily used in the <code>gpoa/storage/sqlite_registry.py</code> module, where it is mapped to the <code>HKCU</code> table in a SQLite database using SQLAlchemy&#x27;s Object-Relational Mapping (ORM) functionality. The <code>_hkcu_upsert</code>, <code>_delete_hkcu_keyname</code>, <code>add_hkcu_entry</code>, <code>get_hkcu_entry</code>, <code>filter_hkcu_entries</code>, and <code>wipe_user</code> functions in the <code>sqlite_registry</code> class interact with the samba_hkcu_preg class to perform CRUD (Create, Read, Update, Delete) operations on the HKCU entries in the SQLite database.</p>
<p><strong>Note</strong>:
When using the samba_hkcu_preg class, ensure that the <code>sid</code>, <code>keyname</code>, and <code>valuename</code> attributes are correctly set according to the target HKCU entry in the Windows registry. Additionally, the <code>policy_name</code> attribute should be set to the appropriate policy name for the entry.</p>
<p><strong>Output Example</strong>:
A possible appearance of the code&#x27;s return value:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hkcu_entry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> samba_hkcu_preg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;S-1-5-21-123456789-0123456789-123456789-12345&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> preg_obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;MyPolicy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hkcu_entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hive_key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: HKCU\MyValue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hkcu_entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: 1 (REG_SZ)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hkcu_entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: &#x27;Hello, World!&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-preg_obj-policy_name">FunctionDef <strong>init</strong>(self, sid, preg_obj, policy_name)<a href="#functiondef-initself-sid-preg_obj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-preg_obj-policy_name" title="Direct link to functiondef-initself-sid-preg_obj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the samba_hkcu_preg object with the necessary parameters.</p>
<p><strong>parameters</strong>:
· sid: The SID (Security Identifier) for which the policy is being set.
· preg_obj: An object of the preg class, which contains the keyname, valuename, type, and data necessary for creating the hive_key.
· policy_name: The name of the policy being set.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the samba_hkcu_preg object by setting the values of its attributes. The <code>self.sid</code> attribute is set to the provided sid parameter. The <code>self.policy_name</code> attribute is set to the provided policy_name parameter. The <code>self.keyname</code> and <code>self.valuename</code> attributes are set to the keyname and valuename attributes of the preg_obj parameter, respectively. The <code>self.hive_key</code> attribute is then set to the concatenation of <code>self.keyname</code> and <code>self.valuename</code>, with a backslash () as a separator. The <code>self.type</code> and <code>self.data</code> attributes are set to the type and data attributes of the preg_obj parameter, respectively.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>preg_obj</code> parameter should be an object of the <code>preg</code> class, with the attributes <code>keyname</code>, <code>valuename</code>, <code>type</code>, and <code>data</code>.</li>
<li>The <code>sid</code> and <code>policy_name</code> parameters should be strings.</li>
<li>The <code>hive_key</code> attribute is a combination of <code>keyname</code> and <code>valuename</code> and is used to access the registry key in windows.</li>
<li>The <code>type</code> attribute is the type of the registry value, and the <code>data</code> attribute is the value of the registry key.</li>
<li>The <code>self.hive_key</code> is a formatted string which is used to access the registry key in windows.</li>
<li>The <code>self.type</code> and <code>self.data</code> are used to set the value of the registry key in windows.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-1">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-1" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create and return a dictionary containing the policy name, type, and data.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The update_fields function first initializes an empty dictionary called fields. It then assigns the values of the policy_name, type, and data attributes of the object that calls this function to the keys &#x27;policy_name&#x27;, &#x27;type&#x27;, and &#x27;data&#x27; of the fields dictionary, respectively. Finally, the function returns the fields dictionary.</p>
<p>This function is used to prepare the data to be updated in the database. It is called by the _hkcu_upsert function in the sqlite_registry module, which updates the corresponding record in the database with the data returned by the update_fields function.</p>
<p><strong>Note</strong>: It is important to note that this function assumes that the object that calls it has the attributes &#x27;policy_name&#x27;, &#x27;type&#x27;, and &#x27;data&#x27;. If these attributes do not exist, the function will raise an AttributeError.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_data&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-ad_shortcut">ClassDef ad_shortcut<a href="#classdef-ad_shortcut" class="hash-link" aria-label="Direct link to ClassDef ad_shortcut" title="Direct link to ClassDef ad_shortcut">​</a></h2>
<p><strong>ad_shortcut</strong>: The function of ad_shortcut is to represent Windows shortcut objects in a mapping format.</p>
<p><strong>attributes</strong>:
· sid: A unique identifier for the shortcut&#x27;s owner.
· policy_name: The name of the policy associated with the shortcut.
· path: The path of the shortcut.
· shortcut: A JSON representation of the shortcut.</p>
<p><strong>Code Description</strong>:
The ad_shortcut class is a mapping representation of a Windows shortcut object. It has four attributes: sid, policy_name, path, and shortcut. The sid attribute is a unique identifier for the shortcut&#x27;s owner, policy_name is the name of the policy associated with the shortcut, path is the path of the shortcut, and shortcut is a JSON representation of the shortcut.</p>
<p>The class has two methods:</p>
<ol>
<li><strong>__init__</strong>: This is the constructor method that initializes the attributes of the class. It takes three parameters: sid, sc, and policy_name. The sid parameter is the unique identifier for the shortcut&#x27;s owner, sc is an object of the Shortcut class, and policy_name is the name of the policy associated with the shortcut.</li>
<li><strong>update_fields</strong>: This method returns a dictionary of the class&#x27;s attributes. It is used in the sqlite_registry module to update the shortcut information in the database.</li>
</ol>
<p>The ad_shortcut class is used in the sqlite_registry module to store and retrieve shortcut information in the database. The sqlite_registry module creates a table for the shortcuts and maps the ad_shortcut class to the table using the mapper_reg object. The add_shortcut method in the sqlite_registry module uses the ad_shortcut class to store shortcut information in the database. The get_shortcuts method in the sqlite_registry module uses the ad_shortcut class to retrieve shortcut information from the database.</p>
<p><strong>Note</strong>:
The ad_shortcut class is not meant to be used independently. It is used in the sqlite_registry module to store and retrieve shortcut information in the database.</p>
<p><strong>Output Example</strong>:
Here is an example of how the ad_shortcut class is used in the sqlite_registry module to store shortcut information in the database:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;12345678-1234-1234-1234-1234567890ab&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Shortcut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;C:\\Users\\User\\Desktop\\shortcut.lnk&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;My Policy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">registry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sqlite_registry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;my_registry&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_shortcut</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the add_shortcut method in the sqlite_registry module is used to store shortcut information in the database using the ad_shortcut class. The sid parameter is a unique identifier for the shortcut&#x27;s owner, sc is an object of the Shortcut class representing the shortcut, and policy_name is the name of the policy associated with the shortcut.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-sc-policy_name">FunctionDef <strong>init</strong>(self, sid, sc, policy_name)<a href="#functiondef-initself-sid-sc-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-sc-policy_name" title="Direct link to functiondef-initself-sid-sc-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the ad_shortcut object with the necessary attributes.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the shortcut.
· sc: An object of a class that has the attributes &#x27;dest&#x27; and &#x27;to_json()&#x27; method.
· policy_name: The name of the policy associated with the shortcut.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the ad_shortcut object by setting the &#x27;sid&#x27; attribute to the provided sid, &#x27;policy_name&#x27; attribute to the provided policy_name, and &#x27;path&#x27; attribute to the &#x27;dest&#x27; attribute of the provided sc object. It also calls the &#x27;to_json()&#x27; method of the sc object and sets the result to the &#x27;shortcut&#x27; attribute.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The provided sc object should have the attributes &#x27;dest&#x27; and &#x27;to_json()&#x27; method, otherwise, it will raise an error.</li>
<li>The &#x27;sid&#x27; and &#x27;policy_name&#x27; should be of string type, while the sc object can be of any type that fulfills the above-mentioned conditions.</li>
<li>The &#x27;path&#x27; attribute will be assigned the value of the &#x27;dest&#x27; attribute of the sc object, and the &#x27;shortcut&#x27; attribute will be assigned the json representation of the sc object.</li>
<li>This function is used to create an instance of the ad_shortcut class, and it is called automatically when an instance is created.</li>
<li>It is a good practice to initialize all the necessary attributes in the <strong>init</strong> function to ensure that the object is in a consistent state when it is created.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-2">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-2" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create and return a dictionary containing the policy_name, path, and shortcut attributes of an ad_shortcut object.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:
The function first initializes an empty dictionary called fields (line 2). It then adds three key-value pairs to the dictionary. The keys are &#x27;policy_name&#x27;, &#x27;path&#x27;, and &#x27;shortcut&#x27; and the values are the corresponding attribute values of the ad_shortcut object that calls this function (lines 3-5). Finally, the function returns the populated dictionary (line 6).</p>
<p>This function is used to prepare the data for updating a record in the database. By returning a dictionary, it allows for dynamic updates of the database record without specifying the column names explicitly.</p>
<p>From a functional perspective, this function plays a crucial role in the _shortcut_upsert function in the sqlite_registry module. Specifically, it is used to update the existing record in the database when an attempt to add a new record fails due to a unique constraint violation (lines 4-5 in the _shortcut_upsert function).</p>
<p><strong>Note</strong>:
It is important to note that this function does not modify the state of the ad_shortcut object that calls it. Instead, it creates a new dictionary object that contains the relevant attribute values.</p>
<p><strong>Output Example</strong>:
Here is an example of the output of the update_fields function:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/example/path&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;shortcut&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This output can then be used to update the corresponding record in the database.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-info_entry">ClassDef info_entry<a href="#classdef-info_entry" class="hash-link" aria-label="Direct link to ClassDef info_entry" title="Direct link to ClassDef info_entry">​</a></h2>
<p><strong>info_entry</strong>: The function of info_entry is to represent a piece of information with a name and a value.</p>
<p><strong>attributes</strong>:
· name: A string that serves as the unique identifier for this information.
· value: The content of this information, which can be any Python object.</p>
<p><strong>Code Description</strong>:
The <code>info_entry</code> class has two methods: <code>__init__</code> and <code>update_fields</code>. The <code>__init__</code> method initializes the object with a given name and value, and <code>update_fields</code> returns a dictionary containing the current value of the object.</p>
<p>The <code>info_entry</code> class is used in the <code>gpoa/storage/sqlite_registry.py</code> module to store information in a SQLite database. Specifically, it is used to store global policy settings for a system. The <code>set_info</code> and <code>get_info</code> methods in the <code>sqlite_registry</code> class handle the insertion and retrieval of <code>info_entry</code> objects in the database.</p>
<p>When a new <code>info_entry</code> object is created, it is first attempted to be inserted into the database using the <code>_add</code> method in the <code>sqlite_registry</code> class. If the insertion fails (e.g., due to a unique constraint violation), the existing object with the same name is updated instead. This behavior is handled by the <code>_info_upsert</code> method in the <code>sqlite_registry</code> class.</p>
<p><strong>Note</strong>:
When creating a new <code>info_entry</code> object, make sure the name is unique among all other <code>info_entry</code> objects in the database. Otherwise, an exception will be raised.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Creating a new info_entry object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ie </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;background_color&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;red&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Updating the value of the object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ie</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;blue&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Retrieving the value of the object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ie</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update_fields</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;value&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: &#x27;blue&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This example shows how to create a new <code>info_entry</code> object, update its value, and retrieve the updated value.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-name-value">FunctionDef <strong>init</strong>(self, name, value)<a href="#functiondef-initself-name-value" class="hash-link" aria-label="Direct link to functiondef-initself-name-value" title="Direct link to functiondef-initself-name-value">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize an info_entry object with a name and a value.</p>
<p><strong>parameters</strong>:
· name: (required) A string that represents the name of the info_entry object.
· value: (required) A value that the info_entry object will hold. This can be any data type.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> function is a special method in Python classes, called when an object is created from the class. It is used to initialize the attributes of the object.</p>
<p>In this particular <code>__init__</code> function, two attributes are being initialized: <code>name</code> and <code>value</code>. The <code>name</code> attribute is set to the value of the <code>name</code> parameter, and the <code>value</code> attribute is set to the value of the <code>value</code> parameter.</p>
<p>Here is a breakdown of the function:</p>
<ul>
<li><code>def __init__(self, name, value):</code> This line is defining the <code>__init__</code> function, which takes three parameters: <code>self</code>, <code>name</code>, and <code>value</code>. <code>self</code> is a reference to the current instance of the class and is used to access variables and methods associated with that instance.</li>
<li><code>self.name = name</code>: This line is setting the <code>name</code> attribute of the <code>self</code> object to the value of the <code>name</code> parameter.</li>
<li><code>self.value = value</code>: This line is setting the <code>value</code> attribute of the <code>self</code> object to the value of the <code>value</code> parameter.</li>
</ul>
<p><strong>Note</strong>:
The <code>name</code> and <code>value</code> parameters are required when creating an <code>info_entry</code> object. If <code>name</code> or <code>value</code> is not provided, a <code>TypeError</code> will be raised.</p>
<p>Here is an example of how to use the <code>__init__</code> function to create an <code>info_entry</code> object:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">entry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> info_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;example_name&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_value&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, an <code>info_entry</code> object named <code>entry</code> is being created with a <code>name</code> of &#x27;example_name&#x27; and a <code>value</code> of &#x27;example_value&#x27;.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-3">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-3" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create a dictionary of field-value pairs to be used for updating records in a database.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The update_fields function first initializes an empty dictionary called fields. Then, it adds a key-value pair to the dictionary with the key &#x27;value&#x27; and the value being the value attribute of the object that calls this function. Finally, the function returns the filled dictionary.</p>
<p>The purpose of this function is to prepare the data for updating records in a database. The dictionary returned by this function will be used as the input for the update() method of a SQLAlchemy query object, which will update the records in the database with the new values.</p>
<p>From a functional perspective, this function plays a crucial role in the _info_upsert function in the sqlite_registry module. The _info_upsert function is responsible for inserting or updating records in the database. When there is an attempt to insert a record with a name that already exists in the database, the _info_upsert function catches the resulting exception and calls the update_fields function to prepare the data for updating the existing record.</p>
<p><strong>Note</strong>: It is important to note that the update_fields function is designed to be used as a method of an object that has a &#x27;value&#x27; attribute. If this function is called on an object that does not have a &#x27;value&#x27; attribute, it will result in a KeyError.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-printer_entry">ClassDef printer_entry<a href="#classdef-printer_entry" class="hash-link" aria-label="Direct link to ClassDef printer_entry" title="Direct link to ClassDef printer_entry">​</a></h2>
<p><strong>printer_entry</strong>: The <code>printer_entry</code> class is used to represent Windows printer configurations in the form of an object mapping.</p>
<p><strong>attributes</strong>:
· <code>sid</code>: A string representing the security identifier (SID) of the user or group associated with the printer.
· <code>policy_name</code>: A string representing the name of the policy associated with the printer.
· <code>name</code>: A string representing the name of the printer.
· <code>printer</code>: A JSON string representing the printer&#x27;s configuration.</p>
<p><strong>Code Description</strong>:
The <code>printer_entry</code> class has two methods: <code>__init__</code> and <code>update_fields</code>. The <code>__init__</code> method initializes the object with the given SID, printer object, and policy name. It sets the <code>sid</code>, <code>policy_name</code>, <code>name</code>, and <code>printer</code> attributes of the object. The <code>update_fields</code> method returns a dictionary containing the current values of the <code>policy_name</code>, <code>name</code>, and <code>printer</code> attributes.</p>
<p>The <code>printer_entry</code> class is used in the <code>sqlite_registry</code> class to store and retrieve printer configurations from a SQLite database. When a new printer configuration is added to the database, the <code>add_printer</code> method of the <code>sqlite_registry</code> class creates a new <code>printer_entry</code> object with the given SID, printer object, and policy name. It then calls the <code>_printer_upsert</code> method to either add the new object to the database or update an existing object with the same SID and name.</p>
<p>The <code>get_printers</code> method of the <code>sqlite_registry</code> class returns a list of <code>printer_entry</code> objects associated with the given SID. The <code>wipe_user</code> method of the <code>sqlite_registry</code> class deletes all <code>printer_entry</code> objects associated with the given SID from the database.</p>
<p><strong>Note</strong>:
When creating a new <code>printer_entry</code> object, make sure to pass in a valid printer object with a <code>name</code> attribute.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-pobj-policy_name">FunctionDef <strong>init</strong>(self, sid, pobj, policy_name)<a href="#functiondef-initself-sid-pobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-pobj-policy_name" title="Direct link to functiondef-initself-sid-pobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the printer entry object with the required parameters.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the printer entry object.
· pobj: An object of the printer class, which needs to be converted to JSON format.
· policy_name: The name of the policy associated with the printer entry.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the printer entry object by setting the values of three attributes: sid, policy_name, and name. The sid and policy_name attributes are directly assigned the values of the input parameters. The name attribute is assigned the name property of the pobj parameter, which is expected to be an object of the printer class. The printer attribute is assigned the JSON representation of the pobj parameter, which is obtained by calling its to_json() method.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The pobj parameter must be an instance of the printer class, and it must have a to_json() method that returns a JSON representation of the object.</li>
<li>The sid and policy_name parameters must be strings.</li>
<li>The name attribute is derived from the pobj parameter, so any changes to the name property of the printer object after creating the printer entry object will not be reflected in the printer entry object.</li>
<li>The printer attribute is a JSON representation of the printer object, so it cannot be used to access the methods or properties of the printer object directly. It can only be used to access the data attributes of the printer object.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-4">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-4" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create and return a dictionary containing the policy name, name, and printer in JSON format.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:
The function first initializes an empty dictionary called fields (line 2). It then adds three key-value pairs to this dictionary. The keys are &#x27;policy_name&#x27;, &#x27;name&#x27;, and &#x27;printer&#x27; and the values are obtained from the object&#x27;s &#x27;policy_name&#x27; attribute, &#x27;name&#x27; attribute, and &#x27;printer&#x27; attribute respectively (lines 3-5). The &#x27;printer&#x27; attribute is converted to a JSON format using the &#x27;to_json&#x27; method before being added to the dictionary.
The function finally returns the &#x27;fields&#x27; dictionary (line 6).</p>
<p>From a functional perspective, this function is used to prepare the data for updating a printer entry in the database. The returned dictionary is used as an argument for the &#x27;update&#x27; method of the SQLAlchemy query object in the &#x27;_printer_upsert&#x27; method of the &#x27;sqlite_registry&#x27; object.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The function does not perform any error checking or exception handling. It assumes that the object&#x27;s attributes have been properly initialized and contain valid values.</li>
<li>The function returns a dictionary, which is a mutable data type. Therefore, any changes made to this dictionary after it has been returned by the function will affect the original dictionary.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-drive_entry">ClassDef drive_entry<a href="#classdef-drive_entry" class="hash-link" aria-label="Direct link to ClassDef drive_entry" title="Direct link to ClassDef drive_entry">​</a></h2>
<p><strong>drive_entry</strong>: The function of drive_entry is to represent Samba share bound to drive letter as an object mapping.</p>
<p><strong>attributes</strong>:
· sid: The security identifier (SID) of the user or group to which the drive mapping applies.
· dobj: An object containing login, password, dir, path, action, thisDrive, allDrives, label, persistent, and useLetter attributes.
· policy_name: The name of the policy that the drive mapping belongs to.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the object with the given SID, an object containing various drive mapping attributes, and a policy name. It assigns the attributes of the given object to the corresponding attributes of the drive_entry object.</p>
<p>The <code>update_fields</code> method creates a dictionary of the object&#x27;s attributes for updating or inserting records in the database.</p>
<p>This class is used in the <code>sqlite_registry</code> class to manage drive mappings in a SQLite database. The <code>add_drive</code> method of <code>sqlite_registry</code> creates a new drive_entry object and inserts or updates it in the database using the <code>_drive_upsert</code> method. The <code>get_drives</code> method retrieves drive mappings for a given SID from the database. The <code>wipe_user</code> method deletes drive mappings associated with a given SID from the database.</p>
<p><strong>Note</strong>:
Ensure that the <code>dobj</code> parameter contains all necessary attributes for creating a drive_entry object.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">drive_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;login&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;dir&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;C:\\&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\\\\server\\share&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;A&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;thisDrive&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;C&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;allDrives&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;label&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;My Share&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;persistent&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;True&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;useLetter&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;True&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;My Policy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This creates a drive_entry object with the specified SID, drive mapping attributes, and policy name.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-dobj-policy_name">FunctionDef <strong>init</strong>(self, sid, dobj, policy_name)<a href="#functiondef-initself-sid-dobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-dobj-policy_name" title="Direct link to functiondef-initself-sid-dobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the drive_entry object with the given parameters.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the drive entry.
· dobj: An object containing drive information, such as login, password, directory, etc.
· policy_name: The name of the policy associated with this drive entry.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the drive_entry object by setting its attributes with the given parameters. The sid, policy_name, and the attributes of the dobj object (login, password, dir, path, action, thisDrive, allDrives, label, persistent, useLetter) are assigned to the corresponding attributes of the drive_entry object. This allows the drive_entry object to have its own copies of these attributes, which can be used and modified independently of the original dobj object.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The sid and policy_name are required parameters, while dobj is also expected to have the necessary attributes for the drive_entry object to be properly initialized.</li>
<li>The drive_entry object is initialized with a reference to the original dobj object, allowing it to access and modify the original drive information if necessary.</li>
<li>The drive_entry object can be used to represent a drive with a specific policy name and sid, and can be used to perform actions on the drive, such as mounting or unmounting, based on the policy associated with it.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-5">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-5" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to create a dictionary of the object&#x27;s attributes.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>: The update_fields function is a method of the drive_entry class, which is used to create a dictionary of the object&#x27;s attributes. It initializes an empty dictionary called fields and then assigns the values of the object&#x27;s attributes to the corresponding keys in the dictionary. The keys in the dictionary are policy_name, login, password, dir, path, action, thisDrive, allDrives, label, persistent, and useLetter. These keys correspond to the attribute names of the drive_entry object. The function then returns the dictionary containing the object&#x27;s attributes.</p>
<p>This function is used by the _drive_upsert function in the sqlite_registry class to update the existing record in the database with the new values of the object&#x27;s attributes. The _drive_upsert function filters the record in the database based on the sid and dir attributes of the object and then updates the record with the new values returned by the update_fields function.</p>
<p><strong>Note</strong>: It is important to note that the update_fields function is only used internally within the gpoa project and should not be called directly. Also, the function assumes that the object has the necessary attributes, and if any attribute is missing, it will result in a KeyError.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;user&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pass&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;dir&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/example_dir&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/example_path&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_action&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;thisDrive&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;allDrives&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;label&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_label&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;persistent&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;useLetter&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-folder_entry">ClassDef folder_entry<a href="#classdef-folder_entry" class="hash-link" aria-label="Direct link to ClassDef folder_entry" title="Direct link to ClassDef folder_entry">​</a></h2>
<p><strong>folder_entry</strong>: The function of folder_entry is to represent a file system directory as an object mapping.</p>
<p><strong>attributes</strong>:
· sid: A string that represents the security identifier (SID) of the user or group associated with the directory.
· policy_name: A string that represents the name of the policy associated with the directory.
· path: A string that represents the path of the directory.
· action: A string that represents the action to be taken on the directory.
· delete_folder: A string that represents whether the folder should be deleted or not.
· delete_sub_folders: A string that represents whether the sub-folders of the folder should be deleted or not.
· delete_files: A string that represents whether the files in the folder should be deleted or not.
· hidden_folder: A string that represents whether the folder should be hidden or not.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the folder_entry object with the given SID, fobj (file object), and policy_name. It sets the attributes of the object based on the corresponding attributes of the fobj.</p>
<p>The <code>update_fields</code> method returns a dictionary of the fields that need to be updated for the folder_entry object.</p>
<p><strong>Relationship with its callers in the project</strong>:
The folder_entry class is used in the sqlite_registry class to map the &#x27;Folders&#x27; table in the SQLite database. The <code>add_folder</code> method in sqlite_registry creates a new folder_entry object and adds it to the database. The <code>get_folders</code> method in sqlite_registry returns a list of folder_entry objects associated with the given SID.</p>
<p><strong>Note</strong>:
The <code>update_fields</code> method returns a dictionary of the fields that need to be updated for the folder_entry object. However, it does not update the object itself. The developer should use this dictionary to update the object as per their requirements.</p>
<p><strong>Output Example</strong>:
Here is a possible appearance of the code&#x27;s return value when calling the <code>update_fields</code> method:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;example_action&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;delete_folder&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;delete_sub_folders&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;delete_files&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hidden_folder&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-fobj-policy_name">FunctionDef <strong>init</strong>(self, sid, fobj, policy_name)<a href="#functiondef-initself-sid-fobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-fobj-policy_name" title="Direct link to functiondef-initself-sid-fobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the properties of a folder_entry object in the storage module of the gpoa project.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the object.
· fobj: An instance of a class that contains information about the file object.
· policy_name: A string representing the name of the policy associated with the file object.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the properties of a folder_entry object by setting the values of its attributes. The attributes include sid, policy_name, path, action, delete_folder, delete_sub_folders, delete_files, and hidden_folder.</p>
<p>The sid attribute is assigned the value of the sid parameter, which is a unique identifier for the object. The policy_name attribute is assigned the value of the policy_name parameter, which is a string representing the name of the policy associated with the file object.</p>
<p>The path attribute is assigned the value of the path attribute of the fobj parameter, which is an instance of a class that contains information about the file object. The action attribute is assigned the value of the action attribute of the fobj parameter, which is obtained by calling the value method on the action attribute.</p>
<p>The delete_folder, delete_sub_folders, delete_files, and hidden_folder attributes are assigned the string values of the corresponding attributes of the fobj parameter. These attributes are obtained by calling the str function on the corresponding attributes of the fobj parameter.</p>
<p><strong>Note</strong>:
· The sid parameter must be a unique identifier for the object.
· The fobj parameter must be an instance of a class that contains information about the file object.
· The policy_name parameter must be a string representing the name of the policy associated with the file object.
· The path, action, delete_folder, delete_sub_folders, delete_files, and hidden_folder attributes are initialized with the values of the corresponding attributes of the fobj parameter.
· The action attribute is obtained by calling the value method on the action attribute of the fobj parameter.
· The delete_folder, delete_sub_folders, delete_files, and hidden_folder attributes are assigned the string values of the corresponding attributes of the fobj parameter.
· The path attribute is assigned the value of the path attribute of the fobj parameter.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-6">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-6" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a list of fields to be updated.</p>
<p><strong>parameters</strong>: This function does not take any parameters as it operates on the instance attributes of the class.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-envvar_entry">ClassDef envvar_entry<a href="#classdef-envvar_entry" class="hash-link" aria-label="Direct link to ClassDef envvar_entry" title="Direct link to ClassDef envvar_entry">​</a></h2>
<p><strong>envvar_entry</strong>: The function of envvar_entry is to represent environment variables in an object mapping format.</p>
<p><strong>attributes</strong>:
· sid: A string representing the SID (Security Identifier) of the user or group.
· policy_name: A string representing the name of the policy.
· name: A string representing the name of the environment variable.
· value: A string representing the value of the environment variable.
· action: A string representing the action to be taken on the environment variable (e.g., create, delete, update).</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the envvar_entry object with the given SID, policy_name, evobj (environment variable object), name, value, and action. The <code>update_fields</code> method returns a dictionary of fields to be updated, including policy_name, action, and value.</p>
<p>The envvar_entry object is used in the sqlite_registry class to manage environment variables in a SQLite database. The <code>add_envvar</code> method in sqlite_registry creates a new envvar_entry object and adds it to the database. If an exception occurs during the addition, the method updates the existing envvar_entry object with the same name and SID. The <code>get_envvars</code> method in sqlite_registry returns a list of envvar_entry objects with the given SID.</p>
<p><strong>Note</strong>:
It is important to note that the envvar_entry object is not intended to be used independently but as part of the sqlite_registry class. The <code>update_fields</code> method is used internally in the sqlite_registry class and should not be called directly.</p>
<p><strong>Output Example</strong>:
A possible appearance of the code&#x27;s return value when calling the <code>get_envvars</code> method in sqlite_registry with a given SID:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    envvar_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;S-1-5-21-123456789-123456789-123456789-12345&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test_policy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;TEST_VAR&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test_value&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;create&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    envvar_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;S-1-5-21-123456789-123456789-123456789-12345&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test_policy2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;TEST_VAR2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test_value2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;create&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-evobj-policy_name">FunctionDef <strong>init</strong>(self, sid, evobj, policy_name)<a href="#functiondef-initself-sid-evobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-evobj-policy_name" title="Direct link to functiondef-initself-sid-evobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the envvar_entry object with the necessary attributes.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the environment variable entry.
· evobj: An object containing the name, value, and action of the environment variable.
· policy_name: The name of the policy associated with the environment variable entry.</p>
<p><strong>Code Description</strong>:
The __init__ function initializes an envvar_entry object by setting its attributes. The first attribute set is sid (string), which is the unique identifier for the environment variable entry. The second attribute set is policy_name (string), which is the name of the policy associated with the environment variable entry.</p>
<p>The next attribute set, name (string), is obtained from the evobj parameter. The evobj parameter is an object that contains the name, value, and action of the environment variable. By accessing evobj.name, the function sets the name attribute of the envvar_entry object to the name of the environment variable.</p>
<p>Similarly, the value (string) and action (string) attributes are set for the envvar_entry object. The value attribute is obtained by accessing evobj.value, and the action attribute is obtained by accessing evobj.action.value.</p>
<p><strong>Note</strong>:
· The sid, policy_name, name, and value attributes are mandatory and should be provided during the initialization of the envvar_entry object.
· The action attribute is optional and can be omitted during initialization. If provided, it should be a string value.
· The evobj parameter should be an object containing the name, value, and action attributes.
· The name, value, and action attributes of the evobj parameter should be strings.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-7">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-7" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a dictionary of fields to be updated, including &#x27;policy_name&#x27;, &#x27;action&#x27;, and &#x27;value&#x27;.</p>
<p><strong>parameters</strong>: This function does not take any parameters.</p>
<p><strong>Code Description</strong>:
The function update_fields is a method of the envvar_entry class, which is used to create and return a dictionary of fields to be updated. It initializes an empty dictionary called fields and then assigns the values of &#x27;policy_name&#x27;, &#x27;action&#x27;, and &#x27;value&#x27; to this dictionary. These values are obtained from the instance variables of the envvar_entry object. The function then returns the fields dictionary.</p>
<p>From a functional perspective, the update_fields method is called by the add_envvar method of the sqlite_registry class. If an exception occurs during the execution of the add_envvar method, the filter_sid_obj method is called, which filters the objects based on the &#x27;sid&#x27; and &#x27;name&#x27; attributes. The update method is then called, which updates the fields of the filtered objects using the fields dictionary returned by the update_fields method.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The update_fields method is an internal method of the envvar_entry class and should not be called directly.</li>
<li>The method is designed to return a dictionary of fields to be updated, and it does not modify any objects or data in the system.</li>
</ul>
<p><strong>Output Example</strong>:</p>
<p>The output of the update_fields method is a dictionary that looks like this:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;policy_name&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;policy_name_value&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action_value&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;value&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;value_value&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Where &#x27;policy_name_value&#x27;, &#x27;action_value&#x27;, and &#x27;value_value&#x27; are the actual values of the instance variables of the envvar_entry object.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-script_entry">ClassDef script_entry<a href="#classdef-script_entry" class="hash-link" aria-label="Direct link to ClassDef script_entry" title="Direct link to ClassDef script_entry">​</a></h2>
<p><strong>script_entry</strong>: The function of script_entry is to represent scripts.ini objects with their corresponding attributes.</p>
<p><strong>attributes</strong>:
· sid: A unique identifier for the script entry.
· policy_name: The name of the policy associated with the script.
· action: The action associated with the script.
· number: The number associated with the script.
· path: The path associated with the script.
· arg: The argument associated with the script.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the script_entry object with the given parameters. It sets the attributes of the object to the input parameters.</p>
<p>The <code>update_fields</code> method returns a dictionary of the fields to update for the script_entry object. It creates a dictionary with the field names as keys and the corresponding attribute values as values.</p>
<p>This class is used in the <code>gpoa/storage/sqlite_registry.py</code> module to map the script entries to the database using SQLAlchemy&#x27;s ORM (Object-Relational Mapping) functionality. The <code>add_script</code> method in the <code>sqlite_registry</code> class creates a new <code>script_entry</code> object and adds it to the database. The <code>get_scripts</code> method retrieves the script entries associated with a given user and action from the database. The <code>wipe_user</code> method deletes the script entries associated with a given user from the database.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>update_fields</code> method returns a dictionary of fields to update, but it is not currently used in the code.</li>
<li>The <code>script_entry</code> class is used as a mapping object for the scripts table in the database.</li>
</ul>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;123456&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test_policy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scrobj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test_action&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;number&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;path&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/script&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;args&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test_args&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">script_entry_obj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> script_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scrobj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fields </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> script_entry_obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update_fields</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: {&#x27;policy_name&#x27;: &#x27;test_policy&#x27;, &#x27;action&#x27;: &#x27;test_action&#x27;, &#x27;number&#x27;: &#x27;1&#x27;, &#x27;path&#x27;: &#x27;/path/to/script&#x27;, &#x27;arg&#x27;: &#x27;test_args&#x27;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will create a new <code>script_entry</code> object with the given parameters and print the fields dictionary.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-scrobj-policy_name">FunctionDef <strong>init</strong>(self, sid, scrobj, policy_name)<a href="#functiondef-initself-sid-scrobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-scrobj-policy_name" title="Direct link to functiondef-initself-sid-scrobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the script_entry object with the necessary attributes.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the script entry.
· scrobj: An object containing the action, number, path, and args attributes.
· policy_name: The name of the policy associated with the script entry.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the script_entry object by setting its attributes. The sid and policy_name attributes are directly assigned to the input parameters. The action, number, path, and arg attributes are assigned from the scrobj object&#x27;s attributes. This allows the script_entry object to have its own copy of these attributes, rather than referencing the scrobj object directly.</p>
<p><strong>Note</strong>:
It is important to ensure that the scrobj object has the necessary attributes (action, number, path, and args) before creating a script_entry object. If any of these attributes are missing, a ValueError may be raised during initialization. Additionally, the sid and policy_name parameters should be valid strings to avoid any unexpected behavior.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-8">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-8" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a list of fields to be updated.</p>
<p><strong>parameters</strong>: This function does not take any parameters as it operates on the instance attributes of the script_entry object.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-file_entry">ClassDef file_entry<a href="#classdef-file_entry" class="hash-link" aria-label="Direct link to ClassDef file_entry" title="Direct link to ClassDef file_entry">​</a></h2>
<p><strong>file_entry</strong>: The function of file_entry is to represent an object mapping for FILES.XML.</p>
<p><strong>attributes</strong>:
· sid: The unique identifier of the user or group.
· fileobj: An object containing file-related information.
· policy_name: The name of the policy associated with the file.</p>
<p><strong>Code Description</strong>:
The <code>file_entry</code> class is a mapping of an object representing FILES.XML. It takes three parameters during initialization: <code>sid</code>, <code>fileobj</code>, and <code>policy_name</code>. The <code>sid</code> parameter is the unique identifier of the user or group, <code>fileobj</code> is an object containing file-related information, and <code>policy_name</code> is the name of the policy associated with the file.</p>
<p>The <code>__init__</code> method initializes the object with the given parameters and assigns them to the respective instance variables.</p>
<p>The <code>update_fields</code> method returns a dictionary of fields to update, which includes all the instance variables of the <code>file_entry</code> object.</p>
<p><strong>Relationship with its callers in the project</strong>:
The <code>file_entry</code> class is used in the <code>sqlite_registry</code> class in the <code>add_file</code> and <code>get_files</code> methods. In the <code>add_file</code> method, a new <code>file_entry</code> object is created and added to the database. In the <code>get_files</code> method, the method returns a filtered list of <code>file_entry</code> objects based on the given <code>sid</code>.</p>
<p>The <code>file_entry</code> class is also used in the <code>wipe_user</code> method of the <code>sqlite_registry</code> class, where it is used to wipe all the file entries associated with the given <code>sid</code>.</p>
<p><strong>Note</strong>:
The <code>file_entry</code> class is an internal class used for object mapping and should not be used directly by the end-users.</p>
<p><strong>Output Example</strong>:
Here&#x27;s an example of how the <code>file_entry</code> object might look like:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">file_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1234567890&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fileobj</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;copy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;fromPath&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;targetPath&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/new/path/to/file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;readOnly&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;archive&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hidden&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;suppress&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;executable&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;MyPolicy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This object represents a file entry with the <code>sid</code> of <code>1234567890</code>, associated with the <code>MyPolicy</code> policy, and has the file-related information of copying the file from <code>/path/to/file</code> to <code>/new/path/to/file</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-fileobj-policy_name">FunctionDef <strong>init</strong>(self, sid, fileobj, policy_name)<a href="#functiondef-initself-sid-fileobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-fileobj-policy_name" title="Direct link to functiondef-initself-sid-fileobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the file_entry object with the necessary attributes.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the file entry object.
· fileobj: An object containing file metadata.
· policy_name: The name of the policy associated with the file metadata.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the file_entry object by setting its attributes with the provided parameters. The sid, policy_name, and fileobj parameters are required to create a file_entry object.</p>
<p>The file_entry object&#x27;s attributes include:
· self.sid: The unique identifier for the file entry object, set to the sid parameter.
· self.policy_name: The name of the policy associated with the file metadata, set to the policy_name parameter.
· self.action: The action associated with the file metadata, obtained from the fileobj parameter.
· self.fromPath: The original path of the file, obtained from the fileobj parameter.
· self.targetPath: The target path of the file, obtained from the fileobj parameter.
· self.readOnly: A boolean indicating whether the file is read-only, obtained from the fileobj parameter.
· self.archive: A boolean indicating whether the file should be archived, obtained from the fileobj parameter.
· self.hidden: A boolean indicating whether the file should be hidden, obtained from the fileobj parameter.
· self.suppress: A boolean indicating whether the file should be suppressed, obtained from the fileobj parameter.
· self.executable: A boolean indicating whether the file is executable, obtained from the fileobj parameter.</p>
<p><strong>Note</strong>:
· The fileobj parameter should be an object containing file metadata.
· The sid and policy_name parameters are required to create a file_entry object.
· The file_entry object&#x27;s attributes are set based on the provided parameters.
· Any missing attributes in the fileobj parameter will result in a None value for the corresponding file_entry object attribute.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-9">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-9" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a list of fields to be updated in the file entry object.</p>
<p><strong>parameters</strong>: This function does not take any parameters as it works on the instance attributes of the file_entry object.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-ini_entry">ClassDef ini_entry<a href="#classdef-ini_entry" class="hash-link" aria-label="Direct link to ClassDef ini_entry" title="Direct link to ClassDef ini_entry">​</a></h2>
<p><strong>ini_entry</strong>: The function of ini_entry is to represent an object mapping for INIFILES.XML.</p>
<p><strong>attributes</strong>:
· sid: The security identifier (SID) of the user or group.
· iniobj: An instance of the iniobj class, which contains information about the INI file entries.
· policy_name: The name of the policy.
· action: The action to be taken on the INI file entries.
· path: The path of the INI file.
· section: The section of the INI file.
· property: The property of the INI file.
· value: The value of the INI file.</p>
<p><strong>Code Description</strong>:
The ini_entry class is defined with the <strong><code>__init__</code></strong> method, which initializes the attributes of the class. The <strong><code>update_fields</code></strong> method returns a dictionary of fields to be updated.</p>
<p>The ini_entry class is used in the sqlite_registry class to handle INI file entries in a SQLite registry. The <strong><code>add_ini</code></strong> method in sqlite_registry takes an sid, an iniobj, and a policy_name as input, creates an instance of the ini_entry class with these parameters, and then adds it to the database. If adding the ini_entry instance raises an exception, the <strong><code>add_ini</code></strong> method filters the existing ini_entry instances with the same sid and path, and updates them with the new ini_entry instance&#x27;s fields.</p>
<p>The <strong><code>get_ini</code></strong> method in sqlite_registry takes a sid as input and returns a list of ini_entry instances associated with that sid.</p>
<p>The <strong><code>wipe_user</code></strong> method in sqlite_registry takes a sid as input and deletes all ini_entry instances associated with that sid from the database.</p>
<p><strong>Note</strong>:
When creating an instance of the ini_entry class, make sure that the sid, iniobj, and policy_name parameters are valid.</p>
<p>When using the <strong><code>add_ini</code></strong> method, be prepared to handle exceptions that may be raised when adding an ini_entry instance to the database.</p>
<p>When using the <strong><code>get_ini</code></strong> method, note that it returns a list of ini_entry instances, so you may need to iterate over the list to access individual instances.</p>
<p>When using the <strong><code>wipe_user</code></strong> method, note that it deletes all ini_entry instances associated with the given sid, so use it with caution.</p>
<p><strong>Output Example</strong>:
Here is an example of creating an instance of the ini_entry class:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iniobj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> iniobj</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/ini/file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my_policy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ini_entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> iniobj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my_policy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example of using the <strong><code>add_ini</code></strong> method:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iniobj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> iniobj</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/path/to/ini/file&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my_policy&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my_policy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite_registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_ini</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> iniobj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy_name</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example of using the <strong><code>get_ini</code></strong> method:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entries </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sqlite_registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_ini</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> entry </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> entries</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here is an example of using the <strong><code>wipe_user</code></strong> method:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;S-1-1-0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlite_registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wipe_user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-iniobj-policy_name">FunctionDef <strong>init</strong>(self, sid, iniobj, policy_name)<a href="#functiondef-initself-sid-iniobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-iniobj-policy_name" title="Direct link to functiondef-initself-sid-iniobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the ini_entry object with the necessary parameters.</p>
<p><strong>parameters</strong>:
· sid: A unique identifier for the record.
· iniobj: An object containing the configuration data from an ini file.
· policy_name: The name of the policy associated with the record.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the ini_entry object by setting the values of its attributes using the input parameters. The <code>sid</code> parameter is used to set the value of the <code>sid</code> attribute, while the <code>policy_name</code> parameter is used to set the value of the <code>policy_name</code> attribute. The <code>iniobj</code> parameter is an object that contains the configuration data from an ini file, and its attributes are used to set the values of the <code>action</code>, <code>path</code>, <code>section</code>, <code>property</code>, and <code>value</code> attributes of the ini_entry object.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>iniobj</code> parameter is expected to be an object that contains the necessary attributes (<code>action</code>, <code>path</code>, <code>section</code>, <code>property</code>, and <code>value</code>) to initialize the ini_entry object.</li>
<li>The <code>sid</code> and <code>policy_name</code> parameters are used to uniquely identify the ini_entry object and the policy associated with it.</li>
<li>The <code>ini_entry</code> object is typically used in the context of a larger system that manages policies and their associated records.</li>
<li>It is important to ensure that the <code>iniobj</code> parameter is properly validated and sanitized before passing it to the <code>ini_entry</code> constructor to prevent any potential security vulnerabilities.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-10">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-10" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a list of fields to be updated.</p>
<p><strong>parameters</strong>:</p>
<p>· self: The object that calls this function.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-networkshare_entry">ClassDef networkshare_entry<a href="#classdef-networkshare_entry" class="hash-link" aria-label="Direct link to ClassDef networkshare_entry" title="Direct link to ClassDef networkshare_entry">​</a></h2>
<p><strong>networkshare_entry</strong>: The function of networkshare_entry is to represent NETWORKSHARES.XML as an object mapping.</p>
<p><strong>attributes</strong>:
· sid: The SID (Security Identifier) of the user or group.
· policy_name: The name of the policy.
· name: The name of the network share.
· action: The action to be taken on the network share.
· path: The path of the network share.
· allRegular: A boolean value indicating whether all regular users are affected.
· comment: The comment for the network share.
· limitUsers: The number of users that can access the network share.
· abe: The ABE (Access-Based Enumeration) setting for the network share.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the object with the given SID, network share object, and policy name. It assigns the corresponding attributes with the values from the network share object.</p>
<p>The <code>update_fields</code> method returns a dictionary of fields to be updated. It includes all the attributes of the object except the SID and policy name.</p>
<p><strong>Relationship with its callers in the project</strong>:
The <code>networkshare_entry</code> class is used in the <code>add_networkshare</code> and <code>get_networkshare</code> methods of the <code>sqlite_registry</code> class. In <code>add_networkshare</code>, a new <code>networkshare_entry</code> object is created and added to the database. In <code>get_networkshare</code>, the method returns a list of <code>networkshare_entry</code> objects that belong to the specified SID. The <code>wipe_user</code> method of the <code>sqlite_registry</code> class removes all <code>networkshare_entry</code> objects that belong to the specified SID.</p>
<p><strong>Note</strong>:
The <code>update_fields</code> method should be called only after the object has been initialized with valid values.</p>
<p><strong>Output Example</strong>:
Here is an example of a <code>networkshare_entry</code> object:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">networkshare_entry </span><span class="token builtin">object</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">0x7f8c6c2a3d60</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> S</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">123456789</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">123456789</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">123456789</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SomePolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SomeNetworkShare</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> \\server\share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allRegular</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">comment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Some comment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limitUsers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">abe</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This example shows a <code>networkshare_entry</code> object with the specified attributes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-sid-networkshareobj-policy_name">FunctionDef <strong>init</strong>(self, sid, networkshareobj, policy_name)<a href="#functiondef-initself-sid-networkshareobj-policy_name" class="hash-link" aria-label="Direct link to functiondef-initself-sid-networkshareobj-policy_name" title="Direct link to functiondef-initself-sid-networkshareobj-policy_name">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong>init</strong> is to initialize the networkshare_entry object with the given parameters.</p>
<p><strong>parameters</strong>:
· sid: The SID (Security Identifier) of the user or group to which the network share applies.
· networkshareobj: An object containing information about the network share, such as its name, action, path, etc.
· policy_name: The name of the Group Policy Object (GPO) to which this network share entry belongs.</p>
<p><strong>Code Description</strong>:
The <strong>init</strong> function initializes the networkshare_entry object by setting its attributes with the given parameters. The SID and policy_name are directly assigned to the object&#x27;s sid and policy_name attributes, respectively. The networkshareobj parameter is an object that contains information about the network share, and its attributes are used to initialize the corresponding attributes of the networkshare_entry object. Specifically, the name, action, path, allRegular, comment, limitUsers, and abe attributes of the networkshare_entry object are set to the corresponding attributes of the networkshareobj object.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The networkshareobj parameter should be an object that contains the necessary attributes to initialize the networkshare_entry object.</li>
<li>The sid and policy_name parameters should be strings representing the SID and policy name, respectively.</li>
<li>The networkshare_entry object is initialized with the given parameters, and its attributes can be accessed or modified after initialization.</li>
<li>The networkshare_entry object does not perform any action or validation on the given parameters, so it is the responsibility of the caller to ensure that the parameters are valid and appropriate for the intended use.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-update_fieldsself-11">FunctionDef update_fields(self)<a href="#functiondef-update_fieldsself-11" class="hash-link" aria-label="Direct link to FunctionDef update_fields(self)" title="Direct link to FunctionDef update_fields(self)">​</a></h3>
<p><strong>update_fields</strong>: The function of update_fields is to return a list of fields to be updated.</p>
<p><strong>parameters</strong>: This function does not take any parameters as it is an instance method that gets called on an object of the networkshare_entry class.</p>
<hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/gpoa/storage/fs_file_cache"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">fs_file_cache</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/gpoa/storage/registry"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">registry</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#classdef-samba_preg" class="table-of-contents__link toc-highlight">ClassDef samba_preg</a><ul><li><a href="#functiondef-initself-preg_obj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, preg_obj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-samba_hkcu_preg" class="table-of-contents__link toc-highlight">ClassDef samba_hkcu_preg</a><ul><li><a href="#functiondef-initself-sid-preg_obj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, preg_obj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-1" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-ad_shortcut" class="table-of-contents__link toc-highlight">ClassDef ad_shortcut</a><ul><li><a href="#functiondef-initself-sid-sc-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, sc, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-2" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-info_entry" class="table-of-contents__link toc-highlight">ClassDef info_entry</a><ul><li><a href="#functiondef-initself-name-value" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, name, value)</a></li><li><a href="#functiondef-update_fieldsself-3" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-printer_entry" class="table-of-contents__link toc-highlight">ClassDef printer_entry</a><ul><li><a href="#functiondef-initself-sid-pobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, pobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-4" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-drive_entry" class="table-of-contents__link toc-highlight">ClassDef drive_entry</a><ul><li><a href="#functiondef-initself-sid-dobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, dobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-5" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-folder_entry" class="table-of-contents__link toc-highlight">ClassDef folder_entry</a><ul><li><a href="#functiondef-initself-sid-fobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, fobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-6" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-envvar_entry" class="table-of-contents__link toc-highlight">ClassDef envvar_entry</a><ul><li><a href="#functiondef-initself-sid-evobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, evobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-7" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-script_entry" class="table-of-contents__link toc-highlight">ClassDef script_entry</a><ul><li><a href="#functiondef-initself-sid-scrobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, scrobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-8" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-file_entry" class="table-of-contents__link toc-highlight">ClassDef file_entry</a><ul><li><a href="#functiondef-initself-sid-fileobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, fileobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-9" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-ini_entry" class="table-of-contents__link toc-highlight">ClassDef ini_entry</a><ul><li><a href="#functiondef-initself-sid-iniobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, iniobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-10" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li><li><a href="#classdef-networkshare_entry" class="table-of-contents__link toc-highlight">ClassDef networkshare_entry</a><ul><li><a href="#functiondef-initself-sid-networkshareobj-policy_name" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, sid, networkshareobj, policy_name)</a></li><li><a href="#functiondef-update_fieldsself-11" class="table-of-contents__link toc-highlight">FunctionDef update_fields(self)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/gpoa/backend/samba_backend">Samba Backend</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 BaseALT LTD, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>