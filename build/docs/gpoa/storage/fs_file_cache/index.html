<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gpoa/storage/fs_file_cache" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">fs_file_cache | GPUpdate Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://gpupdate-docs.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://gpupdate-docs.github.io/docs/gpoa/storage/fs_file_cache"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="fs_file_cache | GPUpdate Docs"><meta data-rh="true" name="description" content="ClassDef fsfilecache"><meta data-rh="true" property="og:description" content="ClassDef fsfilecache"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gpupdate-docs.github.io/docs/gpoa/storage/fs_file_cache"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/storage/fs_file_cache" hreflang="en"><link data-rh="true" rel="alternate" href="https://gpupdate-docs.github.io/docs/gpoa/storage/fs_file_cache" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d27c289a.css">
<script src="/assets/js/runtime~main.e7149247.js" defer="defer"></script>
<script src="/assets/js/main.19b81b89.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GPUpdate Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/gpoa/backend/applier_backend">gpoa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/backend/applier_backend">backend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/frontend/applier_frontend">frontend</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/gpt/">gpt</a><button aria-label="Expand sidebar category &#x27;gpt&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/plugin/">plugin</a><button aria-label="Expand sidebar category &#x27;plugin&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/gpoa/storage/cache">storage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/cache">cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/gpoa/storage/fs_file_cache">fs_file_cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/record_types">record_types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/registry">registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_cache">sqlite_cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_registry">sqlite_registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gpoa/storage/sqlite_registry_compat">sqlite_registry_compat</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/gpoa/test/frontend/appliers/test_controls">test</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/gpoa/util/">util</a><button aria-label="Expand sidebar category &#x27;util&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tools/parsing_chrom_admx_intvalues">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">gpoa</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">storage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">fs_file_cache</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>fs_file_cache</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="classdef-fs_file_cache">ClassDef fs_file_cache<a href="#classdef-fs_file_cache" class="hash-link" aria-label="Direct link to ClassDef fs_file_cache" title="Direct link to ClassDef fs_file_cache">​</a></h2>
<p><strong>fs_file_cache</strong>: The <code>fs_file_cache</code> class provides functionality to cache files in a specific directory for a given cache name and username. It handles the creation, storage, and retrieval of cached files.</p>
<p><strong>Attributes</strong>:
· <code>cache_name</code>: A string representing the name of the cache.
· <code>username</code>: An optional string representing the username for which the cache is created. If not provided, the cache is created for the current user.
· <code>storage_uri</code>: A string representing the path to the cache directory.
· <code>samba_context</code>: An instance of <code>smbc.Context</code> used for handling SMB (Server Message Block) connections.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the class with a given cache name and an optional username. It determines the storage URI based on the username or sets it to the default cache directory if the username is not provided. It also initializes a Samba context for handling SMB connections.</p>
<p>The <code>store</code> method takes a URI and an optional destination file and stores the file in the cache directory. It creates a temporary file, reads data from the source file in blocks, and writes the data to the temporary file. Once all data has been written, it renames the temporary file to the destination file and sets its permissions to 0o644.</p>
<p>The <code>get</code> method takes a URI and returns the path to the cached file. It first checks if the URI is a valid UNC path and then constructs the path to the cached file based on the URI. If the URI is not a valid UNC path, it raises a <code>NotUNCPathError</code>.</p>
<p>The <code>get_ls_smbdir</code> method lists the files in a given SMB directory. It takes a URI and returns a list of file names in the directory. If the URI does not exist or an exception occurs, it returns <code>None</code>.</p>
<p><strong>Relationship with Callers</strong>:
The <code>fs_file_cache</code> class is used in the <code>gpoa/frontend/frontend_manager.py</code> module to cache files for a specific user or machine. The <code>frontend_manager</code> class initializes an instance of <code>fs_file_cache</code> with a given cache name and username and uses it to store and retrieve cached files.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>store</code> method creates a temporary file using <code>tempfile.mkstemp</code> and does not explicitly close the file descriptor. It is recommended to close the file descriptor to free up system resources.</li>
<li>The <code>get</code> method assumes that the URI is a valid UNC path and does not handle other types of paths.</li>
</ul>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fs_file_cache</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;my_cache&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;user1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\\server\share\file.txt&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">destfile </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uri</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cached_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uri</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cached_file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: /path/to/cache/user1/domain/server/share/file.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-initself-cache_name-username">FunctionDef <strong>init</strong>(self, cache_name, username)<a href="#functiondef-initself-cache_name-username" class="hash-link" aria-label="Direct link to functiondef-initself-cache_name-username" title="Direct link to functiondef-initself-cache_name-username">​</a></h3>
<p><strong><strong>init</strong></strong>: The function of <strong><strong>init</strong></strong> is to initialize the <code>fs_file_cache</code> object with a given <code>cache_name</code> and an optional <code>username</code>.</p>
<p><strong>parameters</strong>:
· <code>cache_name</code> (str): The name of the file cache. This is a required parameter.
· <code>username</code> (str, optional): The username for which to retrieve the cache directory path. If provided, the cache directory path will be specific to this user. If not provided, the default cache directory path will be used.</p>
<p><strong>Code Description</strong>:
The <code>__init__</code> method initializes the <code>fs_file_cache</code> object by setting the <code>cache_name</code> attribute to the given <code>cache_name</code> parameter.</p>
<p>If a <code>username</code> is provided, the method attempts to retrieve the cache directory path for that user by calling the <code>file_cache_path_home</code> function with the <code>username</code> parameter. If this function call fails (for example, if the user does not exist), the method falls back to calling the <code>file_cache_dir</code> function to retrieve the default cache directory path.</p>
<p>If no <code>username</code> is provided, the method simply calls the <code>file_cache_dir</code> function to retrieve the default cache directory path.</p>
<p>The method then logs the cache directory path using the <code>log</code> function with a log message indicating the cache file path.</p>
<p>Finally, the method initializes the <code>samba_context</code> attribute with a new <code>smbc.Context</code> object with the <code>use_kerberos</code> parameter set to <code>1</code>. This is used for accessing SMB/CIFS resources using Kerberos authentication.</p>
<p><strong>Note</strong>:
It is important to note that the correctness of the returned cache directory path depends on the correct configuration and up-to-dateness of the password database. If the password database is not properly configured, this method may return incorrect or incomplete information.</p>
<p>Additionally, the <code>samba_context</code> attribute is initialized with the <code>use_kerberos</code> parameter set to <code>1</code>, which means that Kerberos authentication will be used for accessing SMB/CIFS resources. This may require additional configuration and setup, such as setting up a Kerberos realm and enabling Kerberos authentication on the SMB/CIFS server.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-storeself-uri-destfile">FunctionDef store(self, uri, destfile)<a href="#functiondef-storeself-uri-destfile" class="hash-link" aria-label="Direct link to FunctionDef store(self, uri, destfile)" title="Direct link to FunctionDef store(self, uri, destfile)">​</a></h3>
<p><strong>store</strong>: The function of store is to save a file from a UNC path to a destination directory or file.</p>
<p><strong>parameters</strong>:
· uri: A string representing the UNC path of the file to be stored.
· destfile (optional): A Path object representing the destination file or directory for the stored file. If not provided, the function will use the original file name and create a new directory based on the file&#x27;s domain and path.</p>
<p><strong>Code Description</strong>:
The store function first checks if the provided path is a UNC path or not by creating an instance of the UNCPath class. If the path is not a UNC path, it raises a NotUNCPathError.</p>
<p>If the destfile parameter is not provided, the function extracts the file name and directory path from the UNC path using the UNCPath&#x27;s get_path method. It then creates a new destination directory using the Path object&#x27;s parent attribute and the format &#x27;<!-- -->/<!-- -->/<!-- -->&#x27;.format(self.storage_uri, uri_path.get_domain(), file_path). If the destination directory does not exist, it creates the directory using the mkdir method with the parents and exist_ok parameters set to True.</p>
<p>The function then creates a new file path by combining the storage_uri, domain, and original file path. It opens the file in write-binary mode using the open method and the os.O_RDONLY flag. It then creates a temporary file using the tempfile.mkstemp method and writes the contents of the original file to the temporary file in write-binary mode using a file handler. Once the file is written, it renames the temporary file to the final destination file path using the os.rename method and sets the file permissions to 0o644 using the os.chmod method.</p>
<p>If an exception occurs during the file storage process, the function logs the exception using the log method and re-raises the exception.</p>
<p>The store function is used in various parts of the project to manage the storage of files. It is used in the copy_target_file method of the Files_cp class to store a file from a UNC path to a local file path. It is also used in the update_file_cache method of the gsettings_applier class to store a file from a UNC path to a local cache directory. Additionally, it is used in the admin_context_apply method of the gsettings_applier_user class to store a file from a UNC path to a local cache directory. Finally, it is used in the apply_for_wallpaper function to store a file from a UNC path to a local configuration file.</p>
<p><strong>Note</strong>:
The store function assumes that the provided path is a UNC path. It is important to ensure that the path is a UNC path before calling this function. Additionally, if the destfile parameter is not provided, the function will create a new directory based on the file&#x27;s domain and path. It is important to ensure that the storage_uri attribute is set correctly before calling this function.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-getself-uri">FunctionDef get(self, uri)<a href="#functiondef-getself-uri" class="hash-link" aria-label="Direct link to FunctionDef get(self, uri)" title="Direct link to FunctionDef get(self, uri)">​</a></h3>
<p><strong>get</strong>: The function of get is to retrieve the file path in URI format based on the input UNC path.</p>
<p><strong>parameters</strong>:
· uri: A string representing the UNC path.</p>
<p><strong>Code Description</strong>:
The <code>get</code> function is a method of the <code>fs_file_cache</code> class and is used to retrieve the file path in URI format based on the input UNC path. It takes a single parameter, <code>uri</code>, which is the UNC path to be converted to URI format.</p>
<p>The function first initializes the <code>destfile</code> variable to the input <code>uri</code>. It then creates an instance of the <code>UNCPath</code> class with the input <code>uri</code> as the argument. If the <code>uri</code> is not a UNC path, a <code>NotUNCPathError</code> is raised.</p>
<p>The function then extracts the file name and directory path from the <code>UNCPath</code> instance using the <code>os.path.basename</code> and <code>os.path.dirname</code> functions, respectively. It then constructs the <code>destfile</code> variable with the storage URI, domain, and path components.</p>
<p>If the <code>uri</code> is not a UNC path, a <code>NotUNCPathError</code> is raised. If any other exception occurs during the execution of the function, it is caught and logged using the <code>log</code> function.</p>
<p>The function returns the <code>destfile</code> variable in string format.</p>
<p><strong>Relationship with its callers in the project</strong>:
The <code>get</code> function is called by the <code>uri_fetch</code> function in the <code>gsettings_applier.py</code> module to retrieve the URI format of the file path based on the input UNC path. It is also called by the <code>apply_for_wallpaper</code> function in the <code>kde_applier.py</code> module to retrieve the URI format of the file path based on the input UNC path.</p>
<p><strong>Note</strong>:
This function assumes that the input <code>uri</code> is a valid UNC path. It is important to ensure that the <code>uri</code> is a UNC path before calling this function.</p>
<p><strong>Output Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\\\\server\\share\\file.txt&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fs_file_cache</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uri_fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;schema&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uri</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: &#x27;smb://server/share/file.txt&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, the <code>uri_fetch</code> function calls the <code>get</code> function with the input UNC path <code>&#x27;\\server\share\file.txt&#x27;</code>. The <code>get</code> function converts the UNC path to URI format and returns the result, which is then printed to the console.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="functiondef-get_ls_smbdirself-uri">FunctionDef get_ls_smbdir(self, uri)<a href="#functiondef-get_ls_smbdirself-uri" class="hash-link" aria-label="Direct link to FunctionDef get_ls_smbdir(self, uri)" title="Direct link to FunctionDef get_ls_smbdir(self, uri)">​</a></h3>
<p><strong>get_ls_smbdir</strong>: The function of get_ls_smbdir is to list the files in a given SMB directory.</p>
<p><strong>parameters</strong>:
· uri (str): The SMB directory to list the files from.</p>
<hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/gpoa/storage/cache"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">cache</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/gpoa/storage/record_types"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">record_types</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#classdef-fs_file_cache" class="table-of-contents__link toc-highlight">ClassDef fs_file_cache</a><ul><li><a href="#functiondef-initself-cache_name-username" class="table-of-contents__link toc-highlight">FunctionDef <strong>init</strong>(self, cache_name, username)</a></li><li><a href="#functiondef-storeself-uri-destfile" class="table-of-contents__link toc-highlight">FunctionDef store(self, uri, destfile)</a></li><li><a href="#functiondef-getself-uri" class="table-of-contents__link toc-highlight">FunctionDef get(self, uri)</a></li><li><a href="#functiondef-get_ls_smbdirself-uri" class="table-of-contents__link toc-highlight">FunctionDef get_ls_smbdir(self, uri)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/gpoa/backend/samba_backend">Samba Backend</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 BaseALT LTD, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>